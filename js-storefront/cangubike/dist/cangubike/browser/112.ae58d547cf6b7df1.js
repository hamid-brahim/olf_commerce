"use strict";(self.webpackChunkcangubike=self.webpackChunkcangubike||[]).push([[112],{5112:(zn,K,a)=>{a.r(K),a.d(K,{AsmModule:()=>Gn});var t=a(4650),m=a(1446),r=a(6322),u=a(4006),bt=a(591),C=a(2654),O=a(6053),yt=a(910),W=a(8514),Zt=a(8896),Z=a(1086),It=a(7274),_=a(4850),Et=a(5154),I=a(2986),v=a(2198),h=a(2994),k=a(1406),Mt=a(537),Ut=a(13),N=a(5778),D=a(7545),V=a(3749),f=a(5344),Rt=a(950),d=a(6895),X=a(7039),T=a(7221),w=a(7212),p=a(8555),A=a(5024);class ${}let E=(()=>{class n{constructor(e){this.asmAdapter=e}customerSearch(e){return this.asmAdapter.customerSearch(e)}customerLists(){return this.asmAdapter.customerLists()}bindCart(e){return this.asmAdapter.bindCart(e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG($))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Ft=new t.OlP("CustomerSearchPageNormalizer"),Ot=new t.OlP("CustomerListsNormalizer");let tt=(()=>{class n{constructor(e,s,i){this.commandService=e,this.asmConnector=s,this.userAccountFacade=i,this.bindCartCommand$=this.commandService.create(c=>this.userAccountFacade.get().pipe((0,_.U)(l=>{if(l?.uid)return l.uid;throw new Error("No identifier for authenticated user found.")}),(0,I.q)(1),(0,k.b)(l=>this.asmConnector.bindCart({cartId:c,customerId:l}))))}bindCart(e){return this.bindCartCommand$.execute(e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(r.VDr),t.LFG(E),t.LFG(w.gf))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),et=(()=>{class n{constructor(e,s){this.queryService=e,this.asmConnector=s,this.customerListQuery$=this.queryService.create(()=>this.asmConnector.customerLists(),{reloadOn:void 0,resetOn:void 0})}getCustomerLists(){return this.customerListQuery$.get()}getCustomerListsState(){return this.customerListQuery$.getState()}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(r._7J),t.LFG(E))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();const kt=[et,{provide:f.AH,useExisting:et},tt,{provide:f.AE,useExisting:tt}],J="[Asm] UI Update";class Y{constructor(o){this.payload=o,this.type=J}}const L="[asm] Customer search data",b="[asm] Customer list customers search data",P="[Asm] Customer Search",Q="[Asm] Customer List Customers Search";class lt extends r.kPG.LoaderLoadAction{constructor(o){super(L),this.payload=o,this.type=P}}class ut extends r.kPG.LoaderFailAction{constructor(o){super(L),this.payload=o,this.type="[Asm] Customer Search Fail"}}class mt extends r.kPG.LoaderSuccessAction{constructor(o){super(L),this.payload=o,this.type="[Asm] Customer Search Success"}}class dt extends r.kPG.LoaderResetAction{constructor(){super(L),this.type="[Asm] Customer Search Reset"}}class pt extends r.kPG.LoaderLoadAction{constructor(o){super(b),this.payload=o,this.type=Q}}class gt extends r.kPG.LoaderFailAction{constructor(o){super(b),this.payload=o,this.type="[Asm] Customer List Customers Search Fail"}}class _t extends r.kPG.LoaderSuccessAction{constructor(o){super(b),this.payload=o,this.type="[Asm] Customer List Customers Search Success"}}class ft extends r.kPG.LoaderResetAction{constructor(){super(b),this.type="[Asm] Customer List Customers Search Reset"}}const Dt=[(()=>{class n{constructor(e,s){this.actions$=e,this.asmConnector=s,this.customerSearch$=(0,A.GW)(()=>this.actions$.pipe((0,A.l4)(P),(0,_.U)(i=>i.payload),(0,D.w)(i=>this.asmConnector.customerSearch(i).pipe((0,_.U)(c=>new mt(c)),(0,T.K)(c=>(0,Z.of)(new ut((0,r.cxH)(c)))))))),this.customerListCustomersSearch$=(0,A.GW)(()=>this.actions$.pipe((0,A.l4)(Q),(0,_.U)(i=>i.payload),(0,D.w)(i=>this.asmConnector.customerSearch(i).pipe((0,_.U)(c=>new _t(c)),(0,T.K)(c=>(0,Z.of)(new gt((0,r.cxH)(c))))))))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(A.eX),t.LFG(E))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})()],wt={collapsed:!1};function Jt(n=wt,o){return o.type===J?{...n,...o.payload}:n}const Ct=new t.OlP("AsmReducers"),Pt={provide:Ct,useFactory:function Yt(){return{customerSearchResult:r.kPG.loaderReducer(L),customerListCustomersSearchResult:r.kPG.loaderReducer(b),asmUi:Jt}}},Bt=[function Qt(n){return function(o,e){return"[Auth] Logout Customer Support Agent"===e.type&&(o={...o,customerSearchResult:{}}),n(o,e)}}],M=(0,p.ZF)("asm"),G=(0,p.P1)(M,n=>n.asmUi),q=(0,p.P1)(M,n=>n.customerSearchResult),ht=(0,p.P1)(q,n=>r.kPG.loaderValueSelector(n)),At=(0,p.P1)(q,n=>r.kPG.loaderLoadingSelector(n)),U=(0,p.P1)(M,n=>n.customerListCustomersSearchResult),xt=(0,p.P1)(U,n=>r.kPG.loaderValueSelector(n)),St=(0,p.P1)(U,n=>r.kPG.loaderLoadingSelector(n)),vt=(0,p.P1)(U,n=>r.kPG.loaderErrorSelector(n));let Gt=(()=>{class n{constructor(e,s,i){this.statePersistenceService=e,this.store=s,this.authStorageService=i,this.subscription=new C.w,this.key="asm"}initSync(){this.subscription.add(this.statePersistenceService.syncWithStorage({key:this.key,state$:this.getAsmState(),onRead:e=>this.onRead(e)}))}getAsmState(){return(0,O.aj)([this.store.pipe((0,v.h)(e=>!!e.asm),(0,p.Ys)(G)),(0,Z.of)(this.authStorageService.getEmulatedUserToken()),this.authStorageService.getTokenTarget()]).pipe((0,_.U)(([e,s,i])=>{let c=s;return c&&(c={...s},delete c.refresh_token),{ui:e,emulatedUserToken:c,tokenTarget:i}}))}onRead(e){e&&(e.ui&&this.store.dispatch(new Y(e.ui)),e.emulatedUserToken&&this.authStorageService.setEmulatedUserToken(e.emulatedUserToken),e.tokenTarget&&this.authStorageService.setTokenTarget(e.tokenTarget))}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(r.WBb),t.LFG(p.yh),t.LFG(f.JW))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),qt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[Pt],imports:[d.ez,r.vUS,p.Aw.forFeature("asm",Ct,{metaReducers:Bt}),A.sQ.forFeature(Dt)]}),n})();function zt(n){return()=>n.initSync()}let Ht=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[E,{provide:r.z4I,useFactory:zt,deps:[Gt],multi:!0},...kt],imports:[d.ez,qt]}),n})(),R=(()=>{class n extends f.hc{}return n.\u0275fac=function(){let o;return function(s){return(o||(o=t.n5z(n)))(s||n)}}(),n.\u0275prov=t.Yz7({token:n,factory:function(e){let s=null;return s=e?new(e||n):t.LFG(r.DeH),s},providedIn:"root"}),n})(),F=(()=>{class n{constructor(e){this.store=e}customerSearch(e){this.store.dispatch(new lt(e))}customerSearchReset(){this.store.dispatch(new dt)}getCustomerSearchResults(){return this.store.pipe((0,p.Ys)(ht))}getCustomerSearchResultsLoading(){return this.store.pipe((0,p.Ys)(At))}customerListCustomersSearch(e){this.store.dispatch(new pt(e))}getCustomerListCustomersSearchResults(){return this.store.pipe((0,p.Ys)(xt))}getCustomerListCustomersSearchResultsLoading(){return this.store.pipe((0,p.Ys)(St))}getCustomerListCustomersSearchResultsError(){return this.store.pipe((0,p.Ys)(vt))}customerListCustomersSearchReset(){this.store.dispatch(new ft)}updateAsmUiState(e){this.store.dispatch(new Y(e))}getAsmUiState(){return this.store.pipe((0,p.Ys)(G))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(p.yh))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const jt=["bindToCart"];function Kt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"form",2),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onSubmit())}),t.TgZ(1,"label"),t._UZ(2,"input",3),t.ALo(3,"cxTranslate"),t.ALo(4,"cxTranslate"),t._UZ(5,"cx-form-errors",4),t.qZA(),t.TgZ(6,"label"),t._UZ(7,"input",5),t.ALo(8,"cxTranslate"),t.ALo(9,"cxTranslate"),t._UZ(10,"cx-form-errors",4),t.qZA(),t.TgZ(11,"button",6),t._uU(12),t.ALo(13,"cxTranslate"),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("formGroup",e.csAgentLoginForm),t.xp6(2),t.s9C("placeholder",t.lcZ(3,8,"asm.loginForm.userId.label")),t.uIk("aria-label",t.lcZ(4,10,"asm.loginForm.userId.label")),t.xp6(3),t.Q6J("control",e.csAgentLoginForm.get("userId")),t.xp6(2),t.s9C("placeholder",t.lcZ(8,12,"asm.loginForm.password.label")),t.uIk("aria-label",t.lcZ(9,14,"asm.loginForm.password.label")),t.xp6(3),t.Q6J("control",e.csAgentLoginForm.get("password")),t.xp6(2),t.hij(" ",t.lcZ(13,16,"asm.loginForm.submit")," ")}}function Wt(n,o){1&n&&(t.TgZ(0,"div",7),t.ALo(1,"cxTranslate"),t._UZ(2,"div")(3,"div")(4,"div"),t.qZA()),2&n&&t.uIk("aria-label",t.lcZ(1,1,"common.loading"))}const Vt=["resultList"],Xt=["searchTerm"];function $t(n,o){1&n&&(t.TgZ(0,"button",7),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"asm.customerSearch.submit")," "))}function te(n,o){if(1&n&&(t.TgZ(0,"button",7),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n){const e=t.oxw();t.ekj("active",e.selectedCustomer),t.xp6(1),t.hij(" ",t.lcZ(2,3,"asm.customerSearch.submit")," ")}}function ee(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){const c=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.selectCustomerFromList(c))}),t.TgZ(1,"span",13),t._uU(2),t.qZA(),t.TgZ(3,"span",14),t._uU(4),t.qZA()()}if(2&n){const e=o.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.Oqu(e.uid)}}function ne(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.closeResults())}),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()}2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"asm.customerSearch.noMatch")," "))}function se(n,o){if(1&n&&(t.TgZ(0,"div",8,9),t.YNc(2,ee,5,2,"button",10),t.YNc(3,ne,3,3,"button",11),t.ALo(4,"async"),t.qZA()),2&n){const e=o.ngIf,s=t.oxw(),i=t.MAs(3);t.xp6(2),t.Q6J("ngForOf",e.entries),t.xp6(1),t.Q6J("ngIf",!t.lcZ(4,2,s.searchResultsLoading$)&&i.value.length>=3&&!!e.entries&&e.entries.length<=0)}}function oe(n,o){1&n&&(t.TgZ(0,"div",8)(1,"div",15),t.ALo(2,"cxTranslate"),t._UZ(3,"div")(4,"div")(5,"div"),t.qZA()()),2&n&&(t.xp6(1),t.uIk("aria-label",t.lcZ(2,1,"common.loading")))}function ie(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"input",3),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.hYB("placeholder","",null==e.customer?null:e.customer.name,", ",null==e.customer?null:e.customer.uid,"")}}function re(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",4)(2,"label",5),t._uU(3),t.qZA(),t.TgZ(4,"label",6),t._uU(5),t.qZA()(),t._UZ(6,"cx-asm-bind-cart"),t.BQk()),2&n){const e=t.oxw(2);t.xp6(3),t.Oqu(null==e.customer?null:e.customer.name),t.xp6(2),t.Oqu(null==e.customer?null:e.customer.uid)}}function ce(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.YNc(1,ie,2,2,"ng-container",1),t.YNc(2,re,7,2,"ng-container",1),t.TgZ(3,"button",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.logoutCustomer())}),t._uU(4),t.ALo(5,"cxTranslate"),t.qZA(),t.BQk()}2&n&&(t.xp6(1),t.Q6J("cxFeatureLevel","!5.1"),t.xp6(1),t.Q6J("cxFeatureLevel","5.1"),t.xp6(2),t.hij(" ",t.lcZ(5,3,"asm.endSession")," "))}function ae(n,o){1&n&&(t.TgZ(0,"span",3),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"asm.toggleUi.collapse")," "))}function le(n,o){1&n&&(t.TgZ(0,"span",3),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"asm.toggleUi.expand")," "))}const ue=["customerListLink"];function me(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",10)(1,"a",11,12),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.showCustomList())}),t._UZ(3,"cx-icon",13),t.TgZ(4,"span"),t._uU(5),t.ALo(6,"cxTranslate"),t.qZA()()()}if(2&n){const e=t.oxw(2);t.xp6(3),t.Q6J("type",e.iconTypes.USER_FRIENDS),t.xp6(2),t.Oqu(t.lcZ(6,2,"asm.customers"))}}function de(n,o){if(1&n&&(t.ynx(0),t.YNc(1,me,7,4,"div",9),t.ALo(2,"async"),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,e.customerSupportAgentLoggedIn$))}}function pe(n,o){1&n&&t._UZ(0,"cx-asm-session-timer")}function ge(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.hideUi())}),t.ALo(1,"cxTranslate"),t.qZA()}2&n&&t.s9C("title",t.lcZ(1,1,"asm.hideUi"))}function _e(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.logout())}),t.ALo(1,"cxTranslate"),t.qZA()}2&n&&t.s9C("title",t.lcZ(1,1,"asm.logout"))}function fe(n,o){1&n&&t._UZ(0,"cx-customer-emulation")}function Ce(n,o){if(1&n&&(t.ynx(0),t.YNc(1,fe,1,0,"cx-customer-emulation",6),t.BQk()),2&n){const e=t.oxw(2).ngIf;t.xp6(1),t.Q6J("ngIf",e)}}function he(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"cx-customer-selection",20),t.NdJ("submitEvent",function(i){t.CHM(e);const c=t.oxw(4);return t.KtG(c.startCustomerEmulationSession(i))}),t.qZA()}}function Ae(n,o){if(1&n&&t.YNc(0,he,1,0,"cx-customer-selection",19),2&n){const e=t.oxw(2).ngIf;t.Q6J("ngIf",e)}}function xe(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Ce,2,1,"ng-container",16),t.ALo(2,"async"),t.YNc(3,Ae,1,1,"ng-template",null,18,t.W1O),t.BQk()),2&n){const e=t.MAs(4),s=t.oxw(2);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,s.customer$))("ngIfElse",e)}}function Se(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"cx-csagent-login-form",22),t.NdJ("submitEvent",function(i){t.CHM(e);const c=t.oxw(3);return t.KtG(c.loginCustomerSupportAgent(i))}),t.ALo(1,"async"),t.qZA()}if(2&n){const e=t.oxw(3);t.Q6J("csAgentTokenLoading",t.lcZ(1,1,e.csAgentTokenLoading$))}}function ve(n,o){if(1&n&&t.YNc(0,Se,2,3,"cx-csagent-login-form",21),2&n){const e=t.oxw().ngIf;t.Q6J("ngIf",e)}}function Te(n,o){if(1&n&&(t.ynx(0),t.YNc(1,xe,5,4,"ng-container",16),t.ALo(2,"async"),t.YNc(3,ve,1,1,"ng-template",null,17,t.W1O),t.BQk()),2&n){const e=t.MAs(4),s=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,s.customerSupportAgentLoggedIn$))("ngIfElse",e)}}function Le(n,o){}function be(n,o){1&n&&t.YNc(0,Le,0,0,"ng-template")}function ye(n,o){}function Ze(n,o){1&n&&t.YNc(0,ye,0,0,"ng-template")}function Ie(n,o){}function Ee(n,o){1&n&&t.YNc(0,Ie,0,0,"ng-template")}function Me(n,o){}function Ue(n,o){1&n&&t.YNc(0,Me,0,0,"ng-template")}const Re=function(n){return{customerListsPage:n}};function Fe(n,o){if(1&n&&(t.TgZ(0,"div",18),t.ALo(1,"async"),t.YNc(2,Ze,1,0,null,19),t.TgZ(3,"div",20),t.ALo(4,"async"),t.YNc(5,Ee,1,0,null,5),t.YNc(6,Ue,1,0,null,5),t.qZA()()),2&n){const e=o.ngIf,s=t.oxw(),i=t.MAs(33),c=t.MAs(29),l=t.MAs(31);t.ekj("tablet-mobile",t.lcZ(1,8,s.breakpoint$)!==s.BREAKPOINT.md),t.xp6(2),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(12,Re,e)),t.xp6(1),t.ekj("mobile",t.lcZ(4,10,s.breakpoint$)===s.BREAKPOINT.xs),t.xp6(2),t.Q6J("ngTemplateOutlet",c),t.xp6(1),t.Q6J("ngTemplateOutlet",l)}}function Oe(n,o){1&n&&(t.TgZ(0,"div",21),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"asm.customerList.noLists")," "))}function ke(n,o){1&n&&(t.TgZ(0,"div",21),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"asm.customerList.listsError")," "))}function Ne(n,o){1&n&&(t.TgZ(0,"div",21),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"generalErrors.pageFailure")," "))}function De(n,o){1&n&&t._UZ(0,"cx-spinner")}function we(n,o){1&n&&(t.TgZ(0,"th",29)(1,"span",23),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA()()),2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"asm.customerList.tableHeader.customer")," "))}function Je(n,o){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.headerLocalizationKey))}}function Ye(n,o){if(1&n&&(t.TgZ(0,"th",30),t.YNc(1,Je,3,3,"span",11),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.Q6J("ngIf",e.headerLocalizationKey)}}function Pe(n,o){if(1&n&&(t.TgZ(0,"thead")(1,"tr",26),t.YNc(2,we,4,3,"th",27),t.YNc(3,Ye,2,1,"th",28),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",null==e.customerListConfig?null:e.customerListConfig.showAvatar),t.xp6(1),t.Q6J("ngForOf",null==e.customerListConfig?null:e.customerListConfig.columns)}}function Qe(n,o){if(1&n&&(t.TgZ(0,"td",33)(1,"div",34),t._uU(2),t.qZA()()),2&n){const e=t.oxw().$implicit,s=t.oxw(2);t.xp6(2),t.hij(" ",s.getBadgeText(e)," ")}}function Be(n,o){}function Ge(n,o){1&n&&t.YNc(0,Be,0,0,"ng-template")}const qe=function(n,o){return{customerEntry:n,column:o,showHeader:!1}};function ze(n,o){if(1&n&&(t.TgZ(0,"td",36),t.YNc(1,Ge,1,0,null,19),t.qZA()),2&n){const e=o.$implicit,s=t.oxw(2).$implicit;t.oxw(2);const i=t.MAs(25);t.xp6(1),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.WLB(2,qe,s,e))}}function He(n,o){if(1&n&&(t.ynx(0),t.YNc(1,ze,2,5,"td",35),t.BQk()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",null==e.customerListConfig?null:e.customerListConfig.columns)}}function je(n,o){}function Ke(n,o){1&n&&t.YNc(0,je,0,0,"ng-template")}const z=function(n,o){return{customerEntry:n,column:o,showHeader:!0}};function We(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Ke,1,0,null,19),t.BQk()),2&n){const e=t.oxw().$implicit,s=t.oxw(2).$implicit;t.oxw(2);const i=t.MAs(25);t.xp6(1),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.WLB(2,z,s,e))}}function Ve(n,o){if(1&n&&(t.ynx(0),t.YNc(1,We,2,5,"ng-container",11),t.BQk()),2&n){const e=o.even;t.xp6(1),t.Q6J("ngIf",e)}}function Xe(n,o){}function $e(n,o){1&n&&t.YNc(0,Xe,0,0,"ng-template")}function tn(n,o){if(1&n&&(t.ynx(0),t.YNc(1,$e,1,0,null,19),t.BQk()),2&n){const e=t.oxw().$implicit,s=t.oxw(2).$implicit;t.oxw(2);const i=t.MAs(25);t.xp6(1),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.WLB(2,z,s,e))}}function en(n,o){if(1&n&&(t.ynx(0),t.YNc(1,tn,2,5,"ng-container",11),t.BQk()),2&n){const e=o.odd;t.xp6(1),t.Q6J("ngIf",e)}}function nn(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"td",37),t.YNc(2,Ve,2,1,"ng-container",38),t.qZA(),t.TgZ(3,"td",37),t.YNc(4,en,2,1,"ng-container",38),t.qZA(),t.BQk()),2&n){const e=t.oxw(3);t.xp6(2),t.Q6J("ngForOf",null==e.customerListConfig?null:e.customerListConfig.columns),t.xp6(2),t.Q6J("ngForOf",null==e.customerListConfig?null:e.customerListConfig.columns)}}function sn(n,o){}function on(n,o){1&n&&t.YNc(0,sn,0,0,"ng-template")}function rn(n,o){if(1&n&&(t.ynx(0),t.YNc(1,on,1,0,null,19),t.BQk()),2&n){const e=o.$implicit,s=t.oxw(2).$implicit;t.oxw(2);const i=t.MAs(25);t.xp6(1),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.WLB(2,z,s,e))}}function cn(n,o){if(1&n&&(t.TgZ(0,"td",37),t.YNc(1,rn,2,5,"ng-container",38),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",null==e.customerListConfig?null:e.customerListConfig.columns)}}function an(n,o){if(1&n&&(t.TgZ(0,"tr",26),t.YNc(1,Qe,3,1,"td",31),t.YNc(2,He,2,1,"ng-container",11),t.ALo(3,"async"),t.YNc(4,nn,5,2,"ng-container",11),t.ALo(5,"async"),t.YNc(6,cn,2,1,"td",32),t.ALo(7,"async"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.customerListConfig?null:e.customerListConfig.showAvatar),t.xp6(1),t.Q6J("ngIf",t.lcZ(3,4,e.breakpoint$)===e.BREAKPOINT.md),t.xp6(2),t.Q6J("ngIf",t.lcZ(5,6,e.breakpoint$)===e.BREAKPOINT.sm),t.xp6(2),t.Q6J("ngIf",t.lcZ(7,8,e.breakpoint$)===e.BREAKPOINT.xs)}}function ln(n,o){1&n&&(t.TgZ(0,"div",39),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"asm.customerList.noCustomers")," "))}function un(n,o){if(1&n&&(t.TgZ(0,"div")(1,"table",22)(2,"caption",23),t._uU(3),t.ALo(4,"cxTranslate"),t.qZA(),t.YNc(5,Pe,4,2,"thead",11),t.ALo(6,"async"),t.TgZ(7,"tbody"),t.YNc(8,an,8,10,"tr",24),t.qZA()(),t.YNc(9,ln,3,3,"div",25),t.qZA()),2&n){const e=o.ngIf,s=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,4,"asm.customerList.title")," "),t.xp6(2),t.Q6J("ngIf",t.lcZ(6,6,s.breakpoint$)===s.BREAKPOINT.md),t.xp6(3),t.Q6J("ngForOf",null==e?null:e.entries),t.xp6(1),t.Q6J("ngIf",!(null!=e&&e.entries.length))}}function mn(n,o){if(1&n&&(t.TgZ(0,"span",43),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA()),2&n){const e=t.oxw().column;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.headerLocalizationKey)," ")}}function dn(n,o){1&n&&t.GkF(0)}const Tt=function(n,o){return{column:n,customerEntry:o}};function pn(n,o){if(1&n&&(t.ynx(0),t.YNc(1,dn,1,0,"ng-container",19),t.BQk()),2&n){const e=t.oxw(),s=e.column,i=e.customerEntry;t.oxw();const c=t.MAs(27);t.xp6(1),t.Q6J("ngTemplateOutlet",c)("ngTemplateOutletContext",t.WLB(2,Tt,s,i))}}function gn(n,o){1&n&&t.GkF(0)}function _n(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",44),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(),c=i.customerEntry,l=i.column,g=t.oxw();return t.KtG(g.startColumnAction(c,l.actionType))}),t.ALo(1,"cxTranslate"),t.ALo(2,"cxTranslate"),t.YNc(3,gn,1,0,"ng-container",19),t.qZA()}if(2&n){const e=t.oxw(),s=e.column,i=e.customerEntry;t.oxw();const c=t.MAs(27);let l,g;t.uIk("title",s.icon?t.lcZ(1,4,null!==(l=s.icon.captionLocalizationKey)&&void 0!==l?l:s.headerLocalizationKey):void 0)("aria-label",s.icon?t.lcZ(2,6,null!==(g=s.icon.captionLocalizationKey)&&void 0!==g?g:s.headerLocalizationKey):void 0),t.xp6(3),t.Q6J("ngTemplateOutlet",c)("ngTemplateOutletContext",t.WLB(8,Tt,s,i))}}function fn(n,o){if(1&n&&(t.TgZ(0,"div",40),t.YNc(1,mn,3,3,"span",41),t.YNc(2,pn,2,5,"ng-container",11),t.YNc(3,_n,4,11,"button",42),t.qZA()),2&n){const e=o.column,s=o.showHeader;t.xp6(1),t.Q6J("ngIf",s),t.xp6(1),t.Q6J("ngIf",!e.actionType),t.xp6(1),t.Q6J("ngIf",e.actionType)}}function Cn(n,o){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw(),s=e.column,i=e.customerEntry;t.xp6(1),t.Oqu((null==s.renderer?null:s.renderer(i))||"")}}function hn(n,o){if(1&n&&(t._UZ(0,"cx-icon",46),t.ALo(1,"cxTranslate"),t.ALo(2,"cxTranslate")),2&n){const e=t.oxw().column;let s,i;t.ekj("cx-action-color",e.actionType),t.Q6J("type",e.icon.symbol),t.uIk("title",e.actionType?void 0:t.lcZ(1,5,null!==(s=e.icon.captionLocalizationKey)&&void 0!==s?s:e.headerLocalizationKey))("aria-label",e.actionType?void 0:t.lcZ(2,7,null!==(i=e.icon.captionLocalizationKey)&&void 0!==i?i:e.headerLocalizationKey))}}function An(n,o){if(1&n&&(t.YNc(0,Cn,2,1,"span",11),t.YNc(1,hn,3,9,"cx-icon",45)),2&n){const e=o.column;t.Q6J("ngIf",!e.icon),t.xp6(1),t.Q6J("ngIf",e.icon)}}const Lt=function(n){return{ariaLabel:n,ariaControls:"asm-cusomer-list-table"}};function xn(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"label")(1,"span",23),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA(),t.TgZ(4,"cx-sorting",47),t.NdJ("sortListEvent",function(i){t.CHM(e);const c=t.oxw();return t.KtG(c.changeSortCode(i))}),t.ALo(5,"async"),t.ALo(6,"cxTranslate"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,6,"asm.customerList.tableSort.sortBy")),t.xp6(2),t.s9C("placeholder",t.lcZ(6,10,"asm.customerList.tableSort.sortBy")),t.Q6J("sortOptions",e.sorts)("sortLabels",t.lcZ(5,8,e.getSortLabels()))("selectedOption",e.sortCode)("cxNgSelectA11y",t.VKq(12,Lt,e.sortCode))}}function Sn(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",51),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.goToPreviousPage())}),t._UZ(1,"cx-icon",52),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"cxTranslate"),t.qZA()()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",0===e.currentPage||!e.loaded),t.xp6(1),t.Q6J("type",e.iconTypes.CARET_LEFT),t.xp6(2),t.Oqu(t.lcZ(4,3,"asm.customerList.page.previous"))}}function vn(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",53),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.goToNextPage())}),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA(),t._UZ(4,"cx-icon",54),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",e.currentPage===e.maxPage||!e.loaded),t.xp6(2),t.Oqu(t.lcZ(3,3,"asm.customerList.page.next")),t.xp6(2),t.Q6J("type",e.iconTypes.CARET_RIGHT)}}const Tn=function(n){return{count:n}};function Ln(n,o){if(1&n&&(t.TgZ(0,"div",48)(1,"div"),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA(),t.YNc(4,Sn,5,5,"button",49),t.YNc(5,vn,5,5,"button",50),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.hij(" ",t.xi3(3,3,"asm.customerList.page.page",t.VKq(6,Tn,e.currentPage+1))," "),t.xp6(2),t.Q6J("ngIf",e.maxPage>0),t.xp6(1),t.Q6J("ngIf",e.maxPage>0)}}function bn(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"label")(1,"span",23),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA(),t.TgZ(4,"ng-select",55),t.NdJ("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onChangeCustomerGroup())})("ngModelChange",function(i){t.CHM(e);const c=t.oxw();return t.KtG(c.selectedUserGroupId=i)}),t.qZA()()}if(2&n){const e=o.customerListsPage,s=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,7,"asm.customerList.title")),t.xp6(2),t.Q6J("searchable",!1)("clearable",!1)("tabIndex",0)("ngModel",s.selectedUserGroupId)("items",null==e?null:e.userGroups)("cxNgSelectA11y",t.VKq(9,Lt,s.getGroupName(e,s.selectedUserGroupId)))}}function yn(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",56),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.closeModal("Cross click"))}),t.ALo(1,"cxTranslate"),t.TgZ(2,"span",57),t._UZ(3,"cx-icon",46),t.qZA()()}if(2&n){const e=t.oxw();t.uIk("aria-label",t.lcZ(1,2,"common.close")),t.xp6(3),t.Q6J("type",e.iconTypes.CLOSE)}}var x=(()=>{return(n=x||(x={})).CANCEL="CANCEL",n.REPLACE="REPLACE",x;var n})();let Zn=(()=>{class n{constructor(e){this.launchDialogService=e,this.BIND_CART_ACTION=x,this.focusConfig={trap:!0,block:!0,autofocus:!0,focusOnEscape:!0}}closeModal(e){this.launchDialogService.closeDialog(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.Q3W))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-asm-bind-cart-dialog"]],decls:20,vars:19,consts:[[1,"cx-asm-bind-cart-dialog","cx-modal-container","cx-asm-dialog",3,"cxFocus","esc"],[1,"cx-modal-content"],[1,"cx-dialog-header","modal-header"],["id","asm-bind-cart-dialog-title",1,"title","modal-title"],[1,"cx-dialog-body","modal-body"],[1,"cx-dialog-row"],[1,"cx-dialog-item"],[1,"cx-dialog-footer","modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0),t.NdJ("esc",function(){return s.closeModal(s.BIND_CART_ACTION.CANCEL)}),t.TgZ(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4),t.ALo(5,"cxTranslate"),t.qZA()(),t.TgZ(6,"div",4)(7,"div",5)(8,"div",6),t._uU(9),t.ALo(10,"cxTranslate"),t.qZA()()(),t.TgZ(11,"div",7)(12,"button",8),t.NdJ("click",function(){return s.closeModal(s.BIND_CART_ACTION.REPLACE)}),t.ALo(13,"cxTranslate"),t._uU(14),t.ALo(15,"cxTranslate"),t.qZA(),t.TgZ(16,"button",9),t.NdJ("click",function(){return s.closeModal(s.BIND_CART_ACTION.CANCEL)}),t.ALo(17,"cxTranslate"),t._uU(18),t.ALo(19,"cxTranslate"),t.qZA()()()()),2&e&&(t.Q6J("cxFocus",s.focusConfig),t.xp6(4),t.hij(" ",t.lcZ(5,7,"asm.bindCart.dialog.title")," "),t.xp6(5),t.hij(" ",t.lcZ(10,9,"asm.bindCart.dialog.body")," "),t.xp6(3),t.uIk("aria-label",t.lcZ(13,11,"asm.bindCart.dialog.actions.replace")),t.xp6(2),t.hij(" ",t.lcZ(15,13,"asm.bindCart.dialog.actions.replace")," "),t.xp6(2),t.uIk("aria-label",t.lcZ(17,15,"common.cancel")),t.xp6(2),t.hij(" ",t.lcZ(19,17,"common.cancel")," "))},dependencies:[m.RRe,r.X$D],encapsulation:2}),n})(),In=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-dot-spinner"]],decls:3,vars:0,template:function(e,s){1&e&&t._UZ(0,"div")(1,"div")(2,"div")},encapsulation:2,changeDetection:0}),n})(),En=(()=>{class n{constructor(e,s,i,c,l,g){this.globalMessageService=e,this.activeCartFacade=s,this.multiCartFacade=i,this.asmBindCartFacade=c,this.launchDialogService=l,this.savedCartFacade=g,this.activeCartValidator=y=>y.value===this.activeCartId?{activeCartError:!0}:null,this.cartId=new u.NI("",[u.kI.required,u.kI.minLength(1),this.activeCartValidator]),this.loading$=new bt.X(!1),this.valid$=this.cartId.statusChanges.pipe((0,_.U)(y=>"VALID"===y),(0,Et.d)(1)),this.activeCartId="",this.subscription=new C.w}ngOnInit(){this.subscription.add(this.activeCartFacade.getActiveCartId().subscribe(e=>{this.activeCartId=e??"",this.cartId.setValue(this.activeCartId)}))}resetInput(){this.cartId.value||this.cartId.setValue(this.activeCartId)}bindCartToCustomer(){const e=this.cartId.value,s=(0,O.aj)([this.loading$.asObservable(),this.valid$]).pipe((0,I.q)(1),(0,v.h)(([i,c])=>!i&&c),(0,h.b)(()=>this.loading$.next(!0)),(0,k.b)(()=>(0,yt.s)(()=>Boolean(this.activeCartId),this.openDialog(this.activeCartId,e),this.simpleBindCart(e))),(0,Mt.x)(()=>this.loading$.next(!1))).subscribe(()=>{this.globalMessageService.add({key:"asm.bindCart.success"},r.xUg.MSG_TYPE_CONFIRMATION)},i=>{this.globalMessageService.add(i.details?.[0].message??"",r.xUg.MSG_TYPE_ERROR)});this.subscription.add(s)}clearText(){this.cartId.setValue("")}ngOnDestroy(){this.subscription.unsubscribe()}simpleBindCart(e){return(0,W.P)(()=>this.asmBindCartFacade.bindCart(e)).pipe((0,h.b)(()=>this.multiCartFacade.reloadCart(r.gSv)))}openDialog(e,s){return(0,W.P)(()=>(this.launchDialogService.openDialogAndSubscribe("ASM_BIND_CART",this.bindToCartElemRef),this.launchDialogService.dialogClose.pipe((0,v.h)(i=>Boolean(i)),(0,I.q)(1)))).pipe((0,v.h)(i=>Boolean(i)),(0,k.b)(i=>this.selectBindAction(e,s,i)))}selectBindAction(e,s,i){return i===x.REPLACE?this.replaceCart(e,s):Zt.E}replaceCart(e,s){return this.simpleBindCart(s).pipe((0,h.b)(()=>{this.savedCartFacade.saveCart({cartId:e,saveCartName:e,saveCartDescription:"-"})}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(r.IWp),t.Y36(V.bu),t.Y36(V.WT),t.Y36(f.AE),t.Y36(m.Q3W),t.Y36(Rt.aD))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-asm-bind-cart"]],viewQuery:function(e,s){if(1&e&&t.Gf(jt,5),2&e){let i;t.iGM(i=t.CRH())&&(s.bindToCartElemRef=i.first)}},decls:25,vars:42,consts:[[3,"submit"],["for","cartNumber"],["role","search",1,"cx-asm-assignCart",3,"click"],["autocomplete","off","formcontrolname","cartNumber",3,"formControl","keydown.enter","blur"],["cartIdElement",""],[1,"cx-asm-reset",3,"click"],[1,"cx-icon","fas","fa-times-circle"],["type","submit",1,"cx-asm-bindCartToCustomer",3,"disabled"],["bindToCart",""]],template:function(e,s){if(1&e){const i=t.EpF();t.TgZ(0,"form",0),t.NdJ("submit",function(){return s.bindCartToCustomer()}),t.TgZ(1,"label",1),t._uU(2),t.ALo(3,"cxTranslate"),t.qZA(),t.TgZ(4,"div",2),t.NdJ("click",function(){t.CHM(i);const l=t.MAs(8);return t.KtG(l.focus())}),t.ALo(5,"async"),t.ALo(6,"cxTranslate"),t.TgZ(7,"input",3,4),t.NdJ("keydown.enter",function(){return s.bindCartToCustomer()})("blur",function(){return s.resetInput()}),t.ALo(9,"cxTranslate"),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){return s.clearText()}),t.ALo(11,"cxTranslate"),t._UZ(12,"cx-icon",6),t.qZA()(),t.TgZ(13,"button",7,8),t.ALo(15,"async"),t.ALo(16,"async"),t.ALo(17,"async"),t.TgZ(18,"span"),t.ALo(19,"async"),t._uU(20),t.ALo(21,"cxTranslate"),t.qZA(),t._UZ(22,"cx-dot-spinner"),t.ALo(23,"async"),t.ALo(24,"cxTranslate"),t.qZA()()}2&e&&(t.xp6(2),t.hij("",t.lcZ(3,18,"asm.bindCart.cartNumber")," "),t.xp6(2),t.ekj("active",t.lcZ(5,20,s.valid$)),t.uIk("aria-label",t.lcZ(6,22,"asm.bindCart.assignCartId")),t.xp6(3),t.Q6J("formControl",s.cartId),t.uIk("aria-label",t.lcZ(9,24,"asm.bindCart.enterCartId")),t.xp6(3),t.ekj("visible",(null==s.cartId.value?null:s.cartId.value.length)>0),t.uIk("aria-label",t.lcZ(11,26,"asm.bindCart.resetCartId")),t.xp6(3),t.ekj("cx-asm-active",t.lcZ(15,28,s.valid$))("cx-bind-loading",t.lcZ(16,30,s.loading$)),t.Q6J("disabled",!t.lcZ(17,32,s.valid$)),t.xp6(5),t.uIk("aria-hidden",t.lcZ(19,34,s.loading$)),t.xp6(2),t.hij(" ",t.lcZ(21,36,"asm.bindCart.bindCartToCustomer")," "),t.xp6(2),t.uIk("aria-hidden",!t.lcZ(23,38,s.loading$))("aria-label",t.lcZ(24,40,"common.loading")))},dependencies:[u._Y,u.Fj,u.JJ,u.JL,u.oH,m.oJW,u.F,In,d.Ov,r.X$D],encapsulation:2,changeDetection:0}),n})(),H=(()=>{class n{constructor(e,s,i){this.authService=e,this.csAgentAuthService=s,this.winRef=i}logoutCustomerSupportAgentAndCustomer(){this.csAgentAuthService.logoutCustomerSupportAgent()}logoutCustomer(){this.authService.logout()}isCustomerEmulationSessionInProgress(){return this.csAgentAuthService.isCustomerEmulated()}unload(){this.winRef.localStorage&&this.winRef.localStorage.removeItem(f.AJ)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(r.e80),t.LFG(f.FA),t.LFG(r.X9E))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Mn=(()=>{class n{constructor(e){this.fb=e,this.csAgentTokenLoading=!1,this.submitEvent=new t.vpe}ngOnInit(){this.csAgentLoginForm=this.fb.group({userId:["",[u.kI.required]],password:["",[u.kI.required]]})}onSubmit(){this.csAgentLoginForm.valid?this.submitEvent.emit({userId:this.csAgentLoginForm.get("userId")?.value,password:this.csAgentLoginForm.get("password")?.value}):this.csAgentLoginForm.markAllAsTouched()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.QS))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-csagent-login-form"]],inputs:{csAgentTokenLoading:"csAgentTokenLoading"},outputs:{submitEvent:"submitEvent"},decls:2,vars:2,consts:[[3,"formGroup","ngSubmit",4,"ngIf"],["class","spinner","aria-hidden","false",4,"ngIf"],[3,"formGroup","ngSubmit"],["required","true","type","text","formControlName","userId",3,"placeholder"],[3,"control"],["required","true","type","password","formControlName","password","cxPasswordVisibilitySwitch","",3,"placeholder"],["type","submit"],["aria-hidden","false",1,"spinner"]],template:function(e,s){1&e&&(t.YNc(0,Kt,14,18,"form",0),t.YNc(1,Wt,5,3,"div",1)),2&e&&(t.Q6J("ngIf",!s.csAgentTokenLoading),t.xp6(1),t.Q6J("ngIf",s.csAgentTokenLoading))},dependencies:[d.O5,u._Y,u.Fj,u.JJ,u.JL,u.Q7,u.sg,u.u,m.Ahv,m.X84,r.X$D],encapsulation:2}),n})(),Un=(()=>{class n{constructor(e,s,i){this.fb=e,this.asmService=s,this.config=i,this.subscription=new C.w,this.submitEvent=new t.vpe}ngOnInit(){this.customerSelectionForm=this.fb.group({searchTerm:["",u.kI.required]}),this.asmService.customerSearchReset(),this.searchResultsLoading$=this.asmService.getCustomerSearchResultsLoading(),this.searchResults=this.asmService.getCustomerSearchResults(),this.subscription.add(this.customerSelectionForm.controls.searchTerm.valueChanges.pipe((0,Ut.b)(300)).subscribe(e=>{this.handleSearchTerm(e)}))}handleSearchTerm(e){!!this.selectedCustomer&&e!==this.selectedCustomer.name&&(this.selectedCustomer=void 0),!Boolean(this.selectedCustomer)&&(this.asmService.customerSearchReset(),e.trim().length>=3&&this.asmService.customerSearch({query:e,pageSize:this.config.asm?.customerSearch?.maxResults}))}selectCustomerFromList(e){this.selectedCustomer=e,this.customerSelectionForm.controls.searchTerm.setValue(this.selectedCustomer.name),this.asmService.customerSearchReset()}onSubmit(){this.customerSelectionForm.valid&&this.selectedCustomer?this.submitEvent.emit({customerId:this.selectedCustomer.customerId}):this.customerSelectionForm.markAllAsTouched()}onDocumentClick(e){if(Boolean(this.resultList)){if(this.resultList.nativeElement.contains(e.target)||this.searchTerm.nativeElement.contains(e.target))return;this.asmService.customerSearchReset()}}closeResults(){this.asmService.customerSearchReset()}ngOnDestroy(){this.subscription.unsubscribe(),this.asmService.customerSearchReset()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.QS),t.Y36(F),t.Y36(R))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-customer-selection"]],viewQuery:function(e,s){if(1&e&&(t.Gf(Vt,5),t.Gf(Xt,5)),2&e){let i;t.iGM(i=t.CRH())&&(s.resultList=i.first),t.iGM(i=t.CRH())&&(s.searchTerm=i.first)}},hostBindings:function(e,s){1&e&&t.NdJ("click",function(c){return s.onDocumentClick(c)},!1,t.evT)},outputs:{submitEvent:"submitEvent"},decls:13,vars:16,consts:[[3,"formGroup","ngSubmit"],["required","true","type","text","formControlName","searchTerm",3,"placeholder"],["searchTerm",""],[3,"control"],["type","submit",4,"cxFeatureLevel"],["type","submit",3,"active",4,"cxFeatureLevel"],["class","asm-results",4,"ngIf"],["type","submit"],[1,"asm-results"],["resultList",""],[3,"click",4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],[3,"click"],[1,"result-name"],[1,"result-id"],["aria-hidden","false",1,"spinner"]],template:function(e,s){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return s.onSubmit()}),t.TgZ(1,"label"),t._UZ(2,"input",1,2),t.ALo(4,"cxTranslate"),t.ALo(5,"cxTranslate"),t._UZ(6,"cx-form-errors",3),t.qZA(),t.YNc(7,$t,3,3,"button",4),t.YNc(8,te,3,5,"button",5),t.qZA(),t.YNc(9,se,5,4,"div",6),t.ALo(10,"async"),t.YNc(11,oe,6,3,"div",6),t.ALo(12,"async")),2&e&&(t.Q6J("formGroup",s.customerSelectionForm),t.xp6(2),t.s9C("placeholder",t.lcZ(5,10,"asm.customerSearch.searchTerm.label")),t.uIk("aria-label",t.lcZ(4,8,"asm.customerSearch.searchTerm.label")),t.xp6(4),t.Q6J("control",s.customerSelectionForm.get("searchTerm")),t.xp6(1),t.Q6J("cxFeatureLevel","!5.1"),t.xp6(1),t.Q6J("cxFeatureLevel","5.1"),t.xp6(1),t.Q6J("ngIf",t.lcZ(10,12,s.searchResults)),t.xp6(2),t.Q6J("ngIf",t.lcZ(12,14,s.searchResultsLoading$)))},dependencies:[d.sg,d.O5,u._Y,u.Fj,u.JJ,u.JL,u.Q7,u.sg,u.u,m.Ahv,r.EJv,d.Ov,r.X$D],encapsulation:2}),n})(),Rn=(()=>{class n{transform(e){e<0&&(e=0);const s=Math.floor(e/60),i=e%60;let c;return c=s<10?("00"+s).slice(-2):s+"",`${c}:${("00"+i).slice(-2)}`}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"formatTimer",type:n,pure:!0}),n})(),Fn=(()=>{class n{constructor(e,s,i,c,l){this.config=e,this.asmComponentService=s,this.routingService=i,this.changeDetectorRef=c,this.userIdService=l,this.subscriptions=new C.w,this.maxStartDelayInSeconds=6e4}ngOnInit(){this.timeLeft=this.getTimerStartDelayInSeconds(),this.interval=setInterval(()=>{this.timeLeft>0?this.timeLeft--:(clearInterval(this.interval),this.asmComponentService.logoutCustomerSupportAgentAndCustomer()),this.changeDetectorRef.markForCheck()},1e3),this.resetOnNavigate(),this.resetOnCustomerSessionChange()}resetOnNavigate(){this.subscriptions.add(this.routingService.isNavigating().subscribe(e=>{e&&this.resetTimer()}))}resetOnCustomerSessionChange(){this.subscriptions.add(this.userIdService.getUserId().pipe((0,N.x)()).subscribe(()=>this.resetTimer()))}resetTimer(){this.timeLeft>0&&(this.timeLeft=this.getTimerStartDelayInSeconds())}getTimerStartDelayInSeconds(){return void 0===this.config.asm?.agentSessionTimer?.startingDelayInSeconds?600:this.config.asm.agentSessionTimer.startingDelayInSeconds>this.maxStartDelayInSeconds?this.maxStartDelayInSeconds:this.config.asm.agentSessionTimer.startingDelayInSeconds}ngOnDestroy(){this.subscriptions.unsubscribe(),this.interval&&clearInterval(this.interval)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(R),t.Y36(H),t.Y36(r.Znh),t.Y36(t.sBO),t.Y36(r.XBV))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-asm-session-timer"]],decls:9,vars:12,consts:[[1,"label"],[1,"time"],[1,"reset",3,"title","click"]],template:function(e,s){1&e&&(t.TgZ(0,"span",0),t._uU(1),t.ALo(2,"cxTranslate"),t.qZA(),t.TgZ(3,"span",1),t._uU(4),t.ALo(5,"formatTimer"),t.ALo(6,"cxTranslate"),t.qZA(),t.TgZ(7,"button",2),t.NdJ("click",function(){return s.resetTimer()}),t.ALo(8,"cxTranslate"),t.qZA()),2&e&&(t.xp6(1),t.hij("",t.lcZ(2,4,"asm.agentSessionTimer.label"),":"),t.xp6(3),t.AsE("",t.lcZ(5,6,s.timeLeft)," ",t.lcZ(6,8,"asm.agentSessionTimer.minutes"),""),t.xp6(3),t.s9C("title",t.lcZ(8,10,"asm.agentSessionTimer.reset")))},dependencies:[r.X$D,Rn],encapsulation:2}),n})(),On=(()=>{class n{constructor(e,s){this.asmComponentService=e,this.userAccountFacade=s,this.subscription=new C.w}ngOnInit(){this.subscription.add(this.userAccountFacade.get().subscribe(e=>{e&&(this.customer=e)})),this.isCustomerEmulationSessionInProgress$=this.asmComponentService.isCustomerEmulationSessionInProgress()}logoutCustomer(){this.asmComponentService.logoutCustomer()}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(H),t.Y36(w.gf))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-customer-emulation"]],decls:2,vars:3,consts:[[4,"ngIf"],[4,"cxFeatureLevel"],["formcontrolname","logoutCustomer",3,"click"],["formcontrolname","customer","type","text","disabled","true",3,"placeholder"],[1,"cx-asm-customerInfo"],[1,"cx-asm-name"],[1,"cx-asm-uid"]],template:function(e,s){1&e&&(t.YNc(0,ce,6,5,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,s.isCustomerEmulationSessionInProgress$))},dependencies:[d.O5,r.EJv,En,d.Ov,r.X$D],encapsulation:2}),n})(),kn=(()=>{class n{constructor(e){this.asmService=e,this.subscription=new C.w}ngOnInit(){this.subscription.add(this.asmService.getAsmUiState().subscribe(e=>{this.isCollapsed=void 0!==e.collapsed&&e.collapsed}))}toggleUi(){this.asmService.updateAsmUiState({collapsed:!this.isCollapsed})}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(F))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-asm-toggle-ui"]],decls:4,vars:3,consts:[["tabindex","0","role","button",1,"toggleUi",3,"click"],[3,"ngClass"],["class","label",4,"ngIf"],[1,"label"]],template:function(e,s){1&e&&(t.TgZ(0,"a",0),t.NdJ("click",function(){return s.toggleUi()}),t._UZ(1,"span",1),t.YNc(2,ae,3,3,"span",2),t.YNc(3,le,3,3,"span",2),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngClass",s.isCollapsed?"expandIcon":"collapseIcon"),t.xp6(1),t.Q6J("ngIf",!s.isCollapsed),t.xp6(1),t.Q6J("ngIf",s.isCollapsed))},dependencies:[d.mk,d.O5,r.X$D],encapsulation:2}),n})(),Nn=(()=>{class n{constructor(e,s,i,c,l,g,y,qn){this.authService=e,this.csAgentAuthService=s,this.asmComponentService=i,this.globalMessageService=c,this.routingService=l,this.asmService=g,this.userAccountFacade=y,this.launchDialogService=qn,this.iconTypes=m.e1G,this.disabled=!1,this.startingCustomerSession=!1,this.subscription=new C.w}ngOnInit(){this.customerSupportAgentLoggedIn$=this.csAgentAuthService.isCustomerSupportAgentLoggedIn().pipe((0,N.x)(),(0,h.b)(e=>{e||this.closeModal()})),this.csAgentTokenLoading$=this.csAgentAuthService.getCustomerSupportAgentTokenLoading(),this.customer$=this.authService.isUserLoggedIn().pipe((0,D.w)(e=>e?(this.handleCustomerSessionStartRedirection(),this.userAccountFacade.get()):(0,Z.of)(void 0))),this.isCollapsed$=this.asmService.getAsmUiState().pipe((0,_.U)(e=>void 0!==e.collapsed&&e.collapsed)),this.subscription.add(this.launchDialogService?.dialogClose.pipe((0,v.h)(e=>Boolean(e))).subscribe(e=>{e.selectedUser&&(this.startCustomerEmulationSession(e.selectedUser),e.actionType===f.JR.ORDER_HISTORY&&this.routingService.go({cxRoute:"orders"}))}))}handleCustomerSessionStartRedirection(){this.asmComponentService.isCustomerEmulationSessionInProgress().pipe((0,I.q)(1)).subscribe(e=>{this.startingCustomerSession&&e&&(this.startingCustomerSession=!1,this.globalMessageService.remove(r.xUg.MSG_TYPE_ERROR),this.routingService.go("/"))})}loginCustomerSupportAgent({userId:e,password:s}){this.csAgentAuthService.authorizeCustomerSupportAgent(e,s)}logout(){this.asmComponentService.logoutCustomerSupportAgentAndCustomer()}startCustomerEmulationSession({customerId:e}){e?(this.csAgentAuthService.startCustomerEmulationSession(e),this.startingCustomerSession=!0):this.globalMessageService.add({key:"asm.error.noCustomerId"},r.xUg.MSG_TYPE_ERROR)}hideUi(){this.disabled=!0,this.asmComponentService.unload()}showCustomList(){this.launchDialogService?.openDialogAndSubscribe("ASM_CUSTOMER_LIST",this.element)}closeModal(){this.launchDialogService?.closeDialog("logout")}ngOnDestroy(){this.subscription?.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(r.e80),t.Y36(f.FA),t.Y36(H),t.Y36(r.IWp),t.Y36(r.Znh),t.Y36(F),t.Y36(w.gf),t.Y36(m.Q3W,8))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-asm-main-ui"]],viewQuery:function(e,s){if(1&e&&t.Gf(ue,5),2&e){let i;t.iGM(i=t.CRH())&&(s.element=i.first)}},hostVars:2,hostBindings:function(e,s){2&e&&t.ekj("hidden",s.disabled)},decls:19,vars:21,consts:[[1,"asm-bar"],[1,"asm-bar-branding"],["src","data:image/png;base64,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","width","48","height","24",1,"logo",3,"alt"],[1,"asm-title"],[1,"asm-bar-actions"],[4,"cxFeatureLevel"],[4,"ngIf"],["class","close",3,"title","click",4,"ngIf"],["class","logout",3,"title","click",4,"ngIf"],["class","cx-asm-customer-list",4,"ngIf"],[1,"cx-asm-customer-list"],["tabindex","0","role","button",1,"cx-asm-customer-list-link",3,"click"],["customerListLink",""],[3,"type"],[1,"close",3,"title","click"],[1,"logout",3,"title","click"],[4,"ngIf","ngIfElse"],["showLoginForm",""],["showCustomerSelection",""],[3,"submitEvent",4,"ngIf"],[3,"submitEvent"],[3,"csAgentTokenLoading","submitEvent",4,"ngIf"],[3,"csAgentTokenLoading","submitEvent"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"img",2),t.ALo(3,"cxTranslate"),t.TgZ(4,"div",3),t._uU(5),t.ALo(6,"cxTranslate"),t.qZA()(),t.TgZ(7,"div",4),t.YNc(8,de,3,3,"ng-container",5),t._UZ(9,"cx-asm-toggle-ui"),t.YNc(10,pe,1,0,"cx-asm-session-timer",6),t.ALo(11,"async"),t.YNc(12,ge,2,3,"button",7),t.ALo(13,"async"),t.ALo(14,"async"),t.YNc(15,_e,2,3,"button",8),t.ALo(16,"async"),t.qZA()(),t.YNc(17,Te,5,4,"ng-container",6),t.ALo(18,"async")),2&e&&(t.xp6(2),t.s9C("alt",t.lcZ(3,7,"asm.mainLogoLabel")),t.xp6(3),t.hij(" ",t.lcZ(6,9,"asm.mainTitle")," "),t.xp6(3),t.Q6J("cxFeatureLevel","5.1"),t.xp6(2),t.Q6J("ngIf",t.lcZ(11,11,s.customerSupportAgentLoggedIn$)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(13,13,s.customerSupportAgentLoggedIn$)&&!t.lcZ(14,15,s.csAgentTokenLoading$)),t.xp6(3),t.Q6J("ngIf",t.lcZ(16,17,s.customerSupportAgentLoggedIn$)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(18,19,s.isCollapsed$)))},dependencies:[d.O5,m.oJW,r.EJv,Mn,Un,Fn,On,kn,d.Ov,r.X$D],encapsulation:2}),n})();const Dn={launch:{ASM_CUSTOMER_LIST:{inlineRoot:!0,component:(()=>{class n{constructor(e,s,i,c,l,g){this.launchDialogService=e,this.asmService=s,this.breakpointService=i,this.asmConfig=c,this.translation=l,this.asmCustomerListFacade=g,this.DEFAULT_PAGE_SIZE=5,this.focusConfig={trap:!0,block:!0,autofocus:"customer-list-selector",ignoreUpDownArrowKeys:!0,focusOnEscape:!0},this.iconTypes=m.e1G,this.BREAKPOINT=m.Bst,this.currentPage=0,this.maxPage=0,this.loaded=!1,this.listsError=!1,this.listsEmpty=!1,this.teardown=new C.w,this.breakpoint$=this.getBreakpoint()}ngOnInit(){this.pageSize=this.asmConfig.asm?.customerList?.pageSize??this.DEFAULT_PAGE_SIZE,this.customerListConfig=this.asmConfig?.asm?.customerList,this.customerListsPage$=this.asmCustomerListFacade.getCustomerListsState().pipe((0,h.b)(e=>this.listsError=!!e.error),(0,_.U)(e=>0===e?.data?.userGroups?.length?void(this.listsEmpty=!0):e.data),(0,N.x)(),(0,h.b)(e=>{this.selectedUserGroupId||(this.selectedUserGroupId=e?.userGroups?.[0]?.uid,this.sorts=null,this.fetchCustomers())}))??It.C,this.customerSearchLoading$=this.asmService.getCustomerListCustomersSearchResultsLoading().pipe((0,h.b)(e=>this.loaded=!e)),this.teardown.add(this.customerSearchLoading$.subscribe()),this.teardown.add(()=>this.asmService.customerListCustomersSearchReset()),this.customerSearchError$=this.asmService.getCustomerListCustomersSearchResultsError(),this.customerSearchPage$=this.asmService.getCustomerListCustomersSearchResults().pipe((0,h.b)(e=>{e?.sorts&&(this.sorts=e.sorts,this.sortCode=e.pagination?.sort),this.maxPage=e?.entries.length<this.pageSize?e.pagination?.currentPage??0:this.currentPage+1}))}ngOnDestroy(){this.teardown.unsubscribe()}fetchCustomers(){if(this.selectedUserGroupId){const e={customerListId:this.selectedUserGroupId,pageSize:this.pageSize,currentPage:this.currentPage};this.sortCode&&(e.sort=this.sortCode),this.asmService.customerListCustomersSearchReset(),this.asmService.customerListCustomersSearch(e)}}onChangeCustomerGroup(){this.currentPage=0,this.sorts=null,this.sortCode="",this.fetchCustomers()}getGroupName(e,s){return e?.userGroups?.find(i=>i.uid===s)?.name??""}getBadgeText(e){return(e.firstName?.charAt(0)??"")+(e.lastName?.charAt(0)??"")}startColumnAction(e,s){this.selectedCustomer=e,this.closeModal({actionType:s,selectedUser:e})}changeSortCode(e){this.sortCode=e,this.fetchCustomers()}goToNextPage(){this.currentPage>=this.maxPage?this.currentPage=this.maxPage:this.loaded&&(this.currentPage++,this.fetchCustomers())}goToPreviousPage(){this.currentPage<=0?this.currentPage=0:this.loaded&&(this.currentPage--,this.fetchCustomers())}closeModal(e){this.launchDialogService.closeDialog(e)}getSortLabels(){return(0,O.aj)([this.translation.translate("asm.customerList.tableSort.byNameAsc"),this.translation.translate("asm.customerList.tableSort.byNameDesc"),this.translation.translate("asm.customerList.tableSort.byDateAsc"),this.translation.translate("asm.customerList.tableSort.byDateDesc"),this.translation.translate("asm.customerList.tableSort.byOrderDateAsc"),this.translation.translate("asm.customerList.tableSort.byOrderDateDesc")]).pipe((0,_.U)(([e,s,i,c,l,g])=>({byNameAsc:e,byNameDesc:s,byOrderDateAsc:i,byOrderDateDesc:c,byDateAsc:l,byDateDesc:g})))}getBreakpoint(){return this.breakpointService.breakpoint$.pipe((0,_.U)(e=>((e===m.Bst.lg||e===m.Bst.xl)&&(e=m.Bst.md),e)))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.Q3W),t.Y36(F),t.Y36(m.r),t.Y36(R),t.Y36(r.D7D),t.Y36(f.AH))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cx-customer-list"]],decls:36,vars:22,consts:[[1,"cx-asm-customer-list","cx-modal-container","cx-asm-dialog",3,"cxFocus","esc"],[1,"cx-modal-content"],[1,"cx-dialog-header","modal-header"],["id","asm-customer-list-title",1,"title","modal-title"],["id","asm-customer-list-desc",1,"cx-visually-hidden"],[4,"ngTemplateOutlet"],["class","cx-dialog-sub-header modal-header",3,"tablet-mobile",4,"ngIf"],[1,"cx-dialog-body","modal-body"],[1,"cx-dialog-row"],[1,"cx-dialog-item"],["class","cx-error-state",4,"ngIf"],[4,"ngIf"],["cell",""],["cellContent",""],["sort",""],["pagination",""],["groupSelector",""],["closeButton",""],[1,"cx-dialog-sub-header","modal-header"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cx-header-actions"],[1,"cx-error-state"],["id","asm-cusomer-list-table","role","table",1,"table"],[1,"cx-visually-hidden"],["role","row",4,"ngFor","ngForOf"],["class","cx-empty-state",4,"ngIf"],["role","row"],["role","columnheader","class","cx-avatar-cell",4,"ngIf"],["role","columnheader",4,"ngFor","ngForOf"],["role","columnheader",1,"cx-avatar-cell"],["role","columnheader"],["role","cell","class","cx-avatar-cell",4,"ngIf"],["role","cell","class","cx-multi-cell",4,"ngIf"],["role","cell",1,"cx-avatar-cell"],[1,"cx-avatar"],["role","cell",4,"ngFor","ngForOf"],["role","cell"],["role","cell",1,"cx-multi-cell"],[4,"ngFor","ngForOf"],[1,"cx-empty-state"],[1,"cx-cell-container"],["class","cx-header-text",4,"ngIf"],["class","btn btn-link cx-action-link cx-btn-cell",3,"click",4,"ngIf"],[1,"cx-header-text"],[1,"btn","btn-link","cx-action-link","cx-btn-cell",3,"click"],[3,"cx-action-color","type",4,"ngIf"],[3,"type"],[1,"sort-selector",3,"sortOptions","sortLabels","selectedOption","placeholder","cxNgSelectA11y","sortListEvent"],[1,"cx-pagination-buttons"],["class","btn btn-link cx-action-link cx-btn-previous",3,"disabled","click",4,"ngIf"],["class","btn btn-link cx-action-link cx-btn-next",3,"disabled","click",4,"ngIf"],[1,"btn","btn-link","cx-action-link","cx-btn-previous",3,"disabled","click"],[1,"previous",3,"type"],[1,"btn","btn-link","cx-action-link","cx-btn-next",3,"disabled","click"],[1,"next",3,"type"],["bindLabel","name","bindValue","uid",1,"customer-list-selector",3,"searchable","clearable","tabIndex","ngModel","items","cxNgSelectA11y","change","ngModelChange"],["type","button",1,"close",3,"click"],["aria-hidden","true"]],template:function(e,s){if(1&e&&(t.TgZ(0,"div",0),t.NdJ("esc",function(){return s.closeModal("Escape clicked")}),t.TgZ(1,"div",1),t.ynx(2),t.TgZ(3,"div",2)(4,"h2",3),t._uU(5),t.ALo(6,"cxTranslate"),t.qZA(),t.TgZ(7,"div",4),t._uU(8),t.ALo(9,"cxTranslate"),t.qZA(),t.YNc(10,be,1,0,null,5),t.qZA(),t.YNc(11,Fe,7,14,"div",6),t.ALo(12,"async"),t.TgZ(13,"div",7)(14,"div",8)(15,"div",9),t.YNc(16,Oe,3,3,"div",10),t.YNc(17,ke,3,3,"div",10),t.YNc(18,Ne,3,3,"div",10),t.ALo(19,"async"),t.YNc(20,De,1,0,"cx-spinner",11),t.ALo(21,"async"),t.YNc(22,un,10,8,"div",11),t.ALo(23,"async"),t.qZA()()(),t.BQk(),t.qZA()(),t.YNc(24,fn,4,3,"ng-template",null,12,t.W1O),t.YNc(26,An,2,2,"ng-template",null,13,t.W1O),t.YNc(28,xn,7,14,"ng-template",null,14,t.W1O),t.YNc(30,Ln,6,8,"ng-template",null,15,t.W1O),t.YNc(32,bn,5,11,"ng-template",null,16,t.W1O),t.YNc(34,yn,4,4,"ng-template",null,17,t.W1O)),2&e){const i=t.MAs(35);t.Q6J("cxFocus",s.focusConfig),t.xp6(5),t.hij(" ",t.lcZ(6,10,"asm.customerList.title")," "),t.xp6(3),t.hij(" ",t.lcZ(9,12,"asm.customerList.description")," "),t.xp6(2),t.Q6J("ngTemplateOutlet",i),t.xp6(1),t.Q6J("ngIf",t.lcZ(12,14,s.customerListsPage$)),t.xp6(5),t.Q6J("ngIf",s.listsEmpty),t.xp6(1),t.Q6J("ngIf",s.listsError),t.xp6(1),t.Q6J("ngIf",t.lcZ(19,16,s.customerSearchError$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(21,18,s.customerSearchLoading$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(23,20,s.customerSearchPage$))}},dependencies:[d.sg,d.O5,d.tP,u.JJ,m.oJW,X.w9,u.On,m.ORR,m.RRe,m.VnX,m.iNG,d.Ov,r.X$D],encapsulation:2}),n})(),dialogType:m.Myk.DIALOG}}},wn={launch:{ASM:{outlet:"cx-storefront",component:Nn}}},Jn={launch:{ASM_BIND_CART:{inlineRoot:!0,component:Zn,dialogType:m.Myk.DIALOG}}};let Yn=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[(0,r.i51)(wn),(0,r.i51)(Jn),(0,r.i51)(Dn)],imports:[d.ez,u.UX,r.LUR,m.Fym,m.QX1,X.A0,u.u5,m.Fme,m.Ird,m.oPH,m.LcC,m.U67,r.GSh]}),n})();var S=a(529),j=a(1737);let Pn=(()=>{class n{constructor(e,s,i,c,l){this.http=e,this.occEndpointsService=s,this.converterService=i,this.config=c,this.baseSiteService=l,this.baseSiteService.getActive().subscribe(g=>this.activeBaseSite=g)}getHeaders(){return r.Fox.createHeader(r.OPk,!0,new S.WM)}customerLists(){const e=this.getHeaders(),s=(new S.LE).set("baseSite",this.activeBaseSite),i=this.occEndpointsService.buildUrl("asmCustomerLists",{},{baseSite:!1,prefix:!1});return this.http.get(i,{headers:e,params:s}).pipe((0,T.K)(c=>(0,j._)((0,r.cxH)(c))),this.converterService.pipeable(Ot))}customerSearch(e){const s=this.getHeaders();let i=(new S.LE).set("baseSite",this.activeBaseSite);void 0!==e.sort?i=i.set("sort",e.sort):e.customerListId||(i=i.set("sort","byNameAsc")),void 0!==e.query&&(i=i.set("query",e.query)),void 0!==e.pageSize&&(i=i.set("pageSize",e.pageSize.toString())),void 0!==e.currentPage&&(i=i.set("currentPage",e.currentPage.toString())),void 0!==e.customerListId&&(i=i.set("customerListId",e.customerListId));const c=this.occEndpointsService.buildUrl("asmCustomerSearch",{},{baseSite:!1,prefix:!1});return this.http.get(c,{headers:s,params:i}).pipe((0,T.K)(l=>(0,j._)((0,r.cxH)(l))),this.converterService.pipeable(Ft))}bindCart({cartId:e,customerId:s}){const i=r.Fox.createHeader(r.OPk,!0,new S.WM),c=(new S.LE).set("baseSite",this.activeBaseSite).set("cartId",e).set("customerId",s),l=this.occEndpointsService.buildUrl("asmBindCart",{},{baseSite:!1,prefix:!1});return this.http.post(l,{},{headers:i,params:c}).pipe((0,T.K)(g=>(0,j._)((0,r.cxH)(g))))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(S.eN),t.LFG(r.Lz0),t.LFG(r.IXI),t.LFG(R),t.LFG(r.Do$))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();const Qn={backend:{occ:{endpoints:{asmCustomerSearch:"/assistedservicewebservices/customers/search",asmCustomerLists:"/assistedservicewebservices/customerlists",asmBindCart:"/assistedservicewebservices/bind-cart"}}}};let Bn=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[(0,r.i51)(Qn),{provide:$,useClass:Pn}],imports:[d.ez]}),n})(),Gn=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[Yn,Ht,Bn]}),n})()}}]);