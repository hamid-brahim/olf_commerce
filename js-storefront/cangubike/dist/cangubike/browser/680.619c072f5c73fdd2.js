"use strict";(self.webpackChunkcangubike=self.webpackChunkcangubike||[]).push([[680],{6680:(C,d,o)=>{o.r(d),o.d(d,{BulkPricingModule:()=>B});var n=o(4650),l=o(6895),u=o(9057),f=o(1446),g=o(7545),p=o(1086);let m=(()=>{class e{constructor(t){this.productService=t,this.PRODUCT_SCOPE="bulkPrices"}getBulkPrices(t){return this.productService.get(t,this.PRODUCT_SCOPE).pipe((0,g.w)(i=>(0,p.of)(this.convert(i))))}convert(t){let i=[];if(t){const r=t.price?.value;i=t.volumePrices?.map(a=>this.parsePrice(a,r))}return i}parsePrice(t,i){return this.calculateDiscount({currencyIso:t.currencyIso,formattedValue:t.formattedValue,maxQuantity:t.maxQuantity,minQuantity:t.minQuantity,priceType:t.priceType,value:t.value,formattedDiscount:"",discount:0},i)}calculateDiscount(t,i){const r=Object.assign({},t),s=t.value;if(s&&i){const a=Math.round(100-s/i*100);r.formattedDiscount=0===a?`${a}%`:`-${a}%`,r.discount=a}return r}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(u.M52))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function v(e,c){if(1&e&&(n.TgZ(0,"tr")(1,"td"),n._uU(2),n.qZA(),n.TgZ(3,"td"),n._uU(4),n.qZA(),n.TgZ(5,"td"),n._uU(6),n.qZA()()),2&e){const t=c.$implicit,i=n.oxw(3);n.xp6(2),n.Oqu(i.formatQuantity(t)),n.xp6(2),n.Oqu(t.formattedValue),n.xp6(2),n.Oqu(t.formattedDiscount)}}function P(e,c){if(1&e&&(n.TgZ(0,"div",2)(1,"table",3)(2,"thead",4)(3,"tr")(4,"th",5),n._uU(5),n.ALo(6,"cxTranslate"),n.qZA(),n.TgZ(7,"th",5),n._uU(8),n.ALo(9,"cxTranslate"),n.qZA(),n.TgZ(10,"th",5),n._uU(11),n.ALo(12,"cxTranslate"),n.qZA()()(),n.TgZ(13,"tbody"),n.YNc(14,v,7,3,"tr",6),n.qZA()()()),2&e){const t=n.oxw().ngIf;n.xp6(5),n.Oqu(n.lcZ(6,4,"bulkPricingTable.quantity")),n.xp6(3),n.Oqu(n.lcZ(9,6,"bulkPricingTable.price")),n.xp6(3),n.Oqu(n.lcZ(12,8,"bulkPricingTable.discount")),n.xp6(3),n.Q6J("ngForOf",t)}}function k(e,c){if(1&e&&(n.ynx(0),n.YNc(1,P,15,10,"div",1),n.BQk()),2&e){const t=c.ngIf;n.xp6(1),n.Q6J("ngIf",t.length>0)}}let y=(()=>{class e{constructor(t,i){this.routingService=t,this.bulkPricingService=i,this.PRODUCT_KEY="productCode"}ngOnInit(){this.priceTiers$=this.getPrices()}formatQuantity(t){let i="";return i=t.maxQuantity?t.minQuantity+" - "+t.maxQuantity:t.minQuantity+"+",i}getPrices(){return this.routingService.getRouterState().pipe((0,g.w)(t=>this.bulkPricingService.getBulkPrices(t.state.params[this.PRODUCT_KEY])))}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(u.Znh),n.Y36(m))},e.\u0275cmp=n.Xpm({type:e,selectors:[["cx-bulk-pricing-table"]],decls:2,vars:3,consts:[[4,"ngIf"],["class","container",4,"ngIf"],[1,"container"],[1,"table"],[1,"thead-light"],["scope","col"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(n.YNc(0,k,2,1,"ng-container",0),n.ALo(1,"async")),2&t&&n.Q6J("ngIf",n.lcZ(1,1,i.priceTiers$))},dependencies:[l.sg,l.O5,l.Ov,u.X$D],encapsulation:2}),e})(),T=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[l.ez,u.LUR,f.Fme,u.pEA.withConfig({cmsComponents:{BulkPricingTableComponent:{component:y}}})]}),e})();const h={backend:{occ:{endpoints:{product:{bulkPrices:"orgProducts/${productCode}?fields=price(DEFAULT),volumePrices(FULL)"}}}}};let b=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({providers:[(0,u.i51)(h)],imports:[l.ez]}),e})(),B=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[b,T]}),e})()}}]);