"use strict";var __defProp=Object.defineProperty,__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});exports.id=860,exports.ids=[860,664],exports.modules={5664:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AddToCartComponent:()=>AddToCartComponent,AddToCartModule:()=>AddToCartModule});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5e3),_angular_forms__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3075),_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(8374),_spartacus_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5945),rxjs_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4850),rxjs_operators__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2198),rxjs_operators__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2986),_spartacus_storefront__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(8807),_angular_common__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(9808);function AddToCartComponent_form_0_div_1_cx_item_counter_5_Template(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__._UZ(0,"cx-item-counter",9),2&rf){const ctx_r3=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oxw(3);_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("max",ctx_r3.maxQuantity)("control",ctx_r3.addToCartForm.get("quantity"))}}function AddToCartComponent_form_0_div_1_span_7_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(0,"span"),_angular_core__WEBPACK_IMPORTED_MODULE_0__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA()),2&rf){const ctx_r4=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oxw(3);_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Oqu(ctx_r4.getInventory())}}function AddToCartComponent_form_0_div_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(0,"div",4)(1,"label"),_angular_core__WEBPACK_IMPORTED_MODULE_0__._uU(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(3,"cxTranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(4,"div",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__.YNc(5,AddToCartComponent_form_0_div_1_cx_item_counter_5_Template,1,2,"cx-item-counter",6),_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(6,"span",7),_angular_core__WEBPACK_IMPORTED_MODULE_0__.YNc(7,AddToCartComponent_form_0_div_1_span_7_Template,2,1,"span",8),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(8,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_0__._uU(9),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(10,"cxTranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(11,"cxTranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA()()()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oxw(2);_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Oqu(_angular_core__WEBPACK_IMPORTED_MODULE_0__.lcZ(3,4,"addToCart.quantity")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("ngIf",ctx_r1.hasStock),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("ngIf",_angular_core__WEBPACK_IMPORTED_MODULE_0__.lcZ(8,6,ctx_r1.showInventory$)),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.hij(" ",ctx_r1.hasStock?_angular_core__WEBPACK_IMPORTED_MODULE_0__.lcZ(10,8,"addToCart.inStock"):_angular_core__WEBPACK_IMPORTED_MODULE_0__.lcZ(11,10,"addToCart.outOfStock"),"")}}function AddToCartComponent_form_0_button_2_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(0,"button",10),_angular_core__WEBPACK_IMPORTED_MODULE_0__._uU(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.ALo(2,"cxTranslate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA()),2&rf){const ctx_r2=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oxw(2);let tmp_2_0;_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("ngClass",null!=ctx_r2.options&&ctx_r2.options.displayAddToCart?"link cx-action-link":"btn btn-primary btn-block")("disabled",ctx_r2.quantity<=0||ctx_r2.quantity>ctx_r2.maxQuantity),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.hij(" ",null!==(tmp_2_0=null==ctx_r2.options?null:ctx_r2.options.addToCartString)&&void 0!==tmp_2_0?tmp_2_0:_angular_core__WEBPACK_IMPORTED_MODULE_0__.lcZ(2,3,"addToCart.addToCart")," ")}}function AddToCartComponent_form_0_Template(rf,ctx){if(1&rf){const _r6=_angular_core__WEBPACK_IMPORTED_MODULE_0__.EpF();_angular_core__WEBPACK_IMPORTED_MODULE_0__.TgZ(0,"form",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.NdJ("submit",__name(function(){_angular_core__WEBPACK_IMPORTED_MODULE_0__.CHM(_r6);const ctx_r5=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oxw();return _angular_core__WEBPACK_IMPORTED_MODULE_0__.KtG(ctx_r5.addToCart())},"AddToCartComponent_form_0_Template_form_submit_0_listener")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.YNc(1,AddToCartComponent_form_0_div_1_Template,12,12,"div",2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.YNc(2,AddToCartComponent_form_0_button_2_Template,3,5,"button",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.qZA()}if(2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oxw();_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("formGroup",ctx_r0.addToCartForm),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("ngIf",ctx_r0.showQuantity),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xp6(1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("ngIf",ctx_r0.hasStock)}}__name(AddToCartComponent_form_0_div_1_cx_item_counter_5_Template,"AddToCartComponent_form_0_div_1_cx_item_counter_5_Template"),__name(AddToCartComponent_form_0_div_1_span_7_Template,"AddToCartComponent_form_0_div_1_span_7_Template"),__name(AddToCartComponent_form_0_div_1_Template,"AddToCartComponent_form_0_div_1_Template"),__name(AddToCartComponent_form_0_button_2_Template,"AddToCartComponent_form_0_button_2_Template"),__name(AddToCartComponent_form_0_Template,"AddToCartComponent_form_0_Template");class AddToCartComponent{constructor(currentProductService,cd,activeCartService,component,eventService,productListItemContext){var _a;this.currentProductService=currentProductService,this.cd=cd,this.activeCartService=activeCartService,this.component=component,this.eventService=eventService,this.productListItemContext=productListItemContext,this.showQuantity=!0,this.hasStock=!1,this.inventoryThreshold=!1,this.showInventory$=null===(_a=this.component)||void 0===_a?void 0:_a.data$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_1__.U)(data=>data.inventoryDisplay)),this.quantity=1,this.addToCartForm=new _angular_forms__WEBPACK_IMPORTED_MODULE_2__.nJ({quantity:new _angular_forms__WEBPACK_IMPORTED_MODULE_2__.p4(1,{updateOn:"blur"})})}ngOnInit(){var _a;this.product?(this.productCode=null!==(_a=this.product.code)&&void 0!==_a?_a:"",this.setStockInfo(this.product),this.cd.markForCheck()):this.productCode?(this.quantity=1,this.hasStock=!0,this.cd.markForCheck()):this.subscription=(this.productListItemContext?this.productListItemContext.product$:this.currentProductService.getProduct()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.h)(_spartacus_core__WEBPACK_IMPORTED_MODULE_4__.jWE)).subscribe(product=>{var _a2;this.productCode=null!==(_a2=product.code)&&void 0!==_a2?_a2:"",this.setStockInfo(product),this.cd.markForCheck()})}setStockInfo(product){var _a,_b,_c,_d;this.quantity=1,this.hasStock=Boolean("outOfStock"!==(null===(_a=product.stock)||void 0===_a?void 0:_a.stockLevelStatus)),this.inventoryThreshold=null!==(_c=null===(_b=product.stock)||void 0===_b?void 0:_b.isValueRounded)&&void 0!==_c&&_c,this.hasStock&&(null===(_d=product.stock)||void 0===_d?void 0:_d.stockLevel)&&(this.maxQuantity=product.stock.stockLevel),this.productListItemContext&&(this.showQuantity=!1)}getInventory(){if(this.hasStock){const quantityDisplay=this.maxQuantity?this.maxQuantity.toString():"";return this.inventoryThreshold?quantityDisplay+"+":quantityDisplay}return""}updateCount(value){this.quantity=value}addToCart(){var _a;const quantity=null===(_a=this.addToCartForm.get("quantity"))||void 0===_a?void 0:_a.value;!this.productCode||quantity<=0||this.activeCartService.getEntries().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.q)(1)).subscribe(cartEntries=>{this.activeCartService.addEntry(this.productCode,quantity),this.eventService.dispatch(this.createCartUiEventAddToCart(this.productCode,quantity,cartEntries.length))})}createCartUiEventAddToCart(productCode,quantity,numberOfEntriesBeforeAdd){const newEvent=new _spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_6__.wj;return newEvent.productCode=productCode,newEvent.quantity=quantity,newEvent.numberOfEntriesBeforeAdd=numberOfEntriesBeforeAdd,newEvent}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}__name(AddToCartComponent,"AddToCartComponent"),AddToCartComponent.\u0275fac=__name(function(t){return new(t||AddToCartComponent)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y36(_spartacus_storefront__WEBPACK_IMPORTED_MODULE_7__.pHG),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y36(_angular_core__WEBPACK_IMPORTED_MODULE_0__.sBO),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y36(_spartacus_cart_base_root__WEBPACK_IMPORTED_MODULE_6__.bu),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y36(_spartacus_storefront__WEBPACK_IMPORTED_MODULE_7__.exf),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y36(_spartacus_core__WEBPACK_IMPORTED_MODULE_4__.POd),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y36(_spartacus_storefront__WEBPACK_IMPORTED_MODULE_7__.Z6X,8))},"AddToCartComponent_Factory"),AddToCartComponent.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Xpm({type:AddToCartComponent,selectors:[["cx-add-to-cart"]],inputs:{productCode:"productCode",showQuantity:"showQuantity",options:"options",product:"product"},decls:1,vars:1,consts:[[3,"formGroup","submit",4,"ngIf"],[3,"formGroup","submit"],["class","quantity",4,"ngIf"],["type","submit",3,"ngClass","disabled",4,"ngIf"],[1,"quantity"],[1,"cx-counter-stock"],[3,"max","control",4,"ngIf"],[1,"info"],[4,"ngIf"],[3,"max","control"],["type","submit",3,"ngClass","disabled"]],template:__name(function(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__.YNc(0,AddToCartComponent_form_0_Template,3,3,"form",0),2&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__.Q6J("ngIf",ctx.productCode)},"AddToCartComponent_Template"),dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_8__.mk,_angular_common__WEBPACK_IMPORTED_MODULE_8__.O5,_angular_forms__WEBPACK_IMPORTED_MODULE_2__._Y,_angular_forms__WEBPACK_IMPORTED_MODULE_2__.JL,_angular_forms__WEBPACK_IMPORTED_MODULE_2__.sg,_spartacus_storefront__WEBPACK_IMPORTED_MODULE_7__.odZ,_angular_common__WEBPACK_IMPORTED_MODULE_8__.Ov,_spartacus_core__WEBPACK_IMPORTED_MODULE_4__.X$D],encapsulation:2,changeDetection:0});class AddToCartModule{}__name(AddToCartModule,"AddToCartModule"),AddToCartModule.\u0275fac=__name(function(t){return new(t||AddToCartModule)},"AddToCartModule_Factory"),AddToCartModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oAB({type:AddToCartModule}),AddToCartModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.cJS({providers:[(0,_spartacus_core__WEBPACK_IMPORTED_MODULE_4__.i51)({cmsComponents:{ProductAddToCartComponent:{component:AddToCartComponent,data:{inventoryDisplay:!1}}}})],imports:[_angular_common__WEBPACK_IMPORTED_MODULE_8__.ez,_angular_forms__WEBPACK_IMPORTED_MODULE_2__.UX,_spartacus_core__WEBPACK_IMPORTED_MODULE_4__.LUR,_spartacus_storefront__WEBPACK_IMPORTED_MODULE_7__.Td$]})},1860:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EpdVisualizationModule:()=>EpdVisualizationModule});var core=__webpack_require__(5e3),common=__webpack_require__(9808),router=__webpack_require__(9516),spartacus_core=__webpack_require__(5945),spartacus_storefront=__webpack_require__(8807),spartacus_epd_visualization_root=__webpack_require__(9499),BehaviorSubject=__webpack_require__(591),of=__webpack_require__(1086),Observable=__webpack_require__(6498),combineLatest=__webpack_require__(6053),concat=__webpack_require__(1221),Subject=__webpack_require__(8929),mergeMap=__webpack_require__(1709),shareReplay=__webpack_require__(5154),first=__webpack_require__(7224),filter=__webpack_require__(2198),catchError=__webpack_require__(7221),map=__webpack_require__(4850),distinctUntilChanged=__webpack_require__(5778),tap=__webpack_require__(2994),switchMap=__webpack_require__(7545);const NODES_RESPONSE_NORMALIZER=new core.OlP("NodesResponseNormalizer");var MetadatumValueType,MetadatumValueType2;(MetadatumValueType2=MetadatumValueType||(MetadatumValueType={})).string="string",MetadatumValueType2.integer="integer",MetadatumValueType2.float="float",MetadatumValueType2.date="date",MetadatumValueType2.blob="blob",MetadatumValueType2.string_array="string_array";class SceneAdapter{}__name(SceneAdapter,"SceneAdapter");class SceneConnector{constructor(sceneAdapter){this.sceneAdapter=sceneAdapter}getNodes(sceneId,nodeIds,$expand,$filter,contentType){return this.sceneAdapter.getNodes(sceneId,nodeIds,$expand,$filter,contentType)}}__name(SceneConnector,"SceneConnector"),SceneConnector.\u0275fac=__name(function(t){return new(t||SceneConnector)(core.LFG(SceneAdapter))},"SceneConnector_Factory"),SceneConnector.\u0275prov=core.Yz7({token:SceneConnector,factory:SceneConnector.\u0275fac,providedIn:"root"});const LOOKUP_VISUALIZATIONS_RESPONSE_NORMALIZER=new core.OlP("LookupVisualizationsResponseNormalizer");class VisualizationAdapter{}__name(VisualizationAdapter,"VisualizationAdapter");class VisualizationConnector{constructor(visualizationAdapter){this.visualizationAdapter=visualizationAdapter}lookupVisualization(visualizationUsageId,folderUsageId){return this.visualizationAdapter.lookupVisualization(visualizationUsageId,folderUsageId)}}__name(VisualizationConnector,"VisualizationConnector"),VisualizationConnector.\u0275fac=__name(function(t){return new(t||VisualizationConnector)(core.LFG(VisualizationAdapter))},"VisualizationConnector_Factory"),VisualizationConnector.\u0275prov=core.Yz7({token:VisualizationConnector,factory:VisualizationConnector.\u0275fac,providedIn:"root"});class SceneNodeToProductLookupService{constructor(epdVisualizationConfig,sceneConnector){this.epdVisualizationConfig=epdVisualizationConfig,this.sceneConnector=sceneConnector,this.productCodesByNodeIdMap$=new BehaviorSubject.X(new Map),this.nodeIdsByProductCodeMap$=new BehaviorSubject.X(new Map);const usageIdConfig=this.epdVisualizationConfig.epdVisualization.usageIds;this.usageId=usageIdConfig.productUsageId}populateMapsForScene(sceneId){this.getNodeIdProductCodesForScene(sceneId).pipe((0,first.P)()).subscribe(nodeIdProductCodes=>{this.productCodesByNodeIdMap$.next(this.getProductCodesByNodeIdMap(nodeIdProductCodes)),this.nodeIdsByProductCodeMap$.next(this.getNodeIdsByProductCodeMap(nodeIdProductCodes))})}getNodeIdProductCodesForScene(sceneId){return this.sceneConnector.getNodes(sceneId,void 0,["hotspot",`metadata[${this.usageId.source}].${this.usageId.category}.${this.usageId.keyName}`],[`metadata[${this.usageId.source}].${this.usageId.category}.${this.usageId.keyName}`],"*").pipe((0,map.U)(data=>data.nodes.filter(node=>node.metadata&&node.metadata.length).map(node=>({nodeId:node.sid,productCodes:node.metadata.map(metadata=>metadata.value)}))))}getProductCodesByNodeIdMap(nodeIdProductCodes){return nodeIdProductCodes.reduce((productCodeByNodeIdMap,nodeIdProductCodeTuple)=>(productCodeByNodeIdMap.set(nodeIdProductCodeTuple.nodeId,nodeIdProductCodeTuple.productCodes),productCodeByNodeIdMap),new Map)}getNodeIdsByProductCodeMap(nodeIdProductCodes){return nodeIdProductCodes.reduce((nodeIdByProductCodeMap,nodeIdProductCodeTuple)=>(nodeIdProductCodeTuple.productCodes.forEach(productCode=>{const nodeIds=nodeIdByProductCodeMap.get(productCode);void 0!==nodeIds?nodeIds.push(nodeIdProductCodeTuple.nodeId):nodeIdByProductCodeMap.set(productCode,[nodeIdProductCodeTuple.nodeId])}),nodeIdByProductCodeMap),new Map)}distinct(values){const uniqueArray=[],valueSet=new Set;return values.forEach(value=>{valueSet.has(value)||(valueSet.add(value),uniqueArray.push(value))}),uniqueArray}_lookupProductCodes(productCodesByNodeIdMap,nodeIds){return this.distinct(nodeIds.flatMap(nodeId=>productCodesByNodeIdMap.get(nodeId)||[]))}lookupProductCodes(nodeIds){return this.productCodesByNodeIdMap$.pipe((0,first.P)(),(0,map.U)(productCodesByNodeIdMap=>this._lookupProductCodes(productCodesByNodeIdMap,nodeIds)))}syncLookupProductCodes(nodeIds){return this._lookupProductCodes(this.productCodesByNodeIdMap$.getValue(),nodeIds)}_lookupNodeIds(nodeIdsByProductCodeMap,productCodes){return this.distinct(productCodes.flatMap(productCode=>nodeIdsByProductCodeMap.get(productCode)||[]))}lookupNodeIds(productCodes){return this.nodeIdsByProductCodeMap$.pipe((0,map.U)(nodeIdsByProductCodeMap=>this._lookupNodeIds(nodeIdsByProductCodeMap,productCodes)))}syncLookupNodeIds(productCodes){return this._lookupNodeIds(this.nodeIdsByProductCodeMap$.getValue(),productCodes)}}__name(SceneNodeToProductLookupService,"SceneNodeToProductLookupService"),SceneNodeToProductLookupService.\u0275fac=__name(function(t){return new(t||SceneNodeToProductLookupService)(core.LFG(spartacus_epd_visualization_root._v),core.LFG(SceneConnector))},"SceneNodeToProductLookupService_Factory"),SceneNodeToProductLookupService.\u0275prov=core.Yz7({token:SceneNodeToProductLookupService,factory:SceneNodeToProductLookupService.\u0275fac,providedIn:"root"});class VisualizationLookupService{constructor(epdVisualizationConfig,visualizationConnector){this.epdVisualizationConfig=epdVisualizationConfig,this.visualizationConnector=visualizationConnector}findMatchingVisualizations(productCode){const usageIdConfig=this.epdVisualizationConfig.epdVisualization.usageIds,productUsageId=usageIdConfig.productUsageId,folderUsageId=usageIdConfig.folderUsageId,usage={name:productUsageId.name,keys:[{name:productUsageId.keyName,value:productCode}]};return this.visualizationConnector.lookupVisualization(usage,folderUsageId).pipe((0,map.U)(data=>data.visualizations.filter(item=>item.contentType===spartacus_epd_visualization_root.zc.Model3D||item.contentType===spartacus_epd_visualization_root.zc.Drawing2D)))}}__name(VisualizationLookupService,"VisualizationLookupService"),VisualizationLookupService.\u0275fac=__name(function(t){return new(t||VisualizationLookupService)(core.LFG(spartacus_epd_visualization_root._v),core.LFG(VisualizationConnector))},"VisualizationLookupService_Factory"),VisualizationLookupService.\u0275prov=core.Yz7({token:VisualizationLookupService,factory:VisualizationLookupService.\u0275fac,providedIn:"root"});class EpdVisualizationCoreModule{}__name(EpdVisualizationCoreModule,"EpdVisualizationCoreModule"),EpdVisualizationCoreModule.\u0275fac=__name(function(t){return new(t||EpdVisualizationCoreModule)},"EpdVisualizationCoreModule_Factory"),EpdVisualizationCoreModule.\u0275mod=core.oAB({type:EpdVisualizationCoreModule}),EpdVisualizationCoreModule.\u0275inj=core.cJS({providers:[SceneConnector,VisualizationConnector,SceneNodeToProductLookupService,VisualizationLookupService]});var fesm2015_forms=__webpack_require__(3075),spartacus_cart_base_components_add_to_cart=__webpack_require__(5664);const _c0=["bar"],_c1=["handle"];function VisualViewerComponent_ng_container_0_Template(rf,ctx){if(1&rf){const _r4=core.EpF();core.ynx(0),core._UZ(1,"div",2),core.ALo(2,"cxTranslate"),core.TgZ(3,"div",3)(4,"span",4),core._uU(5),core.ALo(6,"cxTranslate"),core.qZA()(),core.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"cx-epd-visualization-viewer-toolbar-button",9),core.NdJ("click",__name(function(){core.CHM(_r4);const ctx_r3=core.oxw();return core.KtG(ctx_r3.activateHomeView())},"VisualViewerComponent_ng_container_0_Template_cx_epd_visualization_viewer_toolbar_button_click_11_listener")),core.ALo(12,"cxTranslate"),core.qZA(),core.TgZ(13,"cx-epd-visualization-viewer-toolbar-button",10),core.NdJ("click",__name(function(){core.CHM(_r4);const ctx_r5=core.oxw();return core.KtG(ctx_r5.navigationMode=ctx_r5.NavigationMode.Turntable)},"VisualViewerComponent_ng_container_0_Template_cx_epd_visualization_viewer_toolbar_button_click_13_listener")),core.ALo(14,"cxTranslate"),core.qZA(),core.TgZ(15,"cx-epd-visualization-viewer-toolbar-button",11),core.NdJ("click",__name(function(){core.CHM(_r4);const ctx_r6=core.oxw();return core.KtG(ctx_r6.navigationMode=ctx_r6.NavigationMode.Pan)},"VisualViewerComponent_ng_container_0_Template_cx_epd_visualization_viewer_toolbar_button_click_15_listener")),core.ALo(16,"cxTranslate"),core.qZA(),core.TgZ(17,"cx-epd-visualization-viewer-toolbar-button",12),core.NdJ("click",__name(function(){core.CHM(_r4);const ctx_r7=core.oxw();return core.KtG(ctx_r7.navigationMode=ctx_r7.NavigationMode.Zoom)},"VisualViewerComponent_ng_container_0_Template_cx_epd_visualization_viewer_toolbar_button_click_17_listener")),core.ALo(18,"cxTranslate"),core.qZA(),core.TgZ(19,"cx-epd-visualization-viewer-toolbar-button",13),core.NdJ("click",__name(function(){core.CHM(_r4);const ctx_r8=core.oxw();return core.KtG(ctx_r8.isolateModeEnabled=!ctx_r8.isolateModeEnabled)},"VisualViewerComponent_ng_container_0_Template_cx_epd_visualization_viewer_toolbar_button_click_19_listener")),core.ALo(20,"cxTranslate"),core.qZA(),core.TgZ(21,"cx-epd-visualization-viewer-toolbar-button",14),core.NdJ("click",__name(function(){core.CHM(_r4);const ctx_r9=core.oxw();return core.KtG(ctx_r9.animationPlaying?ctx_r9.pauseAnimation():ctx_r9.playAnimation())},"VisualViewerComponent_ng_container_0_Template_cx_epd_visualization_viewer_toolbar_button_click_21_listener")),core.ALo(22,"cxTranslate"),core.qZA(),core.TgZ(23,"cx-epd-visualization-viewer-toolbar-button",15),core.NdJ("click",__name(function(){core.CHM(_r4);const ctx_r10=core.oxw();return core.KtG(ctx_r10.showAllHotspotsEnabled=!ctx_r10.showAllHotspotsEnabled)},"VisualViewerComponent_ng_container_0_Template_cx_epd_visualization_viewer_toolbar_button_click_23_listener")),core.ALo(24,"cxTranslate"),core.qZA()(),core.TgZ(25,"div",16)(26,"cx-epd-visualization-animation-slider",17),core.NdJ("valueChange",__name(function($event){core.CHM(_r4);const ctx_r11=core.oxw();return core.KtG(ctx_r11.animationPosition=$event)},"VisualViewerComponent_ng_container_0_Template_cx_epd_visualization_animation_slider_valueChange_26_listener"))("keydown.enter",__name(function($event){core.CHM(_r4);const ctx_r12=core.oxw();return ctx_r12.animationPlaying?ctx_r12.pauseAnimation():ctx_r12.playAnimation(),core.KtG($event.preventDefault())},"VisualViewerComponent_ng_container_0_Template_cx_epd_visualization_animation_slider_keydown_enter_26_listener"))("keydown.space",__name(function($event){core.CHM(_r4);const ctx_r13=core.oxw();return ctx_r13.animationPlaying?ctx_r13.pauseAnimation():ctx_r13.playAnimation(),core.KtG($event.preventDefault())},"VisualViewerComponent_ng_container_0_Template_cx_epd_visualization_animation_slider_keydown_space_26_listener")),core.qZA()()()()(),core.BQk()}if(2&rf){const ctx_r0=core.oxw();core.xp6(1),core.uIk("aria-label",core.lcZ(2,26,"common.loaded")),core.xp6(2),core.Q6J("hidden",!ctx_r0.viewportReady),core.xp6(2),core.Oqu(core.lcZ(6,28,ctx_r0.is2D?"epdVisualization.visualViewer.contentType.drawing2D":"epdVisualization.visualViewer.contentType.model3D")),core.xp6(3),core.Q6J("hidden",!ctx_r0.viewportReady),core.xp6(3),core.s9C("text",core.lcZ(12,30,"epdVisualization.visualViewer.toolbar.homeButton.label")),core.xp6(2),core.s9C("text",core.lcZ(14,32,"epdVisualization.visualViewer.toolbar.rotateButton.label")),core.Q6J("hidden",ctx_r0.is2D)("checked",ctx_r0.navigationMode===ctx_r0.NavigationMode.Turntable),core.xp6(2),core.s9C("text",core.lcZ(16,34,"epdVisualization.visualViewer.toolbar.panButton.label")),core.Q6J("checked",ctx_r0.navigationMode===ctx_r0.NavigationMode.Pan),core.xp6(2),core.s9C("text",core.lcZ(18,36,"epdVisualization.visualViewer.toolbar.zoomButton.label")),core.Q6J("checked",ctx_r0.navigationMode===ctx_r0.NavigationMode.Zoom),core.xp6(2),core.s9C("text",core.lcZ(20,38,"epdVisualization.visualViewer.toolbar.isolateButton.label")),core.Q6J("hidden",ctx_r0.is2D)("disabled",!ctx_r0.isolateModeEnabled&&0===(null==ctx_r0.selectedProductCodes?null:ctx_r0.selectedProductCodes.length))("checked",ctx_r0.isolateModeEnabled),core.xp6(2),core.s9C("iconClass",ctx_r0.animationPlaying?"fa-pause":"fa-play"),core.s9C("text",core.lcZ(22,40,ctx_r0.animationPlaying?"epdVisualization.visualViewer.toolbar.pauseButton.label":"epdVisualization.visualViewer.toolbar.playButton.label")),core.Q6J("hidden",ctx_r0.is2D||ctx_r0.animationTotalDuration<=0)("disabled",ctx_r0.isolateModeEnabled),core.xp6(2),core.s9C("text",core.lcZ(24,42,ctx_r0.showAllHotspotsEnabled?"epdVisualization.visualViewer.toolbar.hotspotsButton.hide":"epdVisualization.visualViewer.toolbar.hotspotsButton.show")),core.Q6J("checked",ctx_r0.showAllHotspotsEnabled)("hidden",!ctx_r0.is2D),core.xp6(2),core.Q6J("hidden",ctx_r0.is2D||ctx_r0.animationTotalDuration<=0),core.xp6(1),core.Q6J("disabled",ctx_r0.isolateModeEnabled)("value",ctx_r0.animationPosition)}}function VisualViewerComponent_ng_template_1_Template(rf,ctx){1&rf&&(core.TgZ(0,"div",18),core._UZ(1,"cx-spinner"),core.qZA())}function CompactAddToCartComponent_form_0_button_1_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"button",3),core._UZ(1,"cx-icon",4),core.qZA()),2&rf){const ctx_r1=core.oxw(2);core.Q6J("disabled",ctx_r1.quantity<=0||ctx_r1.quantity>ctx_r1.maxQuantity)}}function CompactAddToCartComponent_form_0_Template(rf,ctx){if(1&rf){const _r3=core.EpF();core.TgZ(0,"form",1),core.NdJ("submit",__name(function(){core.CHM(_r3);const ctx_r2=core.oxw();return core.KtG(ctx_r2.addToCart())},"CompactAddToCartComponent_form_0_Template_form_submit_0_listener")),core.YNc(1,CompactAddToCartComponent_form_0_button_1_Template,2,1,"button",2),core.qZA()}if(2&rf){const ctx_r0=core.oxw();core.Q6J("formGroup",ctx_r0.addToCartForm),core.xp6(1),core.Q6J("ngIf",ctx_r0.hasStock)}}function PagedListComponent_ng_container_0_h3_1_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"h3"),core._uU(1),core.qZA()),2&rf){const ctx_r1=core.oxw(2);core.xp6(1),core.Oqu(ctx_r1.title)}}function PagedListComponent_ng_container_0_ng_container_2_Template(rf,ctx){1&rf&&core.GkF(0)}function PagedListComponent_ng_container_0_ng_container_5_div_1_ng_container_1_div_1_ng_container_1_Template(rf,ctx){1&rf&&core.GkF(0)}__name(VisualViewerComponent_ng_container_0_Template,"VisualViewerComponent_ng_container_0_Template"),__name(VisualViewerComponent_ng_template_1_Template,"VisualViewerComponent_ng_template_1_Template"),__name(CompactAddToCartComponent_form_0_button_1_Template,"CompactAddToCartComponent_form_0_button_1_Template"),__name(CompactAddToCartComponent_form_0_Template,"CompactAddToCartComponent_form_0_Template"),__name(PagedListComponent_ng_container_0_h3_1_Template,"PagedListComponent_ng_container_0_h3_1_Template"),__name(PagedListComponent_ng_container_0_ng_container_2_Template,"PagedListComponent_ng_container_0_ng_container_2_Template"),__name(PagedListComponent_ng_container_0_ng_container_5_div_1_ng_container_1_div_1_ng_container_1_Template,"PagedListComponent_ng_container_0_ng_container_5_div_1_ng_container_1_div_1_ng_container_1_Template");const _c2=__name(function(a0,a1){return{item:a0,active:a1}},"_c2");function PagedListComponent_ng_container_0_ng_container_5_div_1_ng_container_1_div_1_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",9),core.YNc(1,PagedListComponent_ng_container_0_ng_container_5_div_1_ng_container_1_div_1_ng_container_1_Template,1,0,"ng-container",10),core.qZA()),2&rf){const data_r12=ctx.ngIf,i_r6=core.oxw(3).index,ctx_r11=core.oxw(2);core.ekj("active",i_r6===ctx_r11.activeSlideStartIndex),core.xp6(1),core.Q6J("ngTemplateOutlet",ctx_r11.template)("ngTemplateOutletContext",core.WLB(4,_c2,data_r12,i_r6===ctx_r11.activeSlideStartIndex))}}function PagedListComponent_ng_container_0_ng_container_5_div_1_ng_container_1_Template(rf,ctx){if(1&rf&&(core.ynx(0),core.YNc(1,PagedListComponent_ng_container_0_ng_container_5_div_1_ng_container_1_div_1_Template,2,7,"div",8),core.BQk()),2&rf){const item_r9=ctx.$implicit;core.xp6(1),core.Q6J("ngIf",item_r9)}}function PagedListComponent_ng_container_0_ng_container_5_div_1_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",7),core.YNc(1,PagedListComponent_ng_container_0_ng_container_5_div_1_ng_container_1_Template,2,1,"ng-container",4),core.ALo(2,"slice"),core.qZA()),2&rf){const i_r6=core.oxw().index,ctx_r7=core.oxw(2);core.ekj("active",i_r6===ctx_r7.activeSlideStartIndex),core.xp6(1),core.Q6J("ngForOf",core.Dn7(2,3,ctx_r7.items,i_r6,i_r6+ctx_r7.itemsPerSlide))}}function PagedListComponent_ng_container_0_ng_container_5_Template(rf,ctx){if(1&rf&&(core.ynx(0),core.YNc(1,PagedListComponent_ng_container_0_ng_container_5_div_1_Template,3,7,"div",6),core.BQk()),2&rf){const i_r6=ctx.index,ctx_r3=core.oxw(2);core.xp6(1),core.Q6J("ngIf",i_r6%ctx_r3.itemsPerSlide==0)}}function PagedListComponent_ng_container_0_div_6_button_1_Template(rf,ctx){if(1&rf){const _r20=core.EpF();core.TgZ(0,"button",14),core.NdJ("click",__name(function(){core.CHM(_r20);const ctx_r19=core.oxw(3);return core.KtG(ctx_r19.setActiveSlideStartIndex(ctx_r19.activeSlideStartIndex-ctx_r19.itemsPerSlide))},"PagedListComponent_ng_container_0_div_6_button_1_Template_button_click_0_listener")),core._UZ(1,"cx-icon",15),core.qZA()}if(2&rf){const ctx_r16=core.oxw(3);core.Q6J("disabled",0===ctx_r16.activeSlideStartIndex),core.xp6(1),core.Q6J("type",ctx_r16.previousIcon)}}function PagedListComponent_ng_container_0_div_6_ng_container_2_button_1_Template(rf,ctx){if(1&rf){const _r26=core.EpF();core.TgZ(0,"button",17),core.NdJ("click",__name(function(){core.CHM(_r26);const i_r22=core.oxw().index,ctx_r24=core.oxw(3);return core.KtG(ctx_r24.setActiveSlideStartIndex(i_r22))},"PagedListComponent_ng_container_0_div_6_ng_container_2_button_1_Template_button_click_0_listener")),core._UZ(1,"cx-icon",15),core.qZA()}if(2&rf){const i_r22=core.oxw().index,ctx_r23=core.oxw(3);core.Q6J("disabled",i_r22===ctx_r23.activeSlideStartIndex),core.xp6(1),core.Q6J("type",ctx_r23.indicatorIcon)}}function PagedListComponent_ng_container_0_div_6_ng_container_2_Template(rf,ctx){if(1&rf&&(core.ynx(0),core.YNc(1,PagedListComponent_ng_container_0_div_6_ng_container_2_button_1_Template,2,2,"button",16),core.BQk()),2&rf){const i_r22=ctx.index,ctx_r17=core.oxw(3);core.xp6(1),core.Q6J("ngIf",i_r22%ctx_r17.itemsPerSlide==0)}}function PagedListComponent_ng_container_0_div_6_button_3_Template(rf,ctx){if(1&rf){const _r29=core.EpF();core.TgZ(0,"button",18),core.NdJ("click",__name(function(){core.CHM(_r29);const ctx_r28=core.oxw(3);return core.KtG(ctx_r28.setActiveSlideStartIndex(ctx_r28.activeSlideStartIndex+ctx_r28.itemsPerSlide))},"PagedListComponent_ng_container_0_div_6_button_3_Template_button_click_0_listener")),core._UZ(1,"cx-icon",15),core.qZA()}if(2&rf){const ctx_r18=core.oxw(3);core.Q6J("disabled",ctx_r18.activeSlideStartIndex>ctx_r18.items.length-ctx_r18.itemsPerSlide-1),core.xp6(1),core.Q6J("type",ctx_r18.nextIcon)}}function PagedListComponent_ng_container_0_div_6_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",11),core.YNc(1,PagedListComponent_ng_container_0_div_6_button_1_Template,2,2,"button",12),core.YNc(2,PagedListComponent_ng_container_0_div_6_ng_container_2_Template,2,1,"ng-container",4),core.YNc(3,PagedListComponent_ng_container_0_div_6_button_3_Template,2,2,"button",13),core.qZA()),2&rf){const ctx_r4=core.oxw(2);core.xp6(1),core.Q6J("ngIf",ctx_r4.itemsPerSlide<ctx_r4.items.length),core.xp6(1),core.Q6J("ngForOf",ctx_r4.items),core.xp6(1),core.Q6J("ngIf",ctx_r4.itemsPerSlide<ctx_r4.items.length)}}function PagedListComponent_ng_container_0_Template(rf,ctx){if(1&rf&&(core.ynx(0),core.YNc(1,PagedListComponent_ng_container_0_h3_1_Template,2,1,"h3",0),core.YNc(2,PagedListComponent_ng_container_0_ng_container_2_Template,1,0,"ng-container",1),core.TgZ(3,"div",2)(4,"div",3),core.YNc(5,PagedListComponent_ng_container_0_ng_container_5_Template,2,1,"ng-container",4),core.qZA()(),core.YNc(6,PagedListComponent_ng_container_0_div_6_Template,4,3,"div",5),core.BQk()),2&rf){const ctx_r0=core.oxw();core.xp6(1),core.Q6J("ngIf",ctx_r0.title),core.xp6(1),core.Q6J("ngTemplateOutlet",ctx_r0.headerTemplate),core.xp6(3),core.Q6J("ngForOf",ctx_r0.items),core.xp6(1),core.Q6J("ngIf",!ctx_r0.hideIndicators&&ctx_r0.itemsPerSlide<ctx_r0.items.length)}}function VisualPickingProductListComponent_ng_template_2_Template(rf,ctx){1&rf&&(core.TgZ(0,"div",3)(1,"div",4),core._uU(2),core.ALo(3,"cxTranslate"),core.qZA(),core.TgZ(4,"div",5),core._uU(5),core.ALo(6,"cxTranslate"),core.qZA(),core._UZ(7,"div",6),core.qZA()),2&rf&&(core.xp6(2),core.hij(" ",core.lcZ(3,2,"epdVisualization.visualPicking.visualPickingProductList.description")," "),core.xp6(3),core.hij(" ",core.lcZ(6,4,"epdVisualization.visualPicking.visualPickingProductList.itemPrice")," "))}__name(PagedListComponent_ng_container_0_ng_container_5_div_1_ng_container_1_div_1_Template,"PagedListComponent_ng_container_0_ng_container_5_div_1_ng_container_1_div_1_Template"),__name(PagedListComponent_ng_container_0_ng_container_5_div_1_ng_container_1_Template,"PagedListComponent_ng_container_0_ng_container_5_div_1_ng_container_1_Template"),__name(PagedListComponent_ng_container_0_ng_container_5_div_1_Template,"PagedListComponent_ng_container_0_ng_container_5_div_1_Template"),__name(PagedListComponent_ng_container_0_ng_container_5_Template,"PagedListComponent_ng_container_0_ng_container_5_Template"),__name(PagedListComponent_ng_container_0_div_6_button_1_Template,"PagedListComponent_ng_container_0_div_6_button_1_Template"),__name(PagedListComponent_ng_container_0_div_6_ng_container_2_button_1_Template,"PagedListComponent_ng_container_0_div_6_ng_container_2_button_1_Template"),__name(PagedListComponent_ng_container_0_div_6_ng_container_2_Template,"PagedListComponent_ng_container_0_div_6_ng_container_2_Template"),__name(PagedListComponent_ng_container_0_div_6_button_3_Template,"PagedListComponent_ng_container_0_div_6_button_3_Template"),__name(PagedListComponent_ng_container_0_div_6_Template,"PagedListComponent_ng_container_0_div_6_Template"),__name(PagedListComponent_ng_container_0_Template,"PagedListComponent_ng_container_0_Template"),__name(VisualPickingProductListComponent_ng_template_2_Template,"VisualPickingProductListComponent_ng_template_2_Template");const _c3=__name(function(a1){return{cxRoute:"product",params:a1}},"_c3");function VisualPickingProductListComponent_ng_template_4_div_0_div_6_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",20)(1,"a",21),core.NdJ("keydown.enter",__name(function($event){return $event.currentTarget.click()},"VisualPickingProductListComponent_ng_template_4_div_0_div_6_Template_a_keydown_enter_1_listener")),core.ALo(2,"cxUrl"),core._uU(3),core.qZA()()),2&rf){const item_r4=core.oxw(2).item;core.xp6(1),core.Q6J("routerLink",core.lcZ(2,2,core.VKq(4,_c3,item_r4.product))),core.xp6(2),core.Oqu(item_r4.product.name)}}function VisualPickingProductListComponent_ng_template_4_div_0_div_7_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",22),core._uU(1),core.ALo(2,"cxTranslate"),core.qZA()),2&rf){const item_r4=core.oxw(2).item;core.xp6(1),core.AsE(" ",core.lcZ(2,2,"epdVisualization.visualPicking.visualPickingProductList.id")," ",item_r4.product.code," ")}}function VisualPickingProductListComponent_ng_template_4_div_0_div_9_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"div",23),core._uU(1),core.qZA()),2&rf){const item_r4=core.oxw(2).item;core.xp6(1),core.hij(" ",null==item_r4.product.price?null:item_r4.product.price.formattedValue," ")}}function VisualPickingProductListComponent_ng_template_4_div_0_ng_container_11_Template(rf,ctx){if(1&rf){const _r19=core.EpF();core.ynx(0),core.TgZ(1,"div",24),core.NdJ("click",__name(function($event){return core.CHM(_r19),core.MAs(3).addToCart(),core.KtG($event.preventDefault())},"VisualPickingProductListComponent_ng_template_4_div_0_ng_container_11_Template_div_click_1_listener"))("keydown.enter",__name(function($event){return core.CHM(_r19),core.MAs(3).addToCart(),core.KtG($event.preventDefault())},"VisualPickingProductListComponent_ng_template_4_div_0_ng_container_11_Template_div_keydown_enter_1_listener"))("keydown.space",__name(function($event){return core.CHM(_r19),core.MAs(3).addToCart(),core.KtG($event.preventDefault())},"VisualPickingProductListComponent_ng_template_4_div_0_ng_container_11_Template_div_keydown_space_1_listener")),core._UZ(2,"cx-epd-visualization-compact-add-to-cart",25,26),core.qZA(),core.BQk()}if(2&rf){const item_r4=core.oxw(2).item;core.xp6(2),core.Q6J("showQuantity",!1)("product",item_r4.product)}}function VisualPickingProductListComponent_ng_template_4_div_0_ng_container_12_Template(rf,ctx){1&rf&&core.GkF(0,null,27)}function VisualPickingProductListComponent_ng_template_4_div_0_ng_container_13_Template(rf,ctx){1&rf&&(core.ynx(0),core.TgZ(1,"div",28),core._uU(2),core.ALo(3,"cxTranslate"),core.qZA(),core.BQk()),2&rf&&(core.xp6(2),core.hij(" ",core.lcZ(3,1,"epdVisualization.visualPicking.visualPickingProductList.outOfStock")," "))}function VisualPickingProductListComponent_ng_template_4_div_0_Template(rf,ctx){if(1&rf){const _r25=core.EpF();core.TgZ(0,"div",8),core.NdJ("click",__name(function(){core.CHM(_r25);const item_r4=core.oxw().item,ctx_r24=core.oxw();return core.KtG(ctx_r24.selectedProductCodes=[item_r4.product.code])},"VisualPickingProductListComponent_ng_template_4_div_0_Template_div_click_0_listener"))("keydown.enter",__name(function(){core.CHM(_r25);const item_r4=core.oxw().item,ctx_r27=core.oxw();return core.KtG(ctx_r27.selectedProductCodes=[item_r4.product.code])},"VisualPickingProductListComponent_ng_template_4_div_0_Template_div_keydown_enter_0_listener"))("keydown.space",__name(function(){core.CHM(_r25);const item_r4=core.oxw().item,ctx_r29=core.oxw();return core.KtG(ctx_r29.selectedProductCodes=[item_r4.product.code])},"VisualPickingProductListComponent_ng_template_4_div_0_Template_div_keydown_space_0_listener")),core.TgZ(1,"div",9)(2,"div",10)(3,"div",11),core._UZ(4,"cx-media",12),core.qZA()(),core.TgZ(5,"div",13),core.YNc(6,VisualPickingProductListComponent_ng_template_4_div_0_div_6_Template,4,6,"div",14),core.YNc(7,VisualPickingProductListComponent_ng_template_4_div_0_div_7_Template,3,4,"div",15),core.qZA()(),core.TgZ(8,"div",16),core.YNc(9,VisualPickingProductListComponent_ng_template_4_div_0_div_9_Template,2,1,"div",17),core.qZA(),core.TgZ(10,"div",18),core.YNc(11,VisualPickingProductListComponent_ng_template_4_div_0_ng_container_11_Template,4,2,"ng-container",19),core.YNc(12,VisualPickingProductListComponent_ng_template_4_div_0_ng_container_12_Template,2,0,"ng-container",19),core.YNc(13,VisualPickingProductListComponent_ng_template_4_div_0_ng_container_13_Template,4,3,"ng-container",19),core.qZA()()}if(2&rf){const item_r4=core.oxw().item;core.ekj("selected",item_r4.selected),core.xp6(3),core.ekj("selected",item_r4.selected),core.xp6(1),core.Q6J("container",null==item_r4.product.images?null:item_r4.product.images.PRIMARY),core.xp6(2),core.Q6J("ngIf",item_r4.product.name),core.xp6(1),core.Q6J("ngIf",item_r4.product.code),core.xp6(2),core.Q6J("ngIf",item_r4.product.price),core.xp6(2),core.Q6J("ngIf",void 0!==item_r4.product.price&&"outOfStock"!==item_r4.product.stock.stockLevelStatus),core.xp6(1),core.Q6J("ngIf",void 0===item_r4.product.price),core.xp6(1),core.Q6J("ngIf",void 0!==item_r4.product.price&&"outOfStock"===item_r4.product.stock.stockLevelStatus)}}function VisualPickingProductListComponent_ng_template_4_Template(rf,ctx){if(1&rf&&core.YNc(0,VisualPickingProductListComponent_ng_template_4_div_0_Template,14,11,"div",7),2&rf){const active_r5=ctx.active;core.Q6J("ngIf",active_r5)}}__name(VisualPickingProductListComponent_ng_template_4_div_0_div_6_Template,"VisualPickingProductListComponent_ng_template_4_div_0_div_6_Template"),__name(VisualPickingProductListComponent_ng_template_4_div_0_div_7_Template,"VisualPickingProductListComponent_ng_template_4_div_0_div_7_Template"),__name(VisualPickingProductListComponent_ng_template_4_div_0_div_9_Template,"VisualPickingProductListComponent_ng_template_4_div_0_div_9_Template"),__name(VisualPickingProductListComponent_ng_template_4_div_0_ng_container_11_Template,"VisualPickingProductListComponent_ng_template_4_div_0_ng_container_11_Template"),__name(VisualPickingProductListComponent_ng_template_4_div_0_ng_container_12_Template,"VisualPickingProductListComponent_ng_template_4_div_0_ng_container_12_Template"),__name(VisualPickingProductListComponent_ng_template_4_div_0_ng_container_13_Template,"VisualPickingProductListComponent_ng_template_4_div_0_ng_container_13_Template"),__name(VisualPickingProductListComponent_ng_template_4_div_0_Template,"VisualPickingProductListComponent_ng_template_4_div_0_Template"),__name(VisualPickingProductListComponent_ng_template_4_Template,"VisualPickingProductListComponent_ng_template_4_Template");class VisualViewerAnimationSliderService{constructor(elementRef,windowRef,renderer,changeDetectorRef){this.elementRef=elementRef,this.windowRef=windowRef,this.renderer=renderer,this.changeDetectorRef=changeDetectorRef,this._initialized=!1,this.initializedChange=new core.vpe,this._value=0,this.valueChange=new core.vpe,this._disabled=!1,this._resizeObserver=void 0,this.eventListenerUtils=new spartacus_epd_visualization_root.qN,this._touchIdentifier=void 0,this.sizeChange=new core.vpe,this.stepDelta=.02,this.pageDelta=.1,this.eventListenerUtils.initialize(this.renderer)}initialize(){this.updateEventBindings(),this.setupResizeObserver(),this.setInitialized()}setInitialized(){this._initialized=!0,this.initializedChange.emit(!0),this.initializedChange.complete()}get initialized(){return this._initialized}set value(value){value=this.clampToRange(value),this._value!==value&&(this._value=value,this.valueChange.emit(this.value))}get value(){return this._value}set disabled(disabled){this._disabled!==disabled&&(this._disabled=disabled,this.updateEventBindings())}get disabled(){return this._disabled}set hidden(hidden){this._hidden!==hidden&&(this._hidden=hidden,this.changeDetectorRef.detectChanges())}get hidden(){return this._hidden}get position(){return this.valueToPosition(this.value)}get rightToLeft(){return"rtl"===this.windowRef.document.documentElement.dir}set barElement(barElement){this._barElement=barElement}get barElement(){return this._barElement}set handleElement(handleElement){this._handleElement=handleElement}get handleElement(){return this._handleElement}set resizeObserver(resizeObserver){this._resizeObserver=resizeObserver}get resizeObserver(){return this._resizeObserver}set touchIdentifier(touchIdentifier){this._touchIdentifier=touchIdentifier}get touchIdentifier(){return this._touchIdentifier}getClientWidth(elementRef){if(!elementRef||!elementRef.nativeElement)return;const clientRect=this.getClientRect(elementRef);return clientRect.right-clientRect.left}getClientRect(elementRef){return elementRef.nativeElement.getBoundingClientRect()}resizeObserverSupported(){return void 0!==window.ResizeObserver}setupResizeObserver(){this.resizeObserverSupported()&&(this.resizeObserver=new ResizeObserver(this.onResize.bind(this)),this.resizeObserver.observe(this.elementRef.nativeElement))}onResize(){this.changeDetectorRef.detectChanges()}updateEventBindings(){this.disabled?(this.eventListenerUtils.detachAllEventListeners(document),this.eventListenerUtils.detachAllEventListeners(this.barElement.nativeElement),this.eventListenerUtils.detachAllEventListeners(this.handleElement.nativeElement)):(this.eventListenerUtils.attachEventListener(this.handleElement.nativeElement,"mousedown",this.onMouseDown.bind(this)),this.eventListenerUtils.attachEventListener(this.barElement.nativeElement,"mousedown",this.onMouseDownOnBar.bind(this)),this.eventListenerUtils.attachEventListener(this.handleElement.nativeElement,"touchstart",this.onTouchStart.bind(this)),this.eventListenerUtils.attachEventListener(this.barElement.nativeElement,"touchstart",this.onTouchStartOnBar.bind(this)),this.eventListenerUtils.attachEventListener(this.handleElement.nativeElement,"focus",this.onHandleFocus.bind(this)))}get handleWidth(){var _a;return null!==(_a=this.getClientWidth(this.handleElement))&&void 0!==_a?_a:0}get barWidth(){var _a;return null!==(_a=this.getClientWidth(this.barElement))&&void 0!==_a?_a:0}get handleMaxPosition(){return this.barWidth-this.handleWidth}valueToPosition(value){let position=this.clampToRange(value);return this.rightToLeft&&(position=1-position),position*this.handleMaxPosition}positionToValue(position){let value=position/this.handleMaxPosition;return this.rightToLeft&&(value=1-value),value}findTouch(touchList,touchIdentifier){for(let i=0;i<touchList.length;i++){const touch=touchList.item(i);if(touch.identifier===touchIdentifier)return touch}}get sliderClientPosition(){return this.getClientRect(this.elementRef).left}onTouchStart(event){event.stopPropagation(),event.preventDefault(),void 0===this.touchIdentifier&&(this.eventListenerUtils.detachEventListeners(document,"touchmove"),this.eventListenerUtils.attachEventListener(document,"touchmove",this.onTouchMove.bind(this)),this.eventListenerUtils.detachEventListeners(document,"touchend"),this.eventListenerUtils.attachEventListener(document,"touchend",this.onTouchEnd.bind(this)),this.touchIdentifier=event.changedTouches[0].identifier)}onTouchStartOnBar(event){this.onTouchStart(event),this.onTouchMove(event)}onMouseDown(event){event.stopPropagation(),event.preventDefault(),this.eventListenerUtils.detachEventListeners(document,"mousemove"),this.eventListenerUtils.attachEventListener(document,"mousemove",this.onMouseMove.bind(this)),this.eventListenerUtils.detachEventListeners(document,"mouseup"),this.eventListenerUtils.attachEventListener(document,"mouseup",this.onMouseUp.bind(this))}onMouseDownOnBar(event){this.onMouseDown(event),this.onMouseMove(event)}onMouseMove(event){const position=event.clientX-this.sliderClientPosition-this.handleWidth/2;this.applyValue(this.positionToValue(position))}onMouseUp(_event){this.eventListenerUtils.detachEventListeners(document,"mousemove"),this.eventListenerUtils.detachEventListeners(document,"mouseup")}onTouchMove(event){if(void 0===this.findTouch(event.changedTouches,this.touchIdentifier))return;const position=this.findTouch(event.touches,this.touchIdentifier).clientX-this.sliderClientPosition-this.handleWidth/2;this.applyValue(this.positionToValue(position))}onTouchEnd(event){void 0!==this.findTouch(event.changedTouches,this.touchIdentifier)&&(this.touchIdentifier=void 0,this.eventListenerUtils.detachEventListeners(document,"touchmove"),this.eventListenerUtils.detachEventListeners(document,"touchend"))}onHandleFocus(){const nativeElement=this.handleElement.nativeElement;this.eventListenerUtils.attachEventListener(nativeElement,"blur",this.onHandleBlur.bind(this)),this.eventListenerUtils.attachEventListener(nativeElement,"keydown",this.onKeyboardEvent.bind(this))}onHandleBlur(){const nativeElement=this.handleElement.nativeElement;this.eventListenerUtils.detachEventListeners(nativeElement,"blur"),this.eventListenerUtils.detachEventListeners(nativeElement,"keydown"),this.eventListenerUtils.detachEventListeners(nativeElement,"keyup")}onKeyboardEvent(event){const keyHandler=this.getKeyHandler(event.code,this.rightToLeft);void 0!==keyHandler&&(event.preventDefault(),this.applyValue(keyHandler(this.value)))}getKeyHandler(keyCode,rightToLeft){const increaseStep=__name(currentValue=>currentValue+this.stepDelta,"increaseStep"),decreaseStep=__name(currentValue=>currentValue-this.stepDelta,"decreaseStep"),increasePage=__name(currentValue=>currentValue+this.pageDelta,"increasePage"),decreasePage=__name(currentValue=>currentValue-this.pageDelta,"decreasePage"),stepLeft=rightToLeft?increaseStep:decreaseStep,stepRight=rightToLeft?decreaseStep:increaseStep,home=__name(()=>0,"home"),end=__name(()=>1,"end");switch(keyCode){case"ArrowUp":return increaseStep;case"ArrowDown":return decreaseStep;case"ArrowLeft":return stepLeft;case"ArrowRight":return stepRight;case"PageUp":return increasePage;case"PageDown":return decreasePage;case"Home":return home;case"End":return end;default:return}}applyValue(value){value=this.clampToRange(value),this.value!==value&&(this.value=value,this.valueChange.emit(this.value))}clampToRange(value){return Math.min(Math.max(value,0),1)}}__name(VisualViewerAnimationSliderService,"VisualViewerAnimationSliderService"),VisualViewerAnimationSliderService.\u0275fac=__name(function(t){return new(t||VisualViewerAnimationSliderService)(core.LFG(core.SBq),core.LFG(spartacus_core.X9E),core.LFG(core.Qsj),core.LFG(core.sBO))},"VisualViewerAnimationSliderService_Factory"),VisualViewerAnimationSliderService.\u0275prov=core.Yz7({token:VisualViewerAnimationSliderService,factory:VisualViewerAnimationSliderService.\u0275fac,providedIn:"any"});class VisualViewerAnimationSliderComponent{constructor(visualViewerAnimationSliderService){this.visualViewerAnimationSliderService=visualViewerAnimationSliderService,this.valueChange=this.visualViewerAnimationSliderService.valueChange,this.initializedChange=this.visualViewerAnimationSliderService.initializedChange}ngAfterViewInit(){this.visualViewerAnimationSliderService.initialize()}set hidden(hidden){this.visualViewerAnimationSliderService.hidden=hidden}get hidden(){return this.visualViewerAnimationSliderService.hidden}set value(value){this.visualViewerAnimationSliderService.value=value}get value(){return this.visualViewerAnimationSliderService.value}get position(){return this.visualViewerAnimationSliderService.position}set disabled(disabled){this.visualViewerAnimationSliderService.disabled=disabled}get disabled(){return this.visualViewerAnimationSliderService.disabled}get initialized(){return this.visualViewerAnimationSliderService.initialized}set barElement(barElement){this.visualViewerAnimationSliderService.barElement=barElement}set handleElement(handleElement){this.visualViewerAnimationSliderService.handleElement=handleElement}}__name(VisualViewerAnimationSliderComponent,"VisualViewerAnimationSliderComponent"),VisualViewerAnimationSliderComponent.\u0275fac=__name(function(t){return new(t||VisualViewerAnimationSliderComponent)(core.Y36(VisualViewerAnimationSliderService))},"VisualViewerAnimationSliderComponent_Factory"),VisualViewerAnimationSliderComponent.\u0275cmp=core.Xpm({type:VisualViewerAnimationSliderComponent,selectors:[["cx-epd-visualization-animation-slider"]],viewQuery:__name(function(rf,ctx){if(1&rf&&(core.Gf(_c0,5),core.Gf(_c1,5)),2&rf){let _t;core.iGM(_t=core.CRH())&&(ctx.barElement=_t.first),core.iGM(_t=core.CRH())&&(ctx.handleElement=_t.first)}},"VisualViewerAnimationSliderComponent_Query"),inputs:{hidden:"hidden",value:"value",disabled:"disabled"},outputs:{valueChange:"valueChange",initializedChange:"initializedChange"},features:[core._Bn([VisualViewerAnimationSliderService])],decls:11,vars:20,consts:[[1,"cx-epd-visualization-animation-slider"],[1,"cx-epd-visualization-animation-slider-wrapper"],["cxVisualViewerAnimationSliderElement","",1,"cx-epd-visualization-animation-slider-span","cx-epd-visualization-animation-slider-bar-wrapper"],["bar",""],[1,"cx-epd-visualization-animation-slider-span","cx-epd-visualization-animation-slider-bar"],["cxVisualViewerAnimationSliderHandle","",1,"cx-epd-visualization-animation-slider-span","cx-epd-visualization-animation-slider-pointer"],["handle",""]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"div",1)(2,"span",2,3),core._UZ(4,"span",4),core.qZA(),core._UZ(5,"span",5,6),core.ALo(7,"cxNumeric"),core.ALo(8,"cxTranslate"),core.ALo(9,"cxTranslate"),core.ALo(10,"cxNumeric"),core.qZA()()),2&rf&&(core.ekj("disabled",!!ctx.disabled||void 0),core.xp6(5),core.Udp("left",core.xi3(7,10,ctx.position,"1.0-0")+"px"),core.uIk("role",core.lcZ(8,13,"epdVisualization.visualViewer.toolbar.visualViewerAnimationSlider.role"))("aria-label",core.lcZ(9,15,"epdVisualization.visualViewer.toolbar.visualViewerAnimationSlider.label"))("aria-valuenow",core.xi3(10,17,100*ctx.value,"1.0-0"))("aria-valuemin","0")("aria-valuemax","100")("tabindex",ctx.disabled?null:0))},"VisualViewerAnimationSliderComponent_Template"),dependencies:[spartacus_core.X$D,spartacus_core.bOD],encapsulation:2,changeDetection:0});class VisualViewerAnimationSliderModule{}__name(VisualViewerAnimationSliderModule,"VisualViewerAnimationSliderModule"),VisualViewerAnimationSliderModule.\u0275fac=__name(function(t){return new(t||VisualViewerAnimationSliderModule)},"VisualViewerAnimationSliderModule_Factory"),VisualViewerAnimationSliderModule.\u0275mod=core.oAB({type:VisualViewerAnimationSliderModule}),VisualViewerAnimationSliderModule.\u0275inj=core.cJS({imports:[common.ez,spartacus_core.LUR]});class VisualViewerToolbarButtonComponent{constructor(){this.text="",this.disabled=!1,this.checked=!1}}__name(VisualViewerToolbarButtonComponent,"VisualViewerToolbarButtonComponent"),VisualViewerToolbarButtonComponent.\u0275fac=__name(function(t){return new(t||VisualViewerToolbarButtonComponent)},"VisualViewerToolbarButtonComponent_Factory"),VisualViewerToolbarButtonComponent.\u0275cmp=core.Xpm({type:VisualViewerToolbarButtonComponent,selectors:[["cx-epd-visualization-viewer-toolbar-button"]],inputs:{text:"text",iconLibraryClass:"iconLibraryClass",iconClass:"iconClass",disabled:"disabled",checked:"checked"},decls:5,vars:9,consts:[["type","submit",1,"btn","btn-link",3,"disabled"],[1,"buttonVBox"],[1,"buttonText"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"button",0)(1,"div",1),core._UZ(2,"cx-icon"),core.TgZ(3,"span",2),core._uU(4),core.qZA()()()),2&rf&&(core.ekj("checked",ctx.checked),core.Q6J("disabled",ctx.disabled),core.uIk("aria-checked",ctx.checked),core.xp6(2),core.MT6("",ctx.iconLibraryClass," ",ctx.iconClass,""),core.xp6(2),core.Oqu(ctx.text))},"VisualViewerToolbarButtonComponent_Template"),dependencies:[spartacus_storefront.oJW],encapsulation:2,changeDetection:0});class VisualViewerToolbarButtonModule{}var NavigationMode,NavigationMode2,SelectionMode,SelectionMode2,NodeContentType,NodeContentType2,SceneLoadState,SceneLoadState2,VisualizationLookupResult,VisualizationLookupResult2,VisualizationLoadStatus,VisualizationLoadStatus2,ZoomTo,ZoomTo2;__name(VisualViewerToolbarButtonModule,"VisualViewerToolbarButtonModule"),VisualViewerToolbarButtonModule.\u0275fac=__name(function(t){return new(t||VisualViewerToolbarButtonModule)},"VisualViewerToolbarButtonModule_Factory"),VisualViewerToolbarButtonModule.\u0275mod=core.oAB({type:VisualViewerToolbarButtonModule}),VisualViewerToolbarButtonModule.\u0275inj=core.cJS({imports:[common.ez,spartacus_storefront.QX1]}),(NavigationMode2=NavigationMode||(NavigationMode={}))[NavigationMode2.Turntable=0]="Turntable",NavigationMode2[NavigationMode2.Pan=2]="Pan",NavigationMode2[NavigationMode2.Zoom=3]="Zoom",(SelectionMode2=SelectionMode||(SelectionMode={})).Exclusive="exclusive",SelectionMode2.None="none",SelectionMode2.Sticky="sticky",(NodeContentType2=NodeContentType||(NodeContentType={})).Annotation="Annotation",NodeContentType2.Background="Background",NodeContentType2.Hotspot="Hotspot",NodeContentType2.Reference="Reference",NodeContentType2.Regular="Regular",NodeContentType2.Symbol="Symbol",(SceneLoadState2=SceneLoadState||(SceneLoadState={}))[SceneLoadState2.NotStarted=0]="NotStarted",SceneLoadState2[SceneLoadState2.Loading=1]="Loading",SceneLoadState2[SceneLoadState2.Loaded=2]="Loaded",SceneLoadState2[SceneLoadState2.Failed=3]="Failed",(VisualizationLookupResult2=VisualizationLookupResult||(VisualizationLookupResult={})).UniqueMatchFound="UniqueMatchFound",VisualizationLookupResult2.NoMatchFound="NoMatchFound",VisualizationLookupResult2.MultipleMatchesFound="MultipleMatchesFound",VisualizationLookupResult2.UnexpectedError="UnexpectedError",(VisualizationLoadStatus2=VisualizationLoadStatus||(VisualizationLoadStatus={})).NotStarted="NotStarted",VisualizationLoadStatus2.Loading="Loading",VisualizationLoadStatus2.Loaded="Loaded",VisualizationLoadStatus2.UnexpectedError="UnexpectedError",(ZoomTo2=ZoomTo||(ZoomTo={})).All="all",ZoomTo2.Node="node",ZoomTo2.Selected="selected",ZoomTo2.ViewBack="view_back",ZoomTo2.ViewBottom="view_bottom",ZoomTo2.ViewFront="view_front",ZoomTo2.ViewLeft="view_left",ZoomTo2.ViewRight="view_right",ZoomTo2.ViewTop="view_top",ZoomTo2.Visible="visible";class VisualViewerService{constructor(epdVisualizationConfig,_sceneNodeToProductLookupService,visualizationLookupService,elementRef,changeDetectorRef,windowRef){if(this.epdVisualizationConfig=epdVisualizationConfig,this._sceneNodeToProductLookupService=_sceneNodeToProductLookupService,this.visualizationLookupService=visualizationLookupService,this.elementRef=elementRef,this.changeDetectorRef=changeDetectorRef,this.windowRef=windowRef,this._selectedNodeIds$=new BehaviorSubject.X([]),this._sceneLoadInfo$=new BehaviorSubject.X({sceneLoadState:SceneLoadState.NotStarted}),this.DEFAULT_BACKGROUND_TOP_COLOR="--cx-color-inverse",this.DEFAULT_BACKGROUND_BOTTOM_COLOR="--cx-color-inverse",this.DEFAULT_HOTSPOT_SELECTION_HIGHLIGHT_COLOR="rgba(255, 0, 0, 0.6)",this.DEFAULT_SHOW_ALL_HOTSPOTS_COLOR="rgba(255, 255, 0, 0.3)",this.DEFAULT_OUTLINE_COLOR="red",this.DEFAULT_OUTLINE_WIDTH=5,this.DEFAULT_SELECTION_MODE=SelectionMode.Exclusive,this.DEFAULT_SHOW_ALL_HOTSPOTS_ENABLED=!1,this.DEFAULT_EXCLUDED_OPACITY=.2,this.DEFAULT_ZOOM_TO_MARGIN=.2,this.DEFAULT_FLY_TO_DURATION=1,this._flyToDurationInSeconds=this.DEFAULT_FLY_TO_DURATION,this._zoomToMargin=this.DEFAULT_ZOOM_TO_MARGIN,this.selectedProductCodesChange=new core.vpe,this._excludedOpacity=this.DEFAULT_EXCLUDED_OPACITY,this.animationTimeChange=new core.vpe,this._animationPosition=0,this.animationPositionChange=new core.vpe,this._animationPlaying=!1,this.animationPlayingChange=new core.vpe,this._isolateModeEnabled=!1,this.isolateModeEnabledChange=new core.vpe,this._viewportReady=!1,this.viewportReadyChange=new core.vpe,this.contentChangesFinished=new core.vpe,this.contentLoadFinished=new core.vpe,this.visualizationLoadInfoChange=new core.vpe,!this.windowRef.isBrowser())return;const ui5Initialized$=this.bootstrapUi5("ui5bootstrap").pipe((0,mergeMap.zg)(this.initializeUi5.bind(this)));this.viewportAdded$=ui5Initialized$.pipe((0,mergeMap.zg)(this.addViewport.bind(this)),(0,shareReplay.d)()),this.executeWhenSceneLoaded(this.setInitialPropertyValues.bind(this))}ngOnDestroy(){var _a;null===(_a=this.selectedNodeIdsSubscription)||void 0===_a||_a.unsubscribe()}get sceneNodeToProductLookupService(){return this._sceneNodeToProductLookupService}set sceneNodeToProductLookupService(value){this._sceneNodeToProductLookupService=value}get scene(){return this._scene}set scene(value){this._scene=value}get nodeHierarchy(){return this._nodeHierarchy}set nodeHierarchy(value){this._nodeHierarchy=value}get contentConnector(){return this._contentConnector}set contentConnector(value){this._contentConnector=value}get viewport(){return this._viewport}set viewport(value){this._viewport=value}get viewStateManager(){return this._viewStateManager}set viewStateManager(value){this._viewStateManager=value}get animationPlayer(){return this._animationPlayer}set animationPlayer(value){this._animationPlayer=value}get viewManager(){return this._viewManager}set viewManager(value){this._viewManager=value}get drawerToolbar(){return this._drawerToolbar}set drawerToolbar(value){this._drawerToolbar=value}get sceneId(){return this._sceneId}set sceneId(value){this._sceneId=value}get contentType(){return this._contentType}set contentType(value){this._contentType=value}get initialViewInfo(){return this._initialViewInfo}set initialViewInfo(value){this._initialViewInfo=value}get leafNodeRefs(){return this._leafNodeRefs}set leafNodeRefs(value){this._leafNodeRefs=value}get viewPriorToIsolateViewInfo(){return this._viewPriorToIsolateViewInfo}set viewPriorToIsolateViewInfo(value){this._viewPriorToIsolateViewInfo=value}get viewportAdded$(){return this._viewportAdded$}set viewportAdded$(value){this._viewportAdded$=value}get selectedNodeIds$(){return this._selectedNodeIds$}set selectedNodeIds$(value){this._selectedNodeIds$=value}get sceneLoadInfo$(){return this._sceneLoadInfo$}get flyToDurationInSeconds(){return this._flyToDurationInSeconds}set flyToDurationInSeconds(value){this._flyToDurationInSeconds=value}get zoomToMargin(){return this._zoomToMargin}set zoomToMargin(value){this._zoomToMargin=value}set backgroundTopColor(backgroundTopColor){!this.windowRef.isBrowser()||this._backgroundTopColor!==backgroundTopColor&&(this._backgroundTopColor=backgroundTopColor,this.executeWhenSceneLoaded(()=>{this.viewport.setBackgroundColorTop(this.getCSSColor(backgroundTopColor))}))}get backgroundTopColor(){return this._backgroundTopColor}set backgroundBottomColor(backgroundBottomColor){!this.windowRef.isBrowser()||this._backgroundBottomColor!==backgroundBottomColor&&(this._backgroundBottomColor=backgroundBottomColor,this.executeWhenSceneLoaded(()=>{this.viewport.setBackgroundColorBottom(this.getCSSColor(backgroundBottomColor))}))}get backgroundBottomColor(){return this._backgroundBottomColor}set hotspotSelectionColor(hotspotSelectionColor){!this.windowRef.isBrowser()||this._hotspotSelectionColor!==hotspotSelectionColor&&(this._hotspotSelectionColor=hotspotSelectionColor,this.executeWhenSceneLoaded(()=>{this.viewStateManager.setHighlightColor(this.getCSSColor(hotspotSelectionColor))}))}get hotspotSelectionColor(){return this._hotspotSelectionColor}set showAllHotspotsEnabled(showAllHotspotsEnabled){!this.windowRef.isBrowser()||this._showAllHotspotsEnabled!==showAllHotspotsEnabled&&(this._showAllHotspotsEnabled=showAllHotspotsEnabled,this.executeWhenSceneLoaded(()=>{this.applyInclusionStyle(this._includedProductCodes)}))}get showAllHotspotsEnabled(){return this._showAllHotspotsEnabled}set showAllHotspotsColor(showAllHotspotsColor){!this.windowRef.isBrowser()||this._showAllHotspotsColor!==showAllHotspotsColor&&(this._showAllHotspotsColor=showAllHotspotsColor,this.executeWhenSceneLoaded(()=>{const cssColor=this.getCSSColor(showAllHotspotsColor);this.viewport.setShowAllHotspotsTintColor(cssColor)}))}get showAllHotspotsColor(){return this._showAllHotspotsColor}set outlineColor(outlineColor){!this.windowRef.isBrowser()||this._outlineColor!==outlineColor&&(this._outlineColor=outlineColor,this.executeWhenSceneLoaded(()=>{this.viewStateManager.setOutlineColor(this.getCSSColor(outlineColor))}))}get outlineColor(){return this._outlineColor}set outlineWidth(outlineWidth){!this.windowRef.isBrowser()||this._outlineWidth!==outlineWidth&&(this._outlineWidth=outlineWidth,this.executeWhenSceneLoaded(()=>{this.viewStateManager.setOutlineWidth(outlineWidth)}))}get outlineWidth(){return this._outlineWidth}set selectionMode(selectionMode){!this.windowRef.isBrowser()||this._selectionMode!==selectionMode&&(this._selectionMode=selectionMode,this.executeWhenSceneLoaded(()=>{this.viewport.setSelectionMode(selectionMode)}))}get selectionMode(){return this._selectionMode}set selectedProductCodes(selectedProductCodes){!this.windowRef.isBrowser()||(this._selectedProductCodes=selectedProductCodes,this.sceneNodeToProductLookupService.lookupNodeIds(selectedProductCodes).pipe((0,first.P)()).subscribe(selectedNodeIds=>{this.selectedNodeIds$.next(selectedNodeIds)}))}get selectedProductCodes(){return this._selectedProductCodes}set includedProductCodes(includedProductCodes){!this.windowRef.isBrowser()||(this._includedProductCodes=includedProductCodes,this.executeWhenSceneLoaded(()=>{this.applyInclusionStyle(includedProductCodes)}))}get includedProductCodes(){return this._includedProductCodes}set excludedOpacity(excludedOpacity){!this.windowRef.isBrowser()||(this._excludedOpacity=excludedOpacity)}get excludedOpacity(){return this._excludedOpacity}set animationTime(animationTime){!this.windowRef.isBrowser()||(this._animationTime=animationTime)}get animationTime(){return this._animationTime}get animationTotalDuration(){return this.animationPlayer?this.animationPlayer.getTotalDuration():0}set animationPosition(position){!this.windowRef.isBrowser()||this._animationPosition!==position&&(this._animationPosition=position,this.executeWhenSceneLoaded(()=>{const time=position*this.animationPlayer.getTotalDuration();this.animationPlayerSetTime(time,!1)}))}get animationPosition(){return this._animationPosition}set animationPlaying(animationPlaying){!this.windowRef.isBrowser()||this._animationPlaying!==animationPlaying&&(this._animationPlaying=animationPlaying,this.executeWhenSceneLoaded(()=>{animationPlaying?(this.animationPosition>=1&&this.animationPlayerSetTime(0,!1),this.animationPlayer.play()):this.animationPlayer.stop(),this.animationPlayingChange.emit(animationPlaying)}))}get animationPlaying(){return this._animationPlaying}set navigationMode(navigationMode){!this.windowRef.isBrowser()||this._navigationMode!==navigationMode&&(this._navigationMode=navigationMode,this.executeWhenSceneLoaded(()=>{this.drawerToolbar&&this.viewport&&this.drawerToolbar._activateGesture(this.viewport.getImplementation(),navigationMode)}))}get navigationMode(){return this._navigationMode}set isolateModeEnabled(isolateModeEnabled){!this.windowRef.isBrowser()||this._isolateModeEnabled!==isolateModeEnabled&&this.executeWhenSceneLoaded(()=>{if(this._isolateModeEnabled=isolateModeEnabled,isolateModeEnabled){this.viewPriorToIsolateViewInfo=this.viewport.getViewInfo({camera:!0,visibility:!0});const selectedNodeRefs=[];this.is2D?this.viewStateManager.enumerateSelection(nodeRef=>selectedNodeRefs.push(nodeRef)):this.viewStateManager.enumerateOutlinedNodes(nodeRef=>selectedNodeRefs.push(nodeRef)),this.isolateNodes(selectedNodeRefs)}else this.viewport.setViewInfo(this.viewPriorToIsolateViewInfo,this.flyToDurationInSeconds);this.isolateModeEnabledChange.emit(this.isolateModeEnabled)})}get isolateModeEnabled(){return this._isolateModeEnabled}get is2D(){return this._is2D}setIs2D(is2D){this._is2D=is2D}get viewportReady(){return this._viewportReady}setViewportReady(viewportReady){this._viewportReady!==viewportReady&&(this._viewportReady=viewportReady,this.viewportReadyChange.emit(viewportReady))}activateHomeView(){!this.windowRef.isBrowser()||(this.is2D?this.viewport.zoomTo(ZoomTo.All,null,this.flyToDurationInSeconds,this.zoomToMargin):this.viewport.setViewInfo(this.initialViewInfo,this.flyToDurationInSeconds),this.isolateModeEnabled&&(this._isolateModeEnabled=!1,this.isolateModeEnabledChange.emit(!1)))}playAnimation(){!this.windowRef.isBrowser()||(this.animationPlaying=!0)}pauseAnimation(){!this.windowRef.isBrowser()||(this.animationPlaying=!1)}setInitialPropertyValues(){void 0===this.backgroundTopColor&&(this.backgroundTopColor=this.DEFAULT_BACKGROUND_TOP_COLOR),void 0===this.backgroundBottomColor&&(this.backgroundBottomColor=this.DEFAULT_BACKGROUND_BOTTOM_COLOR),void 0===this.hotspotSelectionColor&&(this.hotspotSelectionColor=this.DEFAULT_HOTSPOT_SELECTION_HIGHLIGHT_COLOR),void 0===this.showAllHotspotsColor&&(this.showAllHotspotsColor=this.DEFAULT_SHOW_ALL_HOTSPOTS_COLOR),void 0===this.outlineColor&&(this.outlineColor=this.DEFAULT_OUTLINE_COLOR),void 0===this.outlineWidth&&(this.outlineWidth=this.DEFAULT_OUTLINE_WIDTH),void 0===this.selectionMode&&(this.selectionMode=this.DEFAULT_SELECTION_MODE),void 0===this.showAllHotspotsEnabled&&(this.showAllHotspotsEnabled=this.DEFAULT_SHOW_ALL_HOTSPOTS_ENABLED),this.is2D?(void 0===this.navigationMode||this.navigationMode===NavigationMode.Turntable)&&(this.navigationMode=NavigationMode.Pan):void 0===this.navigationMode&&(this.navigationMode=NavigationMode.Turntable),void 0===this.selectedProductCodes&&(this.selectedProductCodes=this.selectedNodeIds$.getValue())}executeWhenSceneLoaded(callback){this.sceneLoadInfo$.pipe((0,filter.h)(sceneLoadInfo=>sceneLoadInfo.sceneLoadState===SceneLoadState.Loaded||sceneLoadInfo.sceneLoadState===SceneLoadState.Failed),(0,first.P)()).subscribe(sceneLoadInfo=>{sceneLoadInfo.sceneLoadState===SceneLoadState.Loaded&&callback(sceneLoadInfo.loadedSceneInfo)})}applyInclusionStyle(productCodes){void 0!==productCodes&&this.sceneNodeToProductLookupService.lookupNodeIds(productCodes).pipe((0,first.P)()).subscribe(sceneNodeIds=>{this.is2D?this.applyInclusionStyle2D(sceneNodeIds):this.applyInclusionStyle3D(sceneNodeIds)})}applyInclusionStyle2D(sceneNodeIds){const nodeRefsToInclude=this.persistentIdToNodeRef(sceneNodeIds,!0),hotspotNodeRefs=this.nodeHierarchy.getHotspotNodeIds(),hotspotNodeRefsSet=new Set(hotspotNodeRefs),topLevelHotspotNodeRefs=hotspotNodeRefs.filter(hotspotNodeRef=>this.isTopLevelHotspotNode(hotspotNodeRef,hotspotNodeRefsSet));if(this._showAllHotspotsEnabled){const nodeRefsToIncludeSet=new Set(nodeRefsToInclude),nodeRefsToExclude=topLevelHotspotNodeRefs.filter(nodeRef=>!nodeRefsToIncludeSet.has(nodeRef));this.viewport.showHotspots(nodeRefsToExclude,!1,0),this.viewport.showHotspots(nodeRefsToInclude,!0,this.getCSSColor(this._showAllHotspotsColor))}else this.viewport.showHotspots(topLevelHotspotNodeRefs,!1,0)}applyInclusionStyle3D(sceneNodeIds){const nodeRefsToInclude=this.persistentIdToNodeRef(sceneNodeIds,!0);this.leafNodeRefs||(this.leafNodeRefs=this.getAllLeafNodeRefs());const leafNodeRefsToInclude=nodeRefsToInclude.flatMap(nodeRef=>this.getLeafDescendants(nodeRef,[])),leafNodeRefsToIncludeSet=new Set(leafNodeRefsToInclude),leafNodeRefsToExclude=this.leafNodeRefs.filter(leafNodeRef=>!leafNodeRefsToIncludeSet.has(leafNodeRef));this.viewStateManager.setOpacity(leafNodeRefsToExclude,this.excludedOpacity),leafNodeRefsToInclude.forEach(nodeRef=>this.viewStateManager.setOpacity(nodeRef,this.viewStateManager.getRestOpacity(nodeRef)))}isTopLevelHotspotNode(hotspotNodeRef,hotspotNodeRefs){return!this.nodeHierarchy.getAncestors(hotspotNodeRef).some(ancestor=>hotspotNodeRefs.has(ancestor))}isReferenceNode(nodeRef){return this.nodeHierarchy.getNodeContentType(nodeRef)===NodeContentType.Reference}getLeafDescendants(nodeRef,leafNodeRefs){if(!this.isReferenceNode(nodeRef)){const children=this.nodeHierarchy.getChildren(nodeRef,!1).filter(childNodeRef=>!this.isReferenceNode(childNodeRef));0===children.length?leafNodeRefs.push(nodeRef):children.forEach(childNodeRef=>this.getLeafDescendants(childNodeRef,leafNodeRefs))}return leafNodeRefs}getAllLeafNodeRefs(){return this.nodeHierarchy.getChildren(void 0).flatMap(nodeRef=>this.getLeafDescendants(nodeRef,[]))}isolateNodes(nodeRefsToIsolate){nodeRefsToIsolate=nodeRefsToIsolate.slice(0,1),this.viewport.zoomTo(ZoomTo.Node,nodeRefsToIsolate,this.flyToDurationInSeconds,this.zoomToMargin);const currentVisibleSids=this.viewPriorToIsolateViewInfo.visibility.visible||[],currentVisibleNodeRefs=this.persistentIdToNodeRef(currentVisibleSids,!0);this.viewStateManager.setVisibilityState(currentVisibleNodeRefs,!1,!0,!1),this.viewStateManager.setVisibilityState(nodeRefsToIsolate,!0,!0,!0)}animationPlayerSetTime(time,blockEvents){this.animationPlayer.setTime(time,void 0,blockEvents)}onViewActivated(){this.initialViewInfo=this.viewport.getViewInfo({camera:!0,visibility:!0})}onTimeChanged(oEvent){let changes=!1;const time=oEvent.getParameters().time;this.animationTime!==time&&(this.animationTime=time,this.animationTimeChange.emit(time),changes=!0);const position=this.animationTotalDuration?this.animationTime/this.animationTotalDuration:0;this.animationPosition!==position&&(this.animationPosition=position,this.animationPositionChange.emit(position),changes=!0),this.animationPlaying&&this.animationPosition>=1&&(this._animationPlaying=!1,this.animationPlayingChange.emit(this._animationPlaying)),changes&&this.changeDetectorRef.detectChanges()}setVisualizationLoadInfo(visualizationLoadInfo){this._visualizationLoadInfo=visualizationLoadInfo,this.visualizationLoadInfoChange.emit(visualizationLoadInfo),this.changeDetectorRef.detectChanges()}get visualizationLoadInfo(){return this._visualizationLoadInfo}loadVisualization(productCode){var _a;return this.windowRef.isBrowser()?(null===(_a=this.selectedNodeIdsSubscription)||void 0===_a||_a.unsubscribe(),this.viewportAdded$.pipe((0,mergeMap.zg)(()=>this.resolveVisualization(productCode).pipe((0,mergeMap.zg)(visualizationLoadInfo=>{if(visualizationLoadInfo.lookupResult===VisualizationLookupResult.UniqueMatchFound){this.sceneNodeToProductLookupService.populateMapsForScene(this.sceneId);let mergedVisualizationLoadInfo=Object.assign(Object.assign({},visualizationLoadInfo),{loadStatus:VisualizationLoadStatus.Loading});return this.setVisualizationLoadInfo(mergedVisualizationLoadInfo),this.loadScene(this.sceneId,this.contentType).pipe((0,mergeMap.zg)(sceneLoadInfo=>(sceneLoadInfo.sceneLoadState===SceneLoadState.Failed?mergedVisualizationLoadInfo=Object.assign(Object.assign({},visualizationLoadInfo),{loadStatus:VisualizationLoadStatus.UnexpectedError,errorMessage:sceneLoadInfo.errorMessage}):(this.selectedNodeIdsSubscription=this.selectedNodeIds$.subscribe(this.handleSelectedNodeIds.bind(this)),mergedVisualizationLoadInfo=Object.assign(Object.assign({},visualizationLoadInfo),{loadStatus:VisualizationLoadStatus.Loaded})),this.setVisualizationLoadInfo(mergedVisualizationLoadInfo),(0,of.of)(mergedVisualizationLoadInfo))))}return(0,of.of)(visualizationLoadInfo)}))))):(0,of.of)({lookupResult:VisualizationLookupResult.UnexpectedError,loadStatus:VisualizationLoadStatus.UnexpectedError,errorMessage:"Should not call loadVisualization in server side code"})}isUi5BootStrapped(){return!!this.windowRef.nativeWindow&&!!this.windowRef.nativeWindow.sap}getCore(){return sap.ui.getCore()}bootstrapUi5(scriptElementId){const ui5Config=this.epdVisualizationConfig.epdVisualization.ui5;return new Observable.y(subscriber=>{if(this.isUi5BootStrapped())return subscriber.next(),void subscriber.complete();const script=this.windowRef.document.createElement("script");script.setAttribute("id",scriptElementId),this.windowRef.document.getElementsByTagName("head")[0].appendChild(script),script.onload=()=>{subscriber.next(),subscriber.complete()},script.onerror=error=>{subscriber.error(error),subscriber.complete()},script.id="sap-ui-bootstrap",script.type="text/javascript",script.setAttribute("data-sap-ui-compatVersion","edge"),script.src=ui5Config.bootstrapUrl})}initializeUi5(){return new Observable.y(subscriber=>{const core2=this.getCore();core2.attachInit(()=>{const loadLibraryOptions={async:!0};Promise.all([core2.loadLibrary("sap.m",loadLibraryOptions),core2.loadLibrary("sap.ui.layout",loadLibraryOptions),core2.loadLibrary("sap.ui.vk",loadLibraryOptions),core2.loadLibrary("sap.ui.richtexteditor",loadLibraryOptions)]).then(()=>{subscriber.next(),subscriber.complete()})})})}destroyViewportAssociations(viewport){const core2=this.getCore();if(!core2)return;const contentConnectorId=viewport.getContentConnector();if(contentConnectorId){const contentConnector=core2.byId(contentConnectorId);contentConnector&&contentConnector.destroy()}const viewStateManagerId=viewport.getViewStateManager();if(viewStateManagerId&&core2.byId(viewStateManagerId)){const viewStateManager=core2.byId(viewStateManagerId);if(viewStateManager){const animationPlayer=viewStateManager.getAnimationPlayer();animationPlayer&&animationPlayer.destroy();const viewManagerId=viewStateManager.getViewManager();if(viewManagerId){const viewManager=core2.byId(viewManagerId);viewManager&&viewManager.destroy()}viewStateManager.destroy()}}}onContentChangesStarted(){this.viewport.detachNodesPicked(this.onNodesPicked)}onContentChangesFinished(event){const content=event.getParameter("content"),failureReason=event.getParameter("failureReason");!!content&&!failureReason&&(this.scene=content,this.nodeHierarchy=this.scene.getDefaultNodeHierarchy(),this.viewport.attachNodesPicked(this.onNodesPicked,this),content.loaders&&content.loaders.forEach(contentLoader=>{contentLoader&&void 0!==contentLoader.attachLoadingFinished&&contentLoader.attachLoadingFinished(this.onContentLoadingFinished,this)})),this.contentChangesFinished.emit({content,failureReason})}onContentLoadingFinished(_event){this.contentLoadFinished.emit({})}onNodesPicked(event){this.is2D?this.onNodesPicked2D(event):this.onNodesPicked3D(event)}isNodeIncluded(nodeRef){const sids=this.nodeRefToPersistentId([nodeRef],!0),productCodes=this.sceneNodeToProductLookupService.syncLookupProductCodes(sids);return!!productCodes&&productCodes.some(productCode=>this.includedProductCodes.includes(productCode))}onNodesPicked2D(event){const pickedNodes=event.getParameter("picked");if(0===pickedNodes.length)return;const hotSpots=pickedNodes.filter(node=>node.nodeContentType&&node.nodeContentType===NodeContentType.Hotspot);if(0===hotSpots.length)return;const includedHotSpots=hotSpots.filter(nodeRef=>this.isNodeIncluded(nodeRef));pickedNodes.splice(0),includedHotSpots.forEach(includedHotSpot=>pickedNodes.push(includedHotSpot))}onNodesPicked3D(event){const picked=event.getParameter("picked");picked.splice(0,picked.length).forEach(node=>{for(;!this.isNodeIncluded(node)&&(node=node.parent););node&&picked.push(node)})}addViewport(){return new Observable.y(subscriber=>{sap.ui.require(["sap/ui/vk/ViewManager","sap/ui/vk/Viewport","sap/ui/vk/ViewStateManager","sap/ui/vk/AnimationPlayer","sap/ui/vk/ContentConnector","sap/ui/vk/DrawerToolbar"],(sap_ui_vk_ViewManager,sap_ui_vk_Viewport,sap_ui_vk_ViewStateManager,sap_ui_vk_AnimationPlayer,sap_ui_vk_ContentConnector,sap_ui_vk_DrawerToolbar)=>{const uiArea=this.getCore().getUIArea(this.elementRef.nativeElement);if(uiArea){const oldViewport=uiArea.getContent()[0];this.destroyViewportAssociations(oldViewport),uiArea.destroyContent()}this.viewport=new sap_ui_vk_Viewport({visible:!1}),this.viewport.placeAt(this.elementRef.nativeElement),this.contentConnector=new sap_ui_vk_ContentConnector,this.contentConnector.attachContentChangesStarted(this.onContentChangesStarted,this),this.contentConnector.attachContentChangesFinished(this.onContentChangesFinished,this),this.contentConnector.attachContentLoadingFinished(this.onContentLoadingFinished,this),this.viewStateManager=new sap_ui_vk_ViewStateManager({contentConnector:this.contentConnector}),this.viewport.setContentConnector(this.contentConnector),this.viewport.setViewStateManager(this.viewStateManager),this.animationPlayer=new sap_ui_vk_AnimationPlayer,this.animationPlayer.setViewStateManager(this.viewStateManager),this.animationPlayer.attachViewActivated(this.onViewActivated,this),this.animationPlayer.attachTimeChanged(this.onTimeChanged,this),this.viewManager=new sap_ui_vk_ViewManager({contentConnector:this.contentConnector,animationPlayer:this.animationPlayer}),this.viewStateManager.setViewManager(this.viewManager),this.viewStateManager.attachSelectionChanged(this.onSelectionChanged,this),this.viewStateManager.attachOutliningChanged(this.onOutliningChanged,this),this.drawerToolbar=new sap_ui_vk_DrawerToolbar({viewport:this.viewport,visible:!1}),this.viewport.addDependent(this.drawerToolbar),subscriber.next(),subscriber.complete()})})}getCSSPropertyValue(cssPropertyName){const storefrontElement=document.getElementsByTagName("cx-storefront")[0];return getComputedStyle(storefrontElement).getPropertyValue(cssPropertyName)}getCSSColor(color){return(this.getCSSPropertyValue(color)||color).trim()}resolveVisualization(productCode){return this.visualizationLookupService.findMatchingVisualizations(productCode).pipe((0,mergeMap.zg)(matches=>{let visualizationLoadInfo;switch(matches.length){case 0:visualizationLoadInfo={lookupResult:VisualizationLookupResult.NoMatchFound,loadStatus:VisualizationLoadStatus.NotStarted,matches};break;case 1:const matchingVisualization=matches[0];this.sceneId=matchingVisualization.sceneId,this.contentType=matchingVisualization.contentType,visualizationLoadInfo={lookupResult:VisualizationLookupResult.UniqueMatchFound,loadStatus:VisualizationLoadStatus.NotStarted,matches,visualization:matchingVisualization};break;default:visualizationLoadInfo={lookupResult:VisualizationLookupResult.MultipleMatchesFound,loadStatus:VisualizationLoadStatus.NotStarted,matches}}return this.setVisualizationLoadInfo(visualizationLoadInfo),(0,of.of)(visualizationLoadInfo)}),(0,catchError.K)(()=>{const visualizationLoadInfo={lookupResult:VisualizationLookupResult.UnexpectedError,loadStatus:VisualizationLoadStatus.NotStarted};return this.setVisualizationLoadInfo(visualizationLoadInfo),(0,of.of)(visualizationLoadInfo)}))}persistentIdToNodeRef(nodeIds,filterUnresolvedValues){const nodeRefs=this.scene.persistentIdToNodeRef(nodeIds);return filterUnresolvedValues?nodeRefs.filter(nodeRef=>!!nodeRef):nodeRefs}nodeRefToPersistentId(nodeRefs,filterUnresolvedValues){const sids=this.scene.nodeRefToPersistentId(nodeRefs);return filterUnresolvedValues?sids.filter(sid=>!!sid):sids}getViewStateManagerImplementation(){return this.viewStateManager.getImplementation()}handleSelectedNodeIds(nodeIds){const nodeRefs=this.persistentIdToNodeRef(nodeIds,!0);this.is2D?this.handleSelectedNodes2D(nodeRefs):this.handleSelectedNodes3D(nodeRefs),this.isolateModeEnabled&&nodeRefs.length>0&&this.isolateNodes(nodeRefs),this.setShouldRenderFrame()}handleSelectedNodes2D(selectedNodes){const existingSelection=[];this.viewStateManager.enumerateSelection(nodeRef=>existingSelection.push(nodeRef)),this.viewStateManager.setSelectionStates([],existingSelection,!1,!0),this.viewStateManager.setSelectionStates(selectedNodes,[],!1,!0)}handleSelectedNodes3D(selectedNodes){const existingOutlinedNodeRefs=[];this.viewStateManager.enumerateOutlinedNodes(nodeRef=>existingOutlinedNodeRefs.push(nodeRef)),this.getViewStateManagerImplementation().setOutliningStates([],existingOutlinedNodeRefs,!1,!0),this.getViewStateManagerImplementation().setOutliningStates(selectedNodes,[],!1,!0)}setShouldRenderFrame(){this.viewport.setShouldRenderFrame()}is2DContentType(contentType){return contentType===spartacus_epd_visualization_root.zc.Drawing2D}loadScene(sceneId,contentType){const visualizationApiConfig=this.epdVisualizationConfig.epdVisualization.apis;return this.viewportReady&&this.setViewportReady(!1),this.setIs2D(this.is2DContentType(contentType)),new Observable.y(subscriber=>{sap.ui.require(["sap/ui/vk/ContentResource"],ContentResource=>{this.sceneLoadInfo$.next({sceneLoadState:SceneLoadState.Loading}),this.viewport.setSelectionDisplayMode(this.is2D?"Highlight":"Outline");const baseUrl=visualizationApiConfig.baseUrl,contentResource=new ContentResource({useSecureConnection:!1,sourceType:this.is2D?"stream2d":"stream",source:`${baseUrl}/vis/public/storage/v1`,veid:sceneId});this.contentChangesFinished.pipe((0,first.P)()).subscribe(visualContentLoadFinished=>{const sceneLoadInfo=visualContentLoadFinished.content?{sceneLoadState:SceneLoadState.Loaded,loadedSceneInfo:{sceneId,contentType}}:{sceneLoadState:SceneLoadState.Failed,errorMessage:visualContentLoadFinished.failureReason};this.sceneLoadInfo$.next(sceneLoadInfo),subscriber.next(sceneLoadInfo),subscriber.complete()}),this.contentLoadFinished.pipe((0,first.P)()).subscribe(()=>{this.sceneLoadInfo$.value.sceneLoadState===SceneLoadState.Loaded&&(this.setViewportReady(!0),this.changeDetectorRef.detectChanges(),this.viewport.setVisible(!0))}),this.contentConnector.addContentResource(contentResource)})})}onSelectionChanged(){const nodeRefs=[];this.viewStateManager.enumerateSelection(nodeRef=>nodeRefs.push(nodeRef));const nodeIds=this.nodeRefToPersistentId(nodeRefs,!0);this.sceneNodeToProductLookupService.lookupProductCodes(nodeIds).pipe((0,first.P)()).subscribe(productCodes=>{this.selectedProductCodesChange.emit(productCodes)})}onOutliningChanged(){const nodeRefs=[];this.viewStateManager.enumerateOutlinedNodes(nodeRef=>nodeRefs.push(nodeRef));const nodeIds=this.nodeRefToPersistentId(nodeRefs,!0);this.sceneNodeToProductLookupService.lookupProductCodes(nodeIds).pipe((0,first.P)()).subscribe(productCodes=>{this.selectedProductCodesChange.emit(productCodes)})}}__name(VisualViewerService,"VisualViewerService"),VisualViewerService.\u0275fac=__name(function(t){return new(t||VisualViewerService)(core.LFG(spartacus_epd_visualization_root._v),core.LFG(SceneNodeToProductLookupService),core.LFG(VisualizationLookupService),core.LFG(core.SBq),core.LFG(core.sBO),core.LFG(spartacus_core.X9E))},"VisualViewerService_Factory"),VisualViewerService.\u0275prov=core.Yz7({token:VisualViewerService,factory:VisualViewerService.\u0275fac,providedIn:"any"});class VisualViewerComponent{constructor(visualViewerService){this.visualViewerService=visualViewerService,this.selectedProductCodesChange=this.visualViewerService.selectedProductCodesChange,this.animationTimeChange=this.visualViewerService.animationTimeChange,this.animationPositionChange=this.visualViewerService.animationPositionChange,this.animationPlayingChange=this.visualViewerService.animationPlayingChange,this.isolateModeEnabledChange=this.visualViewerService.isolateModeEnabledChange,this.viewportReadyChange=this.visualViewerService.viewportReadyChange,this.SelectionMode=SelectionMode,this.NavigationMode=NavigationMode}set backgroundTopColor(backgroundTopColor){this.visualViewerService.backgroundTopColor=backgroundTopColor}get backgroundTopColor(){return this.visualViewerService.backgroundTopColor}set backgroundBottomColor(backgroundBottomColor){this.visualViewerService.backgroundBottomColor=backgroundBottomColor}get backgroundBottomColor(){return this.visualViewerService.backgroundBottomColor}set hotspotSelectionColor(hotspotSelectionColor){this.visualViewerService.hotspotSelectionColor=hotspotSelectionColor}get hotspotSelectionColor(){return this.visualViewerService.hotspotSelectionColor}set showAllHotspotsEnabled(showAllHotspotsEnabled){this.visualViewerService.showAllHotspotsEnabled=showAllHotspotsEnabled}get showAllHotspotsEnabled(){return this.visualViewerService.showAllHotspotsEnabled}set showAllHotspotsColor(showAllHotspotsColor){this.visualViewerService.showAllHotspotsColor=showAllHotspotsColor}get showAllHotspotsColor(){return this.visualViewerService.showAllHotspotsColor}set outlineColor(outlineColor){this.visualViewerService.outlineColor=outlineColor}get outlineColor(){return this.visualViewerService.outlineColor}set outlineWidth(outlineWidth){this.visualViewerService.outlineWidth=outlineWidth}get outlineWidth(){return this.visualViewerService.outlineWidth}set selectionMode(selectionMode){this.visualViewerService.selectionMode=selectionMode}get selectionMode(){return this.visualViewerService.selectionMode}set selectedProductCodes(selectedProductCodes){this.visualViewerService.selectedProductCodes=selectedProductCodes}get selectedProductCodes(){return this.visualViewerService.selectedProductCodes}set includedProductCodes(includedProductCodes){this.visualViewerService.includedProductCodes=includedProductCodes}get includedProductCodes(){return this.visualViewerService.includedProductCodes}set excludedOpacity(excludedOpacity){this.visualViewerService.excludedOpacity=excludedOpacity}get excludedOpacity(){return this.visualViewerService.excludedOpacity}set animationTime(animationTime){this.visualViewerService.animationTime=animationTime}get animationTime(){return this.visualViewerService.animationTime}get animationTotalDuration(){return this.visualViewerService.animationTotalDuration}set animationPosition(animationPosition){this.visualViewerService.animationPosition=animationPosition}get animationPosition(){return this.visualViewerService.animationPosition}set animationPlaying(animationPlaying){this.visualViewerService.animationPlaying=animationPlaying}get animationPlaying(){return this.visualViewerService.animationPlaying}set navigationMode(navigationMode){this.visualViewerService.navigationMode=navigationMode}get navigationMode(){return this.visualViewerService.navigationMode}set isolateModeEnabled(isolateModeEnabled){this.visualViewerService.isolateModeEnabled=isolateModeEnabled}get isolateModeEnabled(){return this.visualViewerService.isolateModeEnabled}get is2D(){return this.visualViewerService.is2D}get viewportReady(){return this.visualViewerService.viewportReady}activateHomeView(){this.visualViewerService.activateHomeView()}playAnimation(){this.visualViewerService.playAnimation()}pauseAnimation(){this.visualViewerService.pauseAnimation()}loadVisualization(productCode){return this.visualViewerService.loadVisualization(productCode)}}__name(VisualViewerComponent,"VisualViewerComponent"),VisualViewerComponent.\u0275fac=__name(function(t){return new(t||VisualViewerComponent)(core.Y36(VisualViewerService))},"VisualViewerComponent_Factory"),VisualViewerComponent.\u0275cmp=core.Xpm({type:VisualViewerComponent,selectors:[["cx-epd-visualization-viewer"]],inputs:{backgroundTopColor:"backgroundTopColor",backgroundBottomColor:"backgroundBottomColor",hotspotSelectionColor:"hotspotSelectionColor",showAllHotspotsEnabled:"showAllHotspotsEnabled",showAllHotspotsColor:"showAllHotspotsColor",outlineColor:"outlineColor",outlineWidth:"outlineWidth",selectionMode:"selectionMode",selectedProductCodes:"selectedProductCodes",includedProductCodes:"includedProductCodes",excludedOpacity:"excludedOpacity",animationTime:"animationTime",animationPosition:"animationPosition",animationPlaying:"animationPlaying",navigationMode:"navigationMode",isolateModeEnabled:"isolateModeEnabled"},outputs:{selectedProductCodesChange:"selectedProductCodesChange",animationTimeChange:"animationTimeChange",animationPositionChange:"animationPositionChange",animationPlayingChange:"animationPlayingChange",isolateModeEnabledChange:"isolateModeEnabledChange",viewportReadyChange:"viewportReadyChange"},features:[core._Bn([VisualViewerService])],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],["role","status"],[1,"content-type-symbol",3,"hidden"],[1,"content-type-text"],[1,"bottom","overlay"],[1,"toolbar",3,"hidden"],[1,"toolbarHBox"],[1,"toolbarButtonsHBox"],["iconLibraryClass","fas","iconClass","fa-home",1,"homeButton",3,"text","click"],["iconLibraryClass","fas","iconClass","fa-sync-alt",1,"turntableButton","toolbarItem",3,"text","hidden","checked","click"],["iconLibraryClass","fas","iconClass","fa-arrows-alt",1,"panButton","toolbarItem",3,"text","checked","click"],["iconLibraryClass","fas","iconClass","fa-search",1,"zoomButton","toolbarItem",3,"text","checked","click"],["iconLibraryClass","fas","iconClass","fa-compress",1,"isolateButton","toolbarItem",3,"hidden","disabled","text","checked","click"],["iconLibraryClass","fas",1,"playPauseButton","toolbarItem",3,"iconClass","text","hidden","disabled","click"],["iconLibraryClass","fas","iconClass","fa-highlighter",1,"showAllHotpotsButton","toolbarItem",3,"text","checked","hidden","click"],[3,"hidden"],[3,"disabled","value","valueChange","keydown.enter","keydown.space"],[1,"cx-spinner"]],template:__name(function(rf,ctx){if(1&rf&&(core.YNc(0,VisualViewerComponent_ng_container_0_Template,27,44,"ng-container",0),core.YNc(1,VisualViewerComponent_ng_template_1_Template,2,0,"ng-template",null,1,core.W1O)),2&rf){const _r1=core.MAs(2);core.Q6J("ngIf",ctx.viewportReady)("ngIfElse",_r1)}},"VisualViewerComponent_Template"),dependencies:[common.O5,VisualViewerToolbarButtonComponent,VisualViewerAnimationSliderComponent,spartacus_storefront.ORR,spartacus_core.X$D],encapsulation:2,changeDetection:0});class VisualViewerModule{}__name(VisualViewerModule,"VisualViewerModule"),VisualViewerModule.\u0275fac=__name(function(t){return new(t||VisualViewerModule)},"VisualViewerModule_Factory"),VisualViewerModule.\u0275mod=core.oAB({type:VisualViewerModule}),VisualViewerModule.\u0275inj=core.cJS({imports:[common.ez,router.Bz,spartacus_core.LUR,VisualViewerToolbarButtonModule,VisualViewerAnimationSliderModule,spartacus_storefront.Fme]});class VisualPickingProductFilterService{constructor(){this._filter="",this.filter$=new core.vpe,this.fieldsToMatch=["code","name"]}set filter(filterStr){this._filter!==filterStr&&(this._filter=filterStr,this.filter$.emit(filterStr))}get filter(){return this._filter}applyFilter(filterToApply,unfilteredProductReferences){return filterToApply=filterToApply.toLowerCase(),unfilteredProductReferences.filter(productReference=>{const product=productReference.target;return this.fieldsToMatch.some(field=>{const fieldValue=product[field];return void 0!==fieldValue&&-1!==fieldValue.toLowerCase().indexOf(filterToApply)})})}getFilteredProducts(unfilteredProductReferences$){return(0,combineLatest.aj)([(0,concat.z)((0,of.of)(""),this.filter$),unfilteredProductReferences$]).pipe((0,filter.h)(([filterStr,productReferences])=>void 0!==filterStr&&void 0!==productReferences),(0,map.U)(([filterToApply,productReferences])=>this.applyFilter(filterToApply,productReferences)))}}__name(VisualPickingProductFilterService,"VisualPickingProductFilterService"),VisualPickingProductFilterService.\u0275fac=__name(function(t){return new(t||VisualPickingProductFilterService)},"VisualPickingProductFilterService_Factory"),VisualPickingProductFilterService.\u0275prov=core.Yz7({token:VisualPickingProductFilterService,factory:VisualPickingProductFilterService.\u0275fac,providedIn:"root"});class VisualPickingProductFilterComponent{constructor(visualPickingProductFilterService){this.visualPickingProductFilterService=visualPickingProductFilterService,this.iconTypes=spartacus_storefront.e1G}set filter(filter2){this.visualPickingProductFilterService.filter=filter2}get filter(){return this.visualPickingProductFilterService.filter}}__name(VisualPickingProductFilterComponent,"VisualPickingProductFilterComponent"),VisualPickingProductFilterComponent.\u0275fac=__name(function(t){return new(t||VisualPickingProductFilterComponent)(core.Y36(VisualPickingProductFilterService))},"VisualPickingProductFilterComponent_Factory"),VisualPickingProductFilterComponent.\u0275cmp=core.Xpm({type:VisualPickingProductFilterComponent,selectors:[["cx-epd-visualization-product-filter"]],inputs:{filter:"filter"},decls:7,vars:14,consts:[[1,"form-group","search-wrapper"],["type","text",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[1,"search",3,"type","hidden"],["tabindex","0",1,"reset",3,"type","hidden","mousedown","keydown.enter"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"input",1),core.NdJ("ngModelChange",__name(function($event){return ctx.filter=$event},"VisualPickingProductFilterComponent_Template_input_ngModelChange_1_listener")),core.ALo(2,"cxTranslate"),core.qZA(),core._UZ(3,"cx-icon",2),core.ALo(4,"cxTranslate"),core.TgZ(5,"cx-icon",3),core.NdJ("mousedown",__name(function(){return ctx.filter=""},"VisualPickingProductFilterComponent_Template_cx_icon_mousedown_5_listener"))("keydown.enter",__name(function(){return ctx.filter=""},"VisualPickingProductFilterComponent_Template_cx_icon_keydown_enter_5_listener")),core.ALo(6,"cxTranslate"),core.qZA()()),2&rf&&(core.xp6(1),core.s9C("placeholder",core.lcZ(2,8,"epdVisualization.visualPicking.visualPickingProductFilter.input.placeholder")),core.Q6J("ngModel",ctx.filter),core.xp6(2),core.Q6J("type",ctx.iconTypes.SEARCH)("hidden",ctx.filter.length>0),core.uIk("aria-label",core.lcZ(4,10,"epdVisualization.visualPicking.visualPickingProductFilter.searchButton.label")),core.xp6(2),core.Q6J("type",ctx.iconTypes.RESET)("hidden",0===ctx.filter.length),core.uIk("aria-label",core.lcZ(6,12,"epdVisualization.visualPicking.visualPickingProductFilter.resetButton.label")))},"VisualPickingProductFilterComponent_Template"),dependencies:[fesm2015_forms.Fj,fesm2015_forms.JJ,fesm2015_forms.On,spartacus_storefront.oJW,spartacus_core.X$D],encapsulation:2,changeDetection:0});class VisualPickingProductFilterModule{}__name(VisualPickingProductFilterModule,"VisualPickingProductFilterModule"),VisualPickingProductFilterModule.\u0275fac=__name(function(t){return new(t||VisualPickingProductFilterModule)},"VisualPickingProductFilterModule_Factory"),VisualPickingProductFilterModule.\u0275mod=core.oAB({type:VisualPickingProductFilterModule}),VisualPickingProductFilterModule.\u0275inj=core.cJS({providers:[VisualPickingProductFilterService],imports:[common.ez,fesm2015_forms.u5,spartacus_storefront.QX1,spartacus_core.bhT,spartacus_core.LUR]});class CompactAddToCartComponent extends spartacus_cart_base_components_add_to_cart.AddToCartComponent{}__name(CompactAddToCartComponent,"CompactAddToCartComponent"),CompactAddToCartComponent.\u0275fac=function(){let \u0275CompactAddToCartComponent_BaseFactory;return __name(function(t){return(\u0275CompactAddToCartComponent_BaseFactory||(\u0275CompactAddToCartComponent_BaseFactory=core.n5z(CompactAddToCartComponent)))(t||CompactAddToCartComponent)},"CompactAddToCartComponent_Factory")}(),CompactAddToCartComponent.\u0275cmp=core.Xpm({type:CompactAddToCartComponent,selectors:[["cx-epd-visualization-compact-add-to-cart"]],features:[core.qOj],decls:1,vars:1,consts:[[3,"formGroup","submit",4,"ngIf"],[3,"formGroup","submit"],["class","btn btn-sm btn-primary btn-block","type","submit",3,"disabled",4,"ngIf"],["type","submit",1,"btn","btn-sm","btn-primary","btn-block",3,"disabled"],[1,"fa","fa-cart-plus"]],template:__name(function(rf,ctx){1&rf&&core.YNc(0,CompactAddToCartComponent_form_0_Template,2,2,"form",0),2&rf&&core.Q6J("ngIf",ctx.productCode)},"CompactAddToCartComponent_Template"),dependencies:[common.O5,fesm2015_forms._Y,fesm2015_forms.JL,fesm2015_forms.sg,spartacus_storefront.oJW],encapsulation:2,changeDetection:0});class CompactAddToCartModule{}__name(CompactAddToCartModule,"CompactAddToCartModule"),CompactAddToCartModule.\u0275fac=__name(function(t){return new(t||CompactAddToCartModule)},"CompactAddToCartModule_Factory"),CompactAddToCartModule.\u0275mod=core.oAB({type:CompactAddToCartModule}),CompactAddToCartModule.\u0275inj=core.cJS({imports:[common.ez,fesm2015_forms.UX,router.Bz,spartacus_storefront.Fme,spartacus_storefront.k$G,spartacus_core.GSh,spartacus_core.bhT,spartacus_storefront.QX1,spartacus_core.LUR,spartacus_storefront.Td$]});class PagedListComponent{constructor(el){this.el=el,this.itemsPerSlide=10,this.hideIndicators=!1,this.indicatorIcon=spartacus_storefront.e1G.CIRCLE,this.previousIcon=spartacus_storefront.e1G.CARET_LEFT,this.nextIcon=spartacus_storefront.e1G.CARET_RIGHT,this.activeSlideStartIndex=0,this.activeSlideStartIndexChange=new core.vpe}setActiveSlideStartIndex(activeSlideStartIndex){this.activeSlideStartIndex=activeSlideStartIndex,this.activeSlideStartIndexChange.emit(activeSlideStartIndex)}ngOnInit(){this.headerTemplate?this.template||console.error("No template reference provided to render the items for the `cx-epd-visualization-paged-list`"):console.error("No template reference provided to render the header for the `cx-epd-visualization-paged-list`")}}__name(PagedListComponent,"PagedListComponent"),PagedListComponent.\u0275fac=__name(function(t){return new(t||PagedListComponent)(core.Y36(core.SBq))},"PagedListComponent_Factory"),PagedListComponent.\u0275cmp=core.Xpm({type:PagedListComponent,selectors:[["cx-epd-visualization-paged-list"]],inputs:{title:"title",items:"items",headerTemplate:"headerTemplate",template:"template",itemsPerSlide:"itemsPerSlide",hideIndicators:"hideIndicators",indicatorIcon:"indicatorIcon",previousIcon:"previousIcon",nextIcon:"nextIcon",activeSlideStartIndex:"activeSlideStartIndex"},outputs:{activeSlideStartIndexChange:"activeSlideStartIndexChange"},decls:1,vars:1,consts:[[4,"ngIf"],[4,"ngTemplateOutlet"],[1,"list-panel"],[1,"slides"],[4,"ngFor","ngForOf"],["class","indicators",4,"ngIf"],["class","slide",3,"active",4,"ngIf"],[1,"slide"],["class","item",3,"active",4,"ngIf"],[1,"item"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"indicators"],["class","previous",3,"disabled","click",4,"ngIf"],["class","next",3,"disabled","click",4,"ngIf"],[1,"previous",3,"disabled","click"],[3,"type"],["class","slide-indicator",3,"disabled","click",4,"ngIf"],[1,"slide-indicator",3,"disabled","click"],[1,"next",3,"disabled","click"]],template:__name(function(rf,ctx){1&rf&&core.YNc(0,PagedListComponent_ng_container_0_Template,7,4,"ng-container",0),2&rf&&core.Q6J("ngIf",(null==ctx.items?null:ctx.items.length)>0&&ctx.itemsPerSlide)},"PagedListComponent_Template"),dependencies:[common.sg,common.O5,common.tP,spartacus_storefront.oJW,common.OU],encapsulation:2,changeDetection:0});class PagedListModule{}__name(PagedListModule,"PagedListModule"),PagedListModule.\u0275fac=__name(function(t){return new(t||PagedListModule)},"PagedListModule_Factory"),PagedListModule.\u0275mod=core.oAB({type:PagedListModule}),PagedListModule.\u0275inj=core.cJS({imports:[common.ez,router.Bz,spartacus_storefront.QX1,spartacus_storefront.cOq,spartacus_core.bhT]});class VisualPickingProductListService{constructor(currentProductService,productReferenceService,visualPickingProductFilterService,epdVisualizationConfig){this.currentProductService=currentProductService,this.productReferenceService=productReferenceService,this.visualPickingProductFilterService=visualPickingProductFilterService,this.epdVisualizationConfig=epdVisualizationConfig,this.DEFAULT_ITEMS_PER_SLIDE=7,this.currentProduct$=this.currentProductService.getProduct().pipe((0,filter.h)(product=>!!product&&!!product.code),(0,map.U)(product=>product),(0,distinctUntilChanged.x)((p1,p2)=>p1.code===p2.code)),this.productReferences$=new Subject.xQ,this.activeSlideStartIndex=0,this.itemsPerSlide=this.DEFAULT_ITEMS_PER_SLIDE,this.selectedProductCodesChange=new core.vpe,this.filteredItems$=this.getVisualPickingProductListItems(this.getFilteredProductReferences(),this.selectedProductCodesChange).pipe((0,shareReplay.d)())}initialize(){this.getFilteredProductReferencesSubscription=this.getFilteredProductReferences().subscribe(()=>{this.activeSlideStartIndex=0}),this.filteredItemsSubscription=this.filteredItems$.subscribe(items=>{const firstSelectedItemIndex=items.findIndex(item=>item.selected);-1!==firstSelectedItemIndex&&(this.activeSlideStartIndex=firstSelectedItemIndex-firstSelectedItemIndex%this.itemsPerSlide)}),this.selectedProductCodes=[],this.productReferencesSubscription=this._getProductReferences().subscribe(this.productReferences$)}ngOnDestroy(){var _a,_b,_c;null===(_a=this.getFilteredProductReferencesSubscription)||void 0===_a||_a.unsubscribe(),null===(_b=this.filteredItemsSubscription)||void 0===_b||_b.unsubscribe(),null===(_c=this.productReferencesSubscription)||void 0===_c||_c.unsubscribe()}get productReferenceType(){return this.epdVisualizationConfig.epdVisualization.visualPicking.productReferenceType}getProductReferences(){return this.productReferences$}_getProductReferences(){return this.currentProduct$.pipe((0,tap.b)(product=>this.productReferenceService.loadProductReferences(product.code,this.productReferenceType)),(0,switchMap.w)(product=>this.productReferenceService.getProductReferences(product.code,this.productReferenceType)),(0,filter.h)(productReferences=>void 0!==productReferences),(0,distinctUntilChanged.x)((x,y)=>JSON.stringify(x)===JSON.stringify(y)))}getFilteredProductReferences(){return this.visualPickingProductFilterService.getFilteredProducts(this.getProductReferences()).pipe((0,shareReplay.d)())}set selectedProductCodes(selectedProductCodes){this._selectedProductCodes=selectedProductCodes,this.selectedProductCodesChange.next(selectedProductCodes)}get selectedProductCodes(){return this._selectedProductCodes}getVisualPickingProductListItems(productReferences$,selectedProductCodes$){return(0,combineLatest.aj)([productReferences$,selectedProductCodes$]).pipe((0,filter.h)(([productReferences,selectedProductCodes])=>!!productReferences&&!!selectedProductCodes),(0,map.U)(([productReferences,selectedProductCodes])=>productReferences.filter(productReference=>!!productReference.target&&!!productReference.target.code).map(productReference=>{const product=productReference.target,productCode=product.code;return{product,selected:-1!==selectedProductCodes.indexOf(productCode)}})))}}__name(VisualPickingProductListService,"VisualPickingProductListService"),VisualPickingProductListService.\u0275fac=__name(function(t){return new(t||VisualPickingProductListService)(core.LFG(spartacus_storefront.pHG),core.LFG(spartacus_core.FxR),core.LFG(VisualPickingProductFilterService),core.LFG(spartacus_epd_visualization_root._v))},"VisualPickingProductListService_Factory"),VisualPickingProductListService.\u0275prov=core.Yz7({token:VisualPickingProductListService,factory:VisualPickingProductListService.\u0275fac,providedIn:"any"});class VisualPickingProductListComponent{constructor(visualPickingProductListService){this.visualPickingProductListService=visualPickingProductListService,this.singleSelection=!0,this.selectedProductCodesChange=this.visualPickingProductListService.selectedProductCodesChange}set selectedProductCodes(selectedProductCodes){this.visualPickingProductListService.selectedProductCodes=selectedProductCodes}get selectedProductCodes(){return this.visualPickingProductListService.selectedProductCodes}get itemsPerSlide(){return this.visualPickingProductListService.itemsPerSlide}set itemsPerSlide(itemsPerSlide){this.visualPickingProductListService.itemsPerSlide=itemsPerSlide}get activeSlideStartIndex(){return this.visualPickingProductListService.activeSlideStartIndex}set activeSlideStartIndex(activeSlideStartIndex){this.visualPickingProductListService.activeSlideStartIndex=activeSlideStartIndex}get filteredItems$(){return this.visualPickingProductListService.filteredItems$}ngOnInit(){this.visualPickingProductListService.initialize()}}__name(VisualPickingProductListComponent,"VisualPickingProductListComponent"),VisualPickingProductListComponent.\u0275fac=__name(function(t){return new(t||VisualPickingProductListComponent)(core.Y36(VisualPickingProductListService))},"VisualPickingProductListComponent_Factory"),VisualPickingProductListComponent.\u0275cmp=core.Xpm({type:VisualPickingProductListComponent,selectors:[["cx-epd-visualization-product-list"]],inputs:{title:"title",singleSelection:"singleSelection",selectedProductCodes:"selectedProductCodes"},outputs:{selectedProductCodesChange:"selectedProductCodesChange"},features:[core._Bn([VisualPickingProductListService])],decls:6,vars:8,consts:[[3,"items","title","headerTemplate","template","itemsPerSlide","activeSlideStartIndex","activeSlideStartIndexChange"],["headerTemplate",""],["itemTemplate",""],[1,"cx-item-list-header","row"],[1,"cx-item-list-desc","col-6"],[1,"cx-item-list-price","col-4"],[1,"cx-item-list-total","col-2"],["class","row no-gutters list-item","tabindex","0",3,"selected","click","keydown.enter","keydown.space",4,"ngIf"],["tabindex","0",1,"row","no-gutters","list-item",3,"click","keydown.enter","keydown.space"],[1,"col-6","flex-row"],[1,"thumbnail-container"],[1,"thumbnail"],["format","thumbnail",3,"container"],[1,"flex-column"],["class","cx-name",4,"ngIf"],["class","cx-code",4,"ngIf"],[1,"col-4","flex-column"],["class","cx-price",4,"ngIf"],[1,"cx-add-to-cart","col-2","flex-column"],[4,"ngIf"],[1,"cx-name"],[1,"cx-link",3,"routerLink","keydown.enter"],[1,"cx-code"],[1,"cx-price"],[3,"click","keydown.enter","keydown.space"],[3,"showQuantity","product"],["addToCartComponent",""],["noPrice",""],[1,"cx-out-of-stock"]],template:__name(function(rf,ctx){if(1&rf&&(core.TgZ(0,"cx-epd-visualization-paged-list",0),core.NdJ("activeSlideStartIndexChange",__name(function($event){return ctx.activeSlideStartIndex=$event},"VisualPickingProductListComponent_Template_cx_epd_visualization_paged_list_activeSlideStartIndexChange_0_listener")),core.ALo(1,"async"),core.qZA(),core.YNc(2,VisualPickingProductListComponent_ng_template_2_Template,8,6,"ng-template",null,1,core.W1O),core.YNc(4,VisualPickingProductListComponent_ng_template_4_Template,1,1,"ng-template",null,2,core.W1O)),2&rf){const _r0=core.MAs(3),_r2=core.MAs(5);core.Q6J("items",core.lcZ(1,6,ctx.filteredItems$))("title",ctx.title)("headerTemplate",_r0)("template",_r2)("itemsPerSlide",ctx.itemsPerSlide)("activeSlideStartIndex",ctx.activeSlideStartIndex)}},"VisualPickingProductListComponent_Template"),dependencies:[common.O5,router.yS,spartacus_storefront.R7z,PagedListComponent,CompactAddToCartComponent,common.Ov,spartacus_core.l2T,spartacus_core.X$D],encapsulation:2,changeDetection:0});class VisualPickingProductListModule{}__name(VisualPickingProductListModule,"VisualPickingProductListModule"),VisualPickingProductListModule.\u0275fac=__name(function(t){return new(t||VisualPickingProductListModule)},"VisualPickingProductListModule_Factory"),VisualPickingProductListModule.\u0275mod=core.oAB({type:VisualPickingProductListModule}),VisualPickingProductListModule.\u0275inj=core.cJS({imports:[common.ez,router.Bz,spartacus_storefront.Sk1,spartacus_storefront.cOq,spartacus_storefront.QX1,spartacus_storefront.bBg,PagedListModule,spartacus_core.bhT,spartacus_core.LUR,CompactAddToCartModule]});class VisualPickingTabService{constructor(currentProductService,globalMessageService,changeDetectorRef,windowRef){this.currentProductService=currentProductService,this.globalMessageService=globalMessageService,this.changeDetectorRef=changeDetectorRef,this.windowRef=windowRef,this.showErrorMessages=!0}initialize(visualViewerService,visualPickingProductListService){!this.windowRef.isBrowser()||(this.visualViewerService=visualViewerService,this.visualPickingProductListService=visualPickingProductListService,this.visualizationLoadInfoChangeSubscription=this.visualViewerService.visualizationLoadInfoChange.subscribe(this.handleLoadVisualizationInfoChange.bind(this)),this.getFilteredProductReferencesSubscription=this.visualPickingProductListService.getFilteredProductReferences().subscribe(productReferences=>{const productCodes=productReferences.map(productReference=>productReference.target.code);this.visualViewerService.includedProductCodes=productCodes}),this.getProductReferencesSubscription=this.visualPickingProductListService.getProductReferences().subscribe(productReferences=>{this.setProductReferences(productReferences),productReferences.length>0&&this.visualPickingProductListService.currentProduct$.pipe((0,first.P)()).subscribe(currentProduct=>{this.visualViewerService.loadVisualization(currentProduct.code).pipe((0,first.P)()).subscribe()})}))}ngOnDestroy(){var _a,_b,_c;!this.windowRef.isBrowser()||(null===(_a=this.visualizationLoadInfoChangeSubscription)||void 0===_a||_a.unsubscribe(),null===(_b=this.getProductReferencesSubscription)||void 0===_b||_b.unsubscribe(),null===(_c=this.getFilteredProductReferencesSubscription)||void 0===_c||_c.unsubscribe())}get productReferences(){return this._productReferences}setProductReferences(value){this._productReferences=value,this.changeDetectorRef.markForCheck()}get visualizationLoadStatus(){var _a,_b;return null!==(_b=null===(_a=this.visualViewerService.visualizationLoadInfo)||void 0===_a?void 0:_a.loadStatus)&&void 0!==_b?_b:VisualizationLoadStatus.NotStarted}get hideNoProductReferencesText(){return!this.windowRef.isBrowser()||(void 0===this.productReferences||this.productReferences.length>0)}get hideProductList(){return!this.windowRef.isBrowser()||(void 0===this.productReferences||0===this.productReferences.length)}get hideViewport(){return!this.windowRef.isBrowser()||(void 0===this.productReferences||0===this.productReferences.length||!(this.visualizationLoadStatus===VisualizationLoadStatus.Loading||this.visualizationLoadStatus===VisualizationLoadStatus.Loaded))}showErrorMessage(message){this.showErrorMessages&&this.globalMessageService.add(message,spartacus_core.xUg.MSG_TYPE_ERROR)}handleLoadVisualizationInfoChange(visualizationLoadInfo){switch(visualizationLoadInfo.lookupResult){case VisualizationLookupResult.UniqueMatchFound:switch(visualizationLoadInfo.loadStatus){case VisualizationLoadStatus.Loading:break;case VisualizationLoadStatus.UnexpectedError:this.showErrorMessage({key:"epdVisualization.errors.visualLoad.unexpectedLoadError"})}break;case VisualizationLookupResult.NoMatchFound:break;case VisualizationLookupResult.MultipleMatchesFound:this.showErrorMessage({key:"epdVisualization.errors.visualLoad.multipleMatchingVisualsFound"});break;case VisualizationLookupResult.UnexpectedError:this.showErrorMessage({key:"epdVisualization.errors.visualLoad.unexpectedLoadError"})}this.changeDetectorRef.detectChanges()}get visualViewerService(){return this._visualViewerService}set visualViewerService(value){!this.windowRef.isBrowser()||(this._visualViewerService=value)}get visualPickingProductListService(){return this._visualPickingProductListService}set visualPickingProductListService(value){!this.windowRef.isBrowser()||(this._visualPickingProductListService=value)}}__name(VisualPickingTabService,"VisualPickingTabService"),VisualPickingTabService.\u0275fac=__name(function(t){return new(t||VisualPickingTabService)(core.LFG(spartacus_storefront.pHG),core.LFG(spartacus_core.IWp),core.LFG(core.sBO),core.LFG(spartacus_core.X9E))},"VisualPickingTabService_Factory"),VisualPickingTabService.\u0275prov=core.Yz7({token:VisualPickingTabService,factory:VisualPickingTabService.\u0275fac,providedIn:"any"});class VisualPickingTabComponent{constructor(visualPickingTabService){this.visualPickingTabService=visualPickingTabService,this.selectedProductCodes=[]}ngAfterViewInit(){this.visualPickingTabService.initialize(this.visualViewerService,this.visualPickingProductListService)}get hideNoProductReferencesIndicator(){return this.visualPickingTabService.hideNoProductReferencesText}get hideProductList(){return this.visualPickingTabService.hideProductList}get hideViewport(){return this.visualPickingTabService.hideViewport}}__name(VisualPickingTabComponent,"VisualPickingTabComponent"),VisualPickingTabComponent.\u0275fac=__name(function(t){return new(t||VisualPickingTabComponent)(core.Y36(VisualPickingTabService))},"VisualPickingTabComponent_Factory"),VisualPickingTabComponent.\u0275cmp=core.Xpm({type:VisualPickingTabComponent,selectors:[["cx-epd-visualization-visual-picking-tab"]],viewQuery:__name(function(rf,ctx){if(1&rf&&(core.Gf(VisualViewerComponent,5,VisualViewerService),core.Gf(VisualPickingProductListComponent,5,VisualPickingProductListService)),2&rf){let _t;core.iGM(_t=core.CRH())&&(ctx.visualViewerService=_t.first),core.iGM(_t=core.CRH())&&(ctx.visualPickingProductListService=_t.first)}},"VisualPickingTabComponent_Query"),features:[core._Bn([VisualPickingTabService])],decls:9,vars:14,consts:[[1,"no-product-references",3,"hidden"],[3,"selectedProductCodes","hidden","selectedProductCodesChange"],[1,"visual-picking-product-list-container",3,"hidden"],[3,"selectedProductCodes","selectedProductCodesChange"]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div")(1,"div",0)(2,"span"),core._uU(3),core.ALo(4,"cxTranslate"),core.qZA()(),core.TgZ(5,"cx-epd-visualization-viewer",1),core.NdJ("selectedProductCodesChange",__name(function($event){return ctx.selectedProductCodes=$event},"VisualPickingTabComponent_Template_cx_epd_visualization_viewer_selectedProductCodesChange_5_listener")),core.qZA(),core.TgZ(6,"div",2),core._UZ(7,"cx-epd-visualization-product-filter"),core.TgZ(8,"cx-epd-visualization-product-list",3),core.NdJ("selectedProductCodesChange",__name(function($event){return ctx.selectedProductCodes=$event},"VisualPickingTabComponent_Template_cx_epd_visualization_product_list_selectedProductCodesChange_8_listener")),core.qZA()()()),2&rf&&(core.ekj("container-fluid",!ctx.hideViewport)("container",ctx.hideViewport),core.xp6(1),core.Q6J("hidden",ctx.hideNoProductReferencesIndicator),core.xp6(2),core.Oqu(core.lcZ(4,12,"epdVisualization.visualPicking.visualPickingTab.noProductReferences")),core.xp6(2),core.Q6J("selectedProductCodes",ctx.selectedProductCodes)("hidden",ctx.hideViewport),core.xp6(1),core.ekj("viewportHidden",ctx.hideViewport),core.Q6J("hidden",ctx.hideProductList),core.xp6(2),core.Q6J("selectedProductCodes",ctx.selectedProductCodes))},"VisualPickingTabComponent_Template"),dependencies:[VisualViewerComponent,VisualPickingProductListComponent,VisualPickingProductFilterComponent,spartacus_core.X$D],encapsulation:2,changeDetection:0});class VisualPickingTabModule{}__name(VisualPickingTabModule,"VisualPickingTabModule"),VisualPickingTabModule.\u0275fac=__name(function(t){return new(t||VisualPickingTabModule)},"VisualPickingTabModule_Factory"),VisualPickingTabModule.\u0275mod=core.oAB({type:VisualPickingTabModule}),VisualPickingTabModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{VisualPickingTabComponent:{component:VisualPickingTabComponent}}})],imports:[common.ez,router.Bz,spartacus_core.LUR,VisualViewerModule,VisualPickingProductListModule,VisualPickingProductFilterModule]});class EpdVisualizationComponentsModule{}__name(EpdVisualizationComponentsModule,"EpdVisualizationComponentsModule"),EpdVisualizationComponentsModule.\u0275fac=__name(function(t){return new(t||EpdVisualizationComponentsModule)},"EpdVisualizationComponentsModule_Factory"),EpdVisualizationComponentsModule.\u0275mod=core.oAB({type:EpdVisualizationComponentsModule}),EpdVisualizationComponentsModule.\u0275inj=core.cJS({imports:[VisualPickingTabModule,VisualViewerModule]});var throwError=__webpack_require__(1737),http=__webpack_require__(520);class StorageV1Adapter{constructor(http2,epdVisualizationConfig,converter){this.http=http2,this.epdVisualizationConfig=epdVisualizationConfig,this.converter=converter,this.baseUrl=this.getBaseUrl()}getBaseUrl(){return`${this.epdVisualizationConfig.epdVisualization.apis.baseUrl}/vis/public/storage`}getUrl(sceneId,nodeIds,$expand,$filter,contentType){const queryParts=[];nodeIds&&nodeIds.forEach(nodeId=>queryParts.push(`id=${nodeId}`)),$expand&&queryParts.push(`$expand=${$expand.join(",")}`),$filter&&queryParts.push(`$filter=${$filter.join(",")}`),contentType&&queryParts.push(`contentType=${contentType}`);const queryString=queryParts.length?`?${queryParts.join("&")}`:"";return`${this.baseUrl}/v1/scenes/${sceneId}/nodes${queryString}`}getNodes(sceneId,nodeIds,$expand,$filter,contentType){return this.http.get(this.getUrl(sceneId,nodeIds,$expand,$filter,contentType)).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error))),this.converter.pipeable(NODES_RESPONSE_NORMALIZER))}}__name(StorageV1Adapter,"StorageV1Adapter"),StorageV1Adapter.\u0275fac=__name(function(t){return new(t||StorageV1Adapter)(core.LFG(http.eN),core.LFG(spartacus_epd_visualization_root._v),core.LFG(spartacus_core.IXI))},"StorageV1Adapter_Factory"),StorageV1Adapter.\u0275prov=core.Yz7({token:StorageV1Adapter,factory:StorageV1Adapter.\u0275fac});class VisualizationV1Adapter{constructor(http2,epdVisualizationConfig,converter){this.http=http2,this.epdVisualizationConfig=epdVisualizationConfig,this.converter=converter,this.baseUrl=this.getBaseUrl()}getBaseUrl(){return`${this.epdVisualizationConfig.epdVisualization.apis.baseUrl}/vis/public/visualization`}getUrl(visualizationUsageId,folderUsageId){const queryParts=[`usage=${encodeURIComponent(JSON.stringify(visualizationUsageId))}`,`folderUsageId=${encodeURIComponent(JSON.stringify(folderUsageId))}`];return`${this.baseUrl}/v1/lookup/visualization?${queryParts.join("&")}`}lookupVisualization(visualizationUsageId,folderUsageId){return this.http.get(this.getUrl(visualizationUsageId,folderUsageId)).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error))),this.converter.pipeable(LOOKUP_VISUALIZATIONS_RESPONSE_NORMALIZER))}}__name(VisualizationV1Adapter,"VisualizationV1Adapter"),VisualizationV1Adapter.\u0275fac=__name(function(t){return new(t||VisualizationV1Adapter)(core.LFG(http.eN),core.LFG(spartacus_epd_visualization_root._v),core.LFG(spartacus_core.IXI))},"VisualizationV1Adapter_Factory"),VisualizationV1Adapter.\u0275prov=core.Yz7({token:VisualizationV1Adapter,factory:VisualizationV1Adapter.\u0275fac});class EpdVisualizationApiModule{}__name(EpdVisualizationApiModule,"EpdVisualizationApiModule"),EpdVisualizationApiModule.\u0275fac=__name(function(t){return new(t||EpdVisualizationApiModule)},"EpdVisualizationApiModule_Factory"),EpdVisualizationApiModule.\u0275mod=core.oAB({type:EpdVisualizationApiModule}),EpdVisualizationApiModule.\u0275inj=core.cJS({providers:[{provide:SceneAdapter,useClass:StorageV1Adapter},{provide:VisualizationAdapter,useClass:VisualizationV1Adapter}]});class EpdVisualizationModule{}__name(EpdVisualizationModule,"EpdVisualizationModule"),EpdVisualizationModule.\u0275fac=__name(function(t){return new(t||EpdVisualizationModule)},"EpdVisualizationModule_Factory"),EpdVisualizationModule.\u0275mod=core.oAB({type:EpdVisualizationModule}),EpdVisualizationModule.\u0275inj=core.cJS({imports:[EpdVisualizationComponentsModule,EpdVisualizationCoreModule,EpdVisualizationApiModule]})}};