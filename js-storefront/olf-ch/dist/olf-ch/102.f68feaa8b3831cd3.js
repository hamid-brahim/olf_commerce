"use strict";(self.webpackChunkolf_ch=self.webpackChunkolf_ch||[]).push([[102],{9102:(A,y,d)=>{d.r(y),d.d(y,{CartBaseModule:()=>$});var n=d(4650),I=d(4372),m=d(4334),p=d(3749),s=d(3983),u=d(529),h=d(1737),P=d(7221),C=d(373),E=d(4850),V=d(6895);let O=(()=>{class r{constructor(t){this.converter=t}convert(t,e){return void 0===e&&(e={...t}),this.removeDuplicatePromotions(t,e),t.entries&&(e.entries=t.entries.map(o=>({...o,product:this.converter.convert(o.product,s.jrf),promotions:this.converter.convert({item:o,promotions:e?.appliedProductPromotions},p.Cx)}))),e}removeDuplicatePromotions(t,e){t&&t.potentialOrderPromotions&&(e.potentialOrderPromotions=this.removeDuplicateItems(t.potentialOrderPromotions)),t&&t.potentialProductPromotions&&(e.potentialProductPromotions=this.removeDuplicateItems(t.potentialProductPromotions)),t&&t.appliedOrderPromotions&&(e.appliedOrderPromotions=this.removeDuplicateItems(t.appliedOrderPromotions)),t&&t.appliedProductPromotions&&(e.appliedProductPromotions=this.removeDuplicateItems(t.appliedProductPromotions))}removeDuplicateItems(t){return t.filter((e,o,a)=>o===a.map(l=>JSON.stringify(l)).indexOf(JSON.stringify(e)))}}return r.\u0275fac=function(t){return new(t||r)(n.LFG(s.IXI))},r.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),D=(()=>{class r{convert(t,e){return this.getProductPromotion(t.item,t.promotions)}getProductPromotion(t,e){const o=[];if(e&&e.length>0)for(const a of e)if(a.description&&a.consumedEntries&&a.consumedEntries.length>0)for(const i of a.consumedEntries)this.isConsumedByEntry(i,t)&&o.push(a);return o}isConsumedByEntry(t,e){const o=t.orderEntryNumber;if(e&&e.entries&&e.entries.length>0){for(const a of e.entries)if(a.entryNumber===o)return!0;return!1}return o===e?.entryNumber}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),F=(()=>{class r{constructor(t,e,o){this.http=t,this.occEndpointsService=e,this.converterService=o}add(t,e,o,a=1){const i=this.occEndpointsService.buildUrl("addEntries",{urlParams:{userId:t,cartId:e,quantity:a}});if(i.includes(`quantity=${a}`)){const f=new u.WM({"Content-Type":"application/x-www-form-urlencoded"});return this.http.post(i,{},{headers:f,params:{code:o}}).pipe(this.converterService.pipeable(p.Ke))}const l={quantity:a,product:{code:o}},v=new u.WM({"Content-Type":"application/json"});return this.http.post(i,l,{headers:v}).pipe(this.converterService.pipeable(p.Ke))}update(t,e,o,a,i){let l={};i&&(l={deliveryPointOfService:{name:i}});const v=new u.WM({"Content-Type":"application/json"}),f=this.occEndpointsService.buildUrl("updateEntries",{urlParams:{userId:t,cartId:e,entryNumber:o}});return this.http.patch(f,{quantity:a,...l},{headers:v}).pipe(this.converterService.pipeable(p.Ke))}remove(t,e,o){const a=new u.WM({"Content-Type":"application/x-www-form-urlencoded"}),i=this.occEndpointsService.buildUrl("removeEntries",{urlParams:{userId:t,cartId:e,entryNumber:o}});return this.http.delete(i,{headers:a})}}return r.\u0275fac=function(t){return new(t||r)(n.LFG(u.eN),n.LFG(s.Lz0),n.LFG(s.IXI))},r.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac}),r})(),L=(()=>{class r{constructor(t,e,o){this.http=t,this.occEndpoints=e,this.converter=o}getCartVoucherEndpoint(t,e){return this.occEndpoints.buildUrl("cartVoucher",{urlParams:{userId:t,cartId:e}})}getHeaders(t){let e=new u.WM({"Content-Type":"application/json"});return t===s.Fds&&(e=s.Fox.createHeader(s._Re,!0,e)),e}add(t,e,o){const a=this.getCartVoucherEndpoint(t,e),i=JSON.stringify({}),l=(new u.LE).set("voucherId",o),v=this.getHeaders(t);return this.http.post(a,i,{headers:v,params:l}).pipe((0,P.K)(f=>(0,h._)(f)),this.converter.pipeable(p.ij))}remove(t,e,o){const a=this.getCartVoucherEndpoint(t,e)+"/"+encodeURIComponent(o),i=this.getHeaders(t);return this.http.delete(a,{headers:i}).pipe((0,P.K)(l=>(0,h._)(l)))}}return r.\u0275fac=function(t){return new(t||r)(n.LFG(u.eN),n.LFG(s.Lz0),n.LFG(s.IXI))},r.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac}),r})(),b=(()=>{class r{constructor(t,e,o){this.http=t,this.occEndpointsService=e,this.converterService=o}loadAll(t){return this.http.get(this.occEndpointsService.buildUrl("carts",{urlParams:{userId:t}})).pipe((0,C.j)("carts"),(0,E.U)(e=>e??[]),this.converterService.pipeableMany(p.jK))}load(t,e){return e===s.gSv?this.loadAll(t).pipe((0,E.U)(o=>o.find(a=>void 0===a.saveTime))):this.http.get(this.occEndpointsService.buildUrl("cart",{urlParams:{userId:t,cartId:e}})).pipe(this.converterService.pipeable(p.jK))}create(t,e,o){const a=JSON.stringify({}),i={};return e&&(i.oldCartId=e),o&&(i.toMergeCartGuid=o),this.http.post(this.occEndpointsService.buildUrl("createCart",{urlParams:{userId:t},queryParams:i}),a).pipe(this.converterService.pipeable(p.jK))}delete(t,e){let o=new u.WM;return t===s.Fds&&(o=s.Fox.createHeader(s._Re,!0,o)),this.http.delete(this.occEndpointsService.buildUrl("deleteCart",{urlParams:{userId:t,cartId:e}}),{headers:o})}save(t,e,o,a){const i=this.occEndpointsService.buildUrl("saveCart",{urlParams:{userId:t,cartId:e,saveCartName:o,saveCartDescription:a}});return this.http.patch(i,e).pipe((0,C.j)("savedCartData"),this.converterService.pipeable(p.jK))}addEmail(t,e,o){let a=new u.WM({"Content-Type":"application/x-www-form-urlencoded"});a=s.Fox.createHeader(s._Re,!0,a);const i=(new u.LE).set("email",o),l=this.occEndpointsService.buildUrl("addEmail",{urlParams:{userId:t,cartId:e}});return this.http.put(l,i,{headers:a})}}return r.\u0275fac=function(t){return new(t||r)(n.LFG(u.eN),n.LFG(s.Lz0),n.LFG(s.IXI))},r.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac}),r})(),g=(()=>{class r{constructor(t,e,o){this.http=t,this.occEndpoints=e,this.converter=o}validate(t,e){const o=this.occEndpoints.buildUrl("validate",{urlParams:{cartId:t,userId:e}});return this.http.post(o,null).pipe((0,P.K)(a=>(0,h._)((0,s.cxH)(a))),this.converter.pipeable(m.YA))}}return r.\u0275fac=function(t){return new(t||r)(n.LFG(u.eN),n.LFG(s.Lz0),n.LFG(s.IXI))},r.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac}),r})();const M={backend:{occ:{endpoints:{carts:"users/${userId}/carts?fields=carts(DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user,saveTime,name,description)",cart:"users/${userId}/carts/${cartId}?fields=DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user,saveTime,name,description",createCart:"users/${userId}/carts?fields=DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user",addEntries:"users/${userId}/carts/${cartId}/entries",updateEntries:"users/${userId}/carts/${cartId}/entries/${entryNumber}",removeEntries:"users/${userId}/carts/${cartId}/entries/${entryNumber}",addEmail:"users/${userId}/carts/${cartId}/email",deleteCart:"users/${userId}/carts/${cartId}",cartVoucher:"users/${userId}/carts/${cartId}/vouchers",saveCart:"/users/${userId}/carts/${cartId}/save?saveCartName=${saveCartName}&saveCartDescription=${saveCartDescription}",validate:"users/${userId}/carts/${cartId}/validate?fields=DEFAULT"}}}};let S=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=n.oAB({type:r}),r.\u0275inj=n.cJS({providers:[(0,s.i51)(M),{provide:m.YW,useClass:b},{provide:p.jK,useExisting:O,multi:!0},{provide:p.Cx,useExisting:D,multi:!0},{provide:m.vI,useClass:F},{provide:m.Eu,useClass:L},{provide:m.n5,useClass:g}],imports:[V.ez]}),r})(),$=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=n.oAB({type:r}),r.\u0275inj=n.cJS({imports:[m.Jp,S,I.kh]}),r})()}}]);