"use strict";(self.webpackChunkolf=self.webpackChunkolf||[]).push([[464],{8464:(He,A,a)=>{a.r(A),a.d(A,{QuickOrderModule:()=>Ke});var e=a(4650),d=a(4006),p=a(3749),s=a(6322),x=a(2654),M=a(6787),k=a(1086),I=a(6053),g=a(591),f=a(4850),y=a(7224),T=a(7545),q=a(2198),b=a(2994),P=a(7221),J=a(9146),C=a(2986),$=a(5778),N=a(13),m=a(6895),_=a(4777),h=a(8581),v=a(610),D=a(8929),R=a(8723);let F=(()=>{class n{constructor(t,r,i,o){this.activeCartService=t,this.config=r,this.eventService=i,this.productSearchConnector=o,this.productAdded$=new D.xQ,this.entries$=new g.X([]),this.softDeletedEntries$=new g.X({}),this.nonPurchasableProductError$=new g.X(null),this.hardDeleteTimeout=this.config.quickOrder?.list?.hardDeleteTimeout||7e3,this.quickOrderListLimit=0,this.clearDeleteTimeouts={}}ngOnDestroy(){this.clearDeletedEntries()}getEntries(){return this.entries$}searchProducts(t,r){return this.productSearchConnector?this.productSearchConnector.search(t,{pageSize:r||h.Jb.quickOrder?.searchForm?.maxProducts}).pipe((0,f.U)(o=>o.products||[])):(0,k.of)([])}clearList(){this.entries$.next([])}canAdd(t){return(0,k.of)(t&&this.isProductOnTheList(t)||!this.isLimitExceeded())}setListLimit(t){this.quickOrderListLimit=t}loadEntries(t=[]){this.entries$.next(t)}updateEntryQuantity(t,r){const i=this.entries$.getValue()||[];i[t].quantity=r,this.entries$.next(i)}softDeleteEntry(t){this.entries$.pipe((0,C.q)(1)).subscribe(r=>{const i=r;this.addSoftEntryDeletion(i[t],!0),i.splice(t,1),this.entries$.next(i)})}addProduct(t,r=1){const i=this.generateOrderEntry(t,r);this.addEntry(i)}getProductAdded(){return this.productAdded$}setProductAdded(t){this.productAdded$.next(t)}addToCart(){let t=[];const r=[],i=this.eventService.get(p.VD).subscribe(o=>{(0===o.quantityAdded||o.quantityAdded&&o.quantityAdded<o.quantity)&&r.push(this.createQuickOrderResultEvent(o))});return i.add(this.eventService.get(p.K$).subscribe(o=>{r.push(this.createQuickOrderResultEvent(o))})),this.getEntries().pipe((0,y.P)(),(0,T.w)(o=>(t=o,this.activeCartService.addEntries(o),this.clearList(),this.activeCartService.isStable())),(0,q.h)(o=>o),(0,f.U)(()=>[t,r]),(0,b.b)(()=>i.unsubscribe()))}getSoftDeletedEntries(){return this.softDeletedEntries$}restoreSoftDeletedEntry(t){const r=this.getSoftDeletedEntry(t);this.addEntry(r),this.hardDeleteEntry(t)}hardDeleteEntry(t){const r=this.getSoftDeletedEntry(t),i=this.softDeletedEntries$.getValue();r&&(delete i[t],this.softDeletedEntries$.next(i)),this.clearDeleteTimeout(t)}clearDeletedEntries(){Object.values(this.clearDeleteTimeouts).forEach(t=>t.unsubscribe()),this.softDeletedEntries$.next({}),this.clearDeleteTimeouts={}}getNonPurchasableProductError(){return this.nonPurchasableProductError$}setNonPurchasableProductError(t){this.nonPurchasableProductError$.next(t)}clearNonPurchasableProductError(){this.nonPurchasableProductError$.next(null)}addSoftEntryDeletion(t,r=!0){const i=this.softDeletedEntries$.getValue(),o=t?.product?.code;if(o&&(i[o]=t,this.softDeletedEntries$.next(i),r)){const u=(0,R.H)(this.hardDeleteTimeout).subscribe(()=>{this.hardDeleteEntry(o)});this.clearDeleteTimeouts[o]=u}}getSoftDeletedEntry(t){return this.softDeletedEntries$.getValue()[t]}generateOrderEntry(t,r){return{basePrice:t.price,product:t,quantity:r,totalPrice:t.price}}addEntry(t){if(t?.product?.code&&!this.isProductOnTheList(t.product.code)&&this.isLimitExceeded())return;const r=this.entries$.getValue()||[],i=t.product?.stock?.stockLevel;if(i&&t.quantity&&t.quantity>i&&(t.quantity=i),t.product?.code&&this.isProductOnTheList(t.product.code)){const o=r.findIndex(l=>l.product?.code===t.product?.code),u=r[o].quantity;if(u&&t.quantity){r[o].quantity=u+t?.quantity;const l=r[o].quantity;l&&i&&l>i&&(r[o].quantity=i),this.entries$.next([...r])}}else this.entries$.next([...r,t]);this.productAdded$.next(t.product?.code)}isProductOnTheList(t){return!!(this.entries$.getValue()||[]).find(i=>i.product?.code===t)}isLimitExceeded(){return(this.entries$.getValue()||[]).length>=this.quickOrderListLimit}createQuickOrderResultEvent(t){const r={productCode:t.productCode,quantity:t.quantity};if("entry"in t&&(r.entry=t.entry),"quantityAdded"in t&&(r.quantityAdded=t.quantityAdded),"error"in t&&t.error instanceof s.YPQ&&(r.error=t.error),r.error?.details?.length){const i=r.error?.details.some(o=>"InsufficientStockError"===o.type);r.quantityAdded=i?0:r.quantity}return r}clearDeleteTimeout(t){const r=this.clearDeleteTimeouts[t];r&&(r.unsubscribe(),delete this.clearDeleteTimeouts[t])}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(p.bu),e.LFG(s.DeH),e.LFG(s.POd),e.LFG(s.tyF))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();const Y=[F,{provide:h.be,useExisting:F}];let Z=(()=>{class n{constructor(t,r,i){this.quickOrderService=t,this.siteContextParamsService=r,this.statePersistenceService=i,this.subscription=new x.w,this.key="quick-order"}initSync(){this.subscription.add(this.statePersistenceService.syncWithStorage({key:this.key,state$:this.quickOrderService.getEntries(),context$:this.siteContextParamsService.getValues([s.iEg]),storageType:s.iHd.SESSION_STORAGE,onRead:t=>this.onRead(t)}))}onRead(t){t&&this.quickOrderService.loadEntries(t)}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(h.be),e.LFG(s.Qnj),e.LFG(s.WBb))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),U=(()=>{class n{static forRoot(){return{ngModule:n}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[...Y,Z]}),n})();function G(n,c){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",1),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA(),e.TgZ(4,"div",2)(5,"form",3),e.NdJ("ngSubmit",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.applyQuickOrder())}),e.TgZ(6,"div",4)(7,"span",5)(8,"label",6),e._uU(9),e.ALo(10,"cxTranslate"),e.qZA(),e._UZ(11,"input",7),e.ALo(12,"cxTranslate"),e.ALo(13,"cxTranslate"),e.qZA(),e.TgZ(14,"span",8)(15,"label",6),e._uU(16),e.ALo(17,"cxTranslate"),e.qZA(),e._UZ(18,"input",9),e.ALo(19,"cxTranslate"),e.qZA(),e.TgZ(20,"button",10),e.ALo(21,"async"),e.ALo(22,"cxTranslate"),e.ALo(23,"async"),e._uU(24),e.ALo(25,"cxTranslate"),e.qZA(),e._UZ(26,"cx-form-errors",11)(27,"cx-form-errors",11),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,14,"quickOrderCartForm.title")," "),e.xp6(3),e.Q6J("formGroup",t.quickOrderForm),e.xp6(4),e.hij(" ",e.lcZ(10,16,"quickOrderCartForm.productCodeLabel")," "),e.xp6(2),e.s9C("placeholder",e.lcZ(13,20,"quickOrderCartForm.productCodePlaceholder")),e.uIk("aria-label",e.lcZ(12,18,"quickOrderCartForm.entryProductCode")),e.xp6(5),e.hij(" ",e.lcZ(17,22,"quickOrderCartForm.quantityLabel")," "),e.xp6(2),e.uIk("aria-label",e.lcZ(19,24,"quickOrderCartForm.quantity")),e.xp6(2),e.ekj("disabled",e.lcZ(21,26,t.cartIsLoading$)),e.Q6J("disabled",e.lcZ(23,30,t.cartIsLoading$)),e.uIk("aria-label",e.lcZ(22,28,"quickOrderCartForm.addToCart")),e.xp6(4),e.hij(" ",e.lcZ(25,32,"quickOrderCartForm.add")," "),e.xp6(2),e.Q6J("control",t.quickOrderForm.get("productCode")),e.xp6(1),e.Q6J("control",t.quickOrderForm.get("quantity"))}}const Q=function(n){return{limit:n}};function K(n,c){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",7),e.NdJ("blur",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.onBlur(i))})("focus",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.open())})("keydown.arrowdown",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.focusNextChild(i))})("keydown.arrowup",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.focusPreviousChild(i))})("keydown.enter",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.addProduct(i))})("keydown.escape",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.clear(i))}),e.ALo(2,"cxTranslate"),e.ALo(3,"cxTranslate"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.s9C("placeholder",e.lcZ(3,5,"quickOrderForm.placeholder")),e.uIk("aria-label",e.xi3(2,2,"quickOrderForm.searchBoxLabel",e.VKq(7,Q,t.limit)))}}function B(n,c){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",8),e.NdJ("blur",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.onBlur(i))})("focus",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.open())})("keydown.arrowdown",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.focusNextChild(i))})("keydown.arrowup",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.focusPreviousChild(i))})("keydown.enter",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.addProduct(i))})("keydown.escape",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.clear(i))}),e.ALo(2,"cxTranslate"),e.ALo(3,"cxTranslate"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.s9C("placeholder",e.lcZ(3,5,"quickOrderForm.placeholder")),e.uIk("aria-label",e.xi3(2,2,"quickOrderForm.searchBoxLabel",e.VKq(7,Q,t.limit)))}}function H(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.clear(i))})("keydown.enter",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.clear(i))}),e.ALo(1,"cxTranslate"),e._UZ(2,"cx-icon",10),e.qZA()}if(2&n){const t=e.oxw();e.uIk("aria-label",e.lcZ(1,2,"common.reset")),e.xp6(2),e.Q6J("type",t.iconTypes.RESET)}}function j(n,c){if(1&n&&(e.TgZ(0,"button",11),e.ALo(1,"cxTranslate"),e._UZ(2,"cx-icon",10),e.qZA()),2&n){const t=e.oxw();e.uIk("aria-label",e.lcZ(1,2,"common.search")),e.xp6(2),e.Q6J("type",t.iconTypes.SEARCH)}}function V(n,c){1&n&&(e.TgZ(0,"span",12),e._uU(1),e.ALo(2,"cxTranslate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"quickOrderForm.listLimitReached")," "))}function W(n,c){if(1&n&&e._UZ(0,"cx-media",25),2&n){const t=e.oxw().$implicit;e.Q6J("alt",t.name)("container",null==t.images?null:t.images.PRIMARY)}}const L=function(n){return{id:n}};function X(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"li",19)(1,"button",20),e.NdJ("blur",function(i){e.CHM(t);const o=e.oxw(4);return e.KtG(o.onBlur(i))})("click",function(i){const u=e.CHM(t).$implicit,l=e.oxw(4);return e.KtG(l.add(u,i))})("keydown.arrowdown",function(i){e.CHM(t);const o=e.oxw(4);return e.KtG(o.focusNextChild(i))})("keydown.arrowup",function(i){e.CHM(t);const o=e.oxw(4);return e.KtG(o.focusPreviousChild(i))})("keydown.enter",function(i){const u=e.CHM(t).$implicit,l=e.oxw(4);return e.KtG(l.add(u,i))})("keydown.escape",function(i){e.CHM(t);const o=e.oxw(4);return e.KtG(o.clear(i))}),e.YNc(2,W,1,2,"cx-media",21),e._UZ(3,"div",22),e.TgZ(4,"span",23),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e.TgZ(7,"span",24),e._uU(8),e.qZA()()()}if(2&n){const t=c.$implicit,r=e.oxw(4);e.xp6(1),e.ekj("has-media",null==r.config||null==r.config.quickOrder||null==r.config.quickOrder.searchForm?null:r.config.quickOrder.searchForm.displayProductImages),e.xp6(1),e.Q6J("ngIf",null==r.config||null==r.config.quickOrder||null==r.config.quickOrder.searchForm?null:r.config.quickOrder.searchForm.displayProductImages),e.xp6(1),e.Q6J("innerHTML",t.name,e.oJD),e.xp6(2),e.hij(" ",e.xi3(6,6,"quickOrderForm.id",e.VKq(9,L,t.code))," "),e.xp6(3),e.Oqu(null==t.price?null:t.price.formattedValue)}}function z(n,c){if(1&n&&(e.TgZ(0,"ul",17),e.YNc(1,X,9,11,"li",18),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.results)}}function ee(n,c){1&n&&(e.TgZ(0,"span",26),e._uU(1),e.ALo(2,"cxTranslate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"quickOrderForm.noResults")," "))}function te(n,c){if(1&n&&(e.TgZ(0,"div",14),e.YNc(1,z,2,1,"ul",15),e.YNc(2,ee,3,3,"span",16),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.results.length),e.xp6(1),e.Q6J("ngIf",t.noResults)}}function re(n,c){if(1&n&&(e.ynx(0),e.YNc(1,te,3,2,"div",13),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.isResultsBoxOpen())}}function ne(n,c){if(1&n&&e._UZ(0,"cx-media",25),2&n){const t=e.oxw().$implicit;e.Q6J("alt",t.name)("container",null==t.images?null:t.images.PRIMARY)}}function ie(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"li",19)(1,"button",20),e.NdJ("blur",function(i){e.CHM(t);const o=e.oxw(4);return e.KtG(o.onBlur(i))})("click",function(i){const u=e.CHM(t).$implicit,l=e.oxw(4);return e.KtG(l.add(u,i))})("keydown.arrowdown",function(i){e.CHM(t);const o=e.oxw(4);return e.KtG(o.focusNextChild(i))})("keydown.arrowup",function(i){e.CHM(t);const o=e.oxw(4);return e.KtG(o.focusPreviousChild(i))})("keydown.enter",function(i){const u=e.CHM(t).$implicit,l=e.oxw(4);return e.KtG(l.add(u,i))})("keydown.escape",function(i){e.CHM(t);const o=e.oxw(4);return e.KtG(o.clear(i))}),e.YNc(2,ne,1,2,"cx-media",21),e._UZ(3,"div",22),e.TgZ(4,"span",23),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e.TgZ(7,"span",24),e._uU(8),e.qZA()()()}if(2&n){const t=c.$implicit,r=e.oxw(4);e.xp6(1),e.ekj("has-media",null==r.config||null==r.config.quickOrder||null==r.config.quickOrder.searchForm?null:r.config.quickOrder.searchForm.displayProductImages),e.xp6(1),e.Q6J("ngIf",null==r.config||null==r.config.quickOrder||null==r.config.quickOrder.searchForm?null:r.config.quickOrder.searchForm.displayProductImages),e.xp6(1),e.Q6J("innerHTML",t.name,e.oJD),e.xp6(2),e.hij(" ",e.xi3(6,6,"quickOrderForm.id",e.VKq(9,L,t.code))," "),e.xp6(3),e.Oqu(null==t.price?null:t.price.formattedValue)}}function oe(n,c){if(1&n&&(e.TgZ(0,"ul",17),e.YNc(1,ie,9,11,"li",18),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.results)}}function ce(n,c){1&n&&(e.TgZ(0,"span",26),e._uU(1),e.ALo(2,"cxTranslate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"quickOrderForm.noResults")," "))}function se(n,c){if(1&n&&(e.TgZ(0,"div",28),e.YNc(1,oe,2,1,"ul",15),e.YNc(2,ce,3,3,"span",16),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.results.length),e.xp6(1),e.Q6J("ngIf",t.noResults)}}function ue(n,c){if(1&n&&(e.ynx(0),e.YNc(1,se,3,2,"div",27),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.isResultsBoxOpen())}}const O=function(n){return{count:n}},ae=["cx-quick-order-item",""],de=function(n,c){return{disabled:n,"img-missing":c}},E=function(n){return{cxRoute:"product",params:n}},le=function(n){return{disabled:n}};function _e(n,c){if(1&n&&e._UZ(0,"tr",10),2&n){const t=c.$implicit,r=c.index,i=e.oxw(2);e.Q6J("entry",t)("index",r)("loading",i.loading)}}function pe(n,c){if(1&n&&(e.TgZ(0,"table",1)(1,"caption",2),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA(),e.TgZ(4,"thead")(5,"tr",3)(6,"th",4),e._uU(7),e.ALo(8,"cxTranslate"),e.qZA(),e.TgZ(9,"th",5),e._uU(10),e.ALo(11,"cxTranslate"),e.qZA(),e.TgZ(12,"th",6),e._uU(13),e.ALo(14,"cxTranslate"),e.qZA(),e.TgZ(15,"th",7),e._uU(16),e.ALo(17,"cxTranslate"),e.qZA()()(),e.TgZ(18,"tbody",8),e.YNc(19,_e,1,3,"tr",9),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,6,"quickOrderTable.caption")," "),e.xp6(5),e.hij(" ",e.lcZ(8,8,"quickOrderTable.product")," "),e.xp6(3),e.hij(" ",e.lcZ(11,10,"quickOrderTable.price")," "),e.xp6(3),e.hij(" ",e.lcZ(14,12,"quickOrderTable.quantity")," "),e.xp6(3),e.hij(" ",e.lcZ(17,14,"quickOrderTable.actions")," "),e.xp6(3),e.Q6J("ngForOf",t.entries)}}const me=["quickOrderForm"];function ge(n,c){if(1&n&&(e.ynx(0),e._UZ(1,"cx-message",2),e.ALo(2,"cxTranslate"),e.BQk()),2&n){const t=e.oxw(2).ngIf,r=e.oxw();e.xp6(1),e.Q6J("text",e.xi3(2,3,"quickOrderList.errors.listIsFull",e.VKq(6,O,t.length)))("isVisibleCloseButton",!1)("type",r.globalMessageType.MSG_TYPE_ERROR)}}function he(n,c){if(1&n&&(e.ynx(0),e.YNc(1,ge,3,8,"ng-container",1),e.BQk()),2&n){const t=e.oxw(2);let r;e.xp6(1),e.Q6J("ngIf",null==t.quickOrderForm||null==t.quickOrderForm.form||null==(r=t.quickOrderForm.form.get("product"))?null:r.dirty)}}function xe(n,c){if(1&n&&(e.ynx(0),e.YNc(1,he,2,1,"ng-container",1),e.ALo(2,"async"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!e.lcZ(2,1,t.canAddProduct()))}}function fe(n,c){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"cx-message",3),e.NdJ("closeMessage",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearAddToCartInformation())}),e.ALo(2,"cxTranslate"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("text",e.lcZ(2,2,"quickOrderList.informations.addProductBeforeAddingToCart"))("type",t.globalMessageType.MSG_TYPE_ERROR)}}const w=function(n){return{name:n}};function ke(n,c){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"cx-message",4),e.NdJ("closeMessage",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clearNonPurchasableError())}),e.ALo(2,"cxTranslate"),e.qZA(),e.BQk()}if(2&n){const t=c.ngIf,r=e.oxw();e.xp6(1),e.Q6J("text",e.xi3(2,2,"quickOrderList.errors.nonPurchasableError",e.VKq(5,w,t.name)))("type",r.globalMessageType.MSG_TYPE_ERROR)}}function Oe(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"cx-message",6),e.NdJ("buttonAction",function(){const o=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.undoDeletion(o.value))})("closeMessage",function(){const o=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.clearDeletion(o.value))}),e.ALo(1,"cxTranslate"),e.ALo(2,"cxTranslate"),e.ALo(3,"cxTranslate"),e.qZA()}if(2&n){const t=c.$implicit,r=e.oxw(2);e.Q6J("actionButtonText",e.lcZ(1,4,"quickOrderList.undo"))("actionButtonMessage",e.xi3(2,6,"quickOrderList.revokeUndo",e.VKq(12,w,null==t.value.product?null:t.value.product.name)))("text",e.xi3(3,9,"quickOrderList.productWasDeleted",e.VKq(14,w,null==t.value.product?null:t.value.product.name)))("type",r.globalMessageType.MSG_TYPE_CONFIRMATION)}}function ye(n,c){if(1&n&&(e.ynx(0),e.YNc(1,Oe,4,16,"cx-message",5),e.ALo(2,"keyvalue"),e.BQk()),2&n){const t=c.ngIf;e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,t))}}const S=function(n,c){return{name:n,code:c}};function qe(n,c){if(1&n&&(e.TgZ(0,"li",12)(1,"span"),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA()()),2&n){const t=c.$implicit;e.xp6(2),e.hij(" ",e.xi3(3,1,"quickOrderList.errors.productIsOutOfStock",e.WLB(4,S,t.entry.product.name,t.entry.product.code))," ")}}function Ce(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"cx-message",8),e.NdJ("closeMessage",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.clearErrors())}),e.ALo(1,"cxTranslate"),e.ALo(2,"cxTranslate"),e.TgZ(3,"ul",9),e.YNc(4,qe,4,7,"li",10),e.qZA(),e.TgZ(5,"div",11),e._uU(6),e.ALo(7,"cxTranslate"),e.qZA()()}if(2&n){const t=e.oxw().ngIf,r=e.oxw();e.Q6J("accordionText",e.lcZ(1,5,"quickOrderList.errors.reviewErrors"))("text",e.lcZ(2,7,"quickOrderList.errorProceedingToCart"))("type",r.globalMessageType.MSG_TYPE_ERROR),e.xp6(4),e.Q6J("ngForOf",t),e.xp6(2),e.hij(" ",e.xi3(7,9,"quickOrderList.errors.outOfStockErrorFound",e.VKq(12,O,t.length))," ")}}function Te(n,c){if(1&n&&(e.ynx(0),e.YNc(1,Ce,8,14,"cx-message",7),e.BQk()),2&n){const t=c.ngIf;e.xp6(1),e.Q6J("ngIf",t.length)}}const be=function(n,c,t){return{name:n,code:c,quantityAdded:t}};function ve(n,c){if(1&n&&(e.TgZ(0,"li",17)(1,"span"),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA()()),2&n){const t=c.$implicit;e.xp6(2),e.hij(" ",e.xi3(3,1,"quickOrderList.warnings.productWasReduced",e.kEZ(4,be,t.entry.product.name,t.entry.product.code,t.quantityAdded))," ")}}function Qe(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"cx-message",14),e.NdJ("closeMessage",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.clearWarnings())}),e.ALo(1,"cxTranslate"),e.ALo(2,"cxTranslate"),e.TgZ(3,"ul",15),e.YNc(4,ve,4,8,"li",16),e.qZA(),e.TgZ(5,"div",11),e._uU(6),e.ALo(7,"cxTranslate"),e.qZA()()}if(2&n){const t=e.oxw().ngIf,r=e.oxw();e.Q6J("accordionText",e.lcZ(1,5,"quickOrderList.warnings.reviewWarnings"))("text",e.lcZ(2,7,"quickOrderList.warningProceedingToCart"))("type",r.globalMessageType.MSG_TYPE_WARNING),e.xp6(4),e.Q6J("ngForOf",t),e.xp6(2),e.hij(" ",e.xi3(7,9,"quickOrderList.warnings.reduceWarningFound",e.VKq(12,O,t.length))," ")}}function we(n,c){if(1&n&&(e.ynx(0),e.YNc(1,Qe,8,14,"cx-message",13),e.BQk()),2&n){const t=c.ngIf;e.xp6(1),e.Q6J("ngIf",t.length)}}function Ae(n,c){if(1&n&&(e.TgZ(0,"li",22)(1,"span"),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA()()),2&n){const t=c.$implicit;e.xp6(2),e.Oqu(e.xi3(3,1,"quickOrderList.successes.productAddedToCart",e.WLB(4,S,t.product.name,t.product.code)))}}function Fe(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"cx-message",19),e.NdJ("closeMessage",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.clearSuccesses())}),e.ALo(1,"cxTranslate"),e.TgZ(2,"ul",20),e.YNc(3,Ae,4,7,"li",21),e.qZA(),e.TgZ(4,"div",11),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA()()}if(2&n){const t=e.oxw().ngIf,r=e.oxw();e.Q6J("text",e.lcZ(1,4,"quickOrderList.successfullyAddedToCart"))("type",r.globalMessageType.MSG_TYPE_CONFIRMATION),e.xp6(3),e.Q6J("ngForOf",t),e.xp6(2),e.hij(" ",e.xi3(6,6,"quickOrderList.successes.addedToCartFound",e.VKq(9,O,t.length))," ")}}function Ze(n,c){if(1&n&&(e.ynx(0),e.YNc(1,Fe,7,11,"cx-message",18),e.BQk()),2&n){const t=c.ngIf;e.xp6(1),e.Q6J("ngIf",t.length)}}function Le(n,c){1&n&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"cxTranslate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"quickOrderList.header")," "))}function Ee(n,c){1&n&&(e.TgZ(0,"h2"),e._uU(1),e.ALo(2,"cxTranslate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"quickOrderList.header")," "))}function Se(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.clear())}),e.ALo(1,"cxTranslate"),e.ALo(2,"async"),e._uU(3),e.ALo(4,"cxTranslate"),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("disabled",!e.lcZ(2,5,t.isCartStable$)),e.uIk("aria-label",e.lcZ(1,3,"quickOrderList.emptyList")),e.xp6(3),e.hij(" ",e.lcZ(4,7,"quickOrderList.emptyList")," ")}}function Me(n,c){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",23),e.YNc(2,Le,3,3,"h3",24),e.YNc(3,Ee,3,3,"h2",24),e.TgZ(4,"p"),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA()(),e.TgZ(7,"div",25),e._UZ(8,"cx-quick-order-form",26,27),e.qZA(),e.TgZ(10,"div",28),e._UZ(11,"cx-quick-order-table",29),e.ALo(12,"async"),e.qZA(),e.TgZ(13,"div",30)(14,"div",31),e.YNc(15,Se,5,9,"button",32),e.qZA(),e.TgZ(16,"div",31)(17,"cx-progress-button",33),e.NdJ("clickEvent",function(){const o=e.CHM(t).ngIf,u=e.oxw(2);return e.KtG(u.addToCart(o))}),e.ALo(18,"cxTranslate"),e.ALo(19,"async"),e._uU(20),e.ALo(21,"cxTranslate"),e.qZA()()(),e.BQk()}if(2&n){const t=c.ngIf,r=e.oxw().ngIf,i=e.oxw();e.xp6(2),e.Q6J("cxFeatureLevel","!5.1"),e.xp6(1),e.Q6J("cxFeatureLevel","5.1"),e.xp6(2),e.hij(" ",e.xi3(6,12,"quickOrderList.subHeader",e.VKq(23,Q,r))," "),e.xp6(3),e.Q6J("limit",r),e.xp6(3),e.Q6J("entries",t)("loading",!e.lcZ(12,15,i.isCartStable$)),e.xp6(4),e.Q6J("ngIf",t.length),e.xp6(2),e.Tol("btn-block add-button"),e.Q6J("ariaLabel",e.lcZ(18,17,"quickOrderList.addToCart"))("loading",!e.lcZ(19,19,i.isCartStable$)),e.xp6(3),e.hij(" ",e.lcZ(21,21,"quickOrderList.addToCart")," ")}}function Ie(n,c){if(1&n&&(e.ynx(0),e.YNc(1,Me,22,25,"ng-container",1),e.ALo(2,"async"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,t.entries$))}}let Pe=(()=>{class n{constructor(t,r,i,o){this.activeCartService=t,this.eventService=r,this.formBuilder=i,this.globalMessageService=o,this.cartIsLoading$=this.activeCartService.isStable().pipe((0,f.U)(u=>!u)),this.cart$=this.activeCartService.getActive(),this.min=1,this.subscription=new x.w,this.cartEventsSubscription=new x.w,this.minQuantityValue=1}ngOnInit(){this.buildForm(),this.watchQuantityChange()}ngOnDestroy(){this.subscription?.unsubscribe(),this.cartEventsSubscription?.unsubscribe()}applyQuickOrder(){if(this.quickOrderForm.invalid)return void this.quickOrderForm.markAllAsTouched();const t=this.quickOrderForm.get("productCode")?.value,r=this.quickOrderForm.get("quantity")?.value;this.watchAddEntrySuccessEvent(),this.watchAddEntryFailEvent(),t&&r&&this.activeCartService.addEntry(t,r)}buildForm(){this.quickOrderForm=this.formBuilder.group({productCode:["",[d.kI.required]],quantity:[this.minQuantityValue,{updateOn:"blur",validators:[d.kI.required]}]})}watchQuantityChange(){this.subscription.add(this.quickOrderForm.get("quantity")?.valueChanges.subscribe(t=>this.quickOrderForm.get("quantity")?.setValue(this.getValidCount(t),{emitEvent:!1})))}watchAddEntrySuccessEvent(){this.cartEventsSubscription.add(this.eventService.get(p.VD).pipe((0,y.P)()).subscribe(t=>{let i,r="quickOrderCartForm.stockLevelReached",o=s.xUg.MSG_TYPE_WARNING;t.quantityAdded&&(r=t.quantityAdded>1?"quickOrderCartForm.entriesWereAdded":"quickOrderCartForm.entryWasAdded",i=t.quantityAdded>1?"quickOrderCartForm.products":"quickOrderCartForm.product",o=s.xUg.MSG_TYPE_CONFIRMATION),this.globalMessageService.add({key:r,params:{product:t?.entry?.product?.name||i,quantity:t.quantityAdded}},o),this.resetForm()}))}watchAddEntryFailEvent(){this.cartEventsSubscription.add(this.eventService.get(p.K$).pipe((0,y.P)()).subscribe(()=>{this.globalMessageService.add({key:"quickOrderCartForm.noResults"},s.xUg.MSG_TYPE_ERROR)}))}getValidCount(t){return(t<this.min||!t)&&(t=this.min),t}resetForm(){this.quickOrderForm.reset()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.bu),e.Y36(s.POd),e.Y36(d.QS),e.Y36(s.IWp))},n.\u0275cmp=e.Xpm({type:n,selectors:[["cx-cart-quick-order-form"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"cx-cart-quick-order-form-title"],[1,"form-group"],[3,"formGroup","ngSubmit"],[1,"cx-cart-quick-order-form-container"],[1,"cx-cart-quick-order-form-productID"],[1,"cx-cart-quick-order-form-label"],["aria-required","true","formControlName","productCode","required","true","type","text",1,"form-control","input-product-code",3,"placeholder"],[1,"cx-cart-quick-order-form-qty"],["aria-required","true","formControlName","quantity","required","true","type","number",1,"form-control","input-quantity"],["type","submit",1,"btn","btn-block","btn-action","apply-quick-order-button",3,"disabled"],[3,"control"]],template:function(t,r){1&t&&(e.YNc(0,G,28,34,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,r.cart$))},dependencies:[m.O5,d._Y,d.Fj,d.wV,d.JJ,d.JL,d.Q7,d.sg,d.u,_.Ahv,m.Ov,s.X$D],encapsulation:2,changeDetection:0}),n})(),Je=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{CartQuickOrderFormComponent:{component:Pe}}})],imports:[m.ez,d.UX,s.LUR,_.Fym]}),n})(),$e=(()=>{class n{constructor(t,r){this.quickOrderService=t,this.productConnector=r,this.type=p.lM.QUICK_ORDER}getEntries(){return this.quickOrderService.getEntries()}addEntries(t){return(0,M.T)(t.map(r=>this.quickOrderService.canAdd(r.productCode).pipe((0,T.w)(i=>i?this.productConnector.get(r.productCode).pipe((0,q.h)(o=>!!o),(0,b.b)(o=>{this.quickOrderService.addProduct(o,r.quantity)}),(0,f.U)(o=>this.handleResults(o,r)),(0,P.K)(o=>(0,k.of)(this.handleErrors(o,r.productCode)))):(0,k.of)({productCode:r.productCode,statusCode:p.QX.LIMIT_EXCEEDED}))))).pipe((0,J.J)(),(0,C.q)(t.length))}handleResults(t,r){return t.stock?.stockLevel&&r.quantity>t.stock.stockLevel?{productCode:r.productCode,productName:t?.name,statusCode:p.QX.LOW_STOCK,quantity:r.quantity,quantityAdded:t.stock.stockLevel}:"outOfStock"===t.stock?.stockLevelStatus?{productCode:r.productCode,statusCode:p.QX.NO_STOCK,productName:t?.name}:{productCode:r.productCode,statusCode:p.QX.SUCCESS}}handleErrors(t,r){return"UnknownIdentifierError"===t?.error?.errors[0].type?{productCode:r,statusCode:p.QX.UNKNOWN_IDENTIFIER}:((0,e.X6Q)()&&console.warn("Unrecognized cart add entry action type while mapping messages",t),{productCode:r,statusCode:p.QX.UNKNOWN_ERROR})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(h.be),e.LFG(s.GCj))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ne=(()=>{class n{constructor(t,r,i,o){this.config=t,this.cd=r,this.quickOrderService=i,this.winRef=o,this.iconTypes=_.e1G,this.isSearching=!1,this.noResults=!1,this.results=[],this.subscription=new x.w,this.searchSubscription=new x.w}ngOnInit(){this.buildForm(),this.subscription.add(this.watchProductAdd()),this.subscription.add(this.watchQueryChange())}onBlur(t){setTimeout(()=>{this.isSuggestionFocused()||this.blurSuggestionBox(t)})}clear(t){t?.preventDefault(),this.isResultsBoxOpen()&&this.toggleBodyClass("quick-order-searchbox-is-active",!1),this.form.get("product")?.value&&this.form.reset(),this.close(),this.cd?.detectChanges()}add(t,r){if(r?.preventDefault(),t.multidimensional)return this.quickOrderService.setNonPurchasableProductError(t),void this.clear();this.quickOrderService.clearNonPurchasableProductError(),this.quickOrderService.addProduct(t)}addProduct(t){this.quickOrderService.canAdd().pipe((0,C.q)(1)).subscribe(r=>{if(r)if(1===this.results.length)this.add(this.results[0],t);else if(-1!==this.getFocusedIndex()){const i=this.results[this.getFocusedIndex()];this.add(i,t)}})}focusNextChild(t){if(t.preventDefault(),!this.results.length)return;const[r,i]=[this.getResultElements(),this.getFocusedIndex()];r.length&&(i>=r.length-1?r[0].focus():r[i+1].focus())}focusPreviousChild(t){if(t.preventDefault(),!this.results.length)return;const[r,i]=[this.getResultElements(),this.getFocusedIndex()];r.length&&(i<1?r[r.length-1].focus():r[i-1].focus())}isResultsBoxOpen(){return!!this.winRef&&!!this.winRef.document.querySelector(".quick-order-searchbox-is-active")}canAddProduct(){return this.quickOrderService.canAdd()}open(){this.toggleBodyClass("quick-order-searchbox-is-active",!0)}getResultElements(){return this.winRef?Array.from(this.winRef.document.querySelectorAll(".quick-order-results-products > li button")):[]}blurSuggestionBox(t){this.toggleBodyClass("quick-order-searchbox-is-active",!1),t&&t.target&&t.target.blur()}getFocusedElement(){if(this.winRef)return this.winRef.document.activeElement}getFocusedIndex(){return this.getResultElements().indexOf(this.getFocusedElement())}isSuggestionFocused(){return this.getResultElements().includes(this.getFocusedElement())}toggleBodyClass(t,r){this.winRef&&(void 0===r?this.winRef.document.body.classList.toggle(t):r?this.winRef.document.body.classList.add(t):this.winRef.document.body.classList.remove(t))}buildForm(){const t=new d.nJ({});t.setControl("product",new d.p4(null)),this.form=t}isEmpty(t){return""===t?.trim()||null==t}watchQueryChange(){return this.form.valueChanges.pipe((0,$.x)(),(0,N.b)(300),(0,q.h)(t=>this.config?.quickOrder?.searchForm?this.isEmpty(t.product)?(this.clear(),!1):!!t.product&&t.product.length>=this.config.quickOrder?.searchForm?.minCharactersBeforeRequest:t)).subscribe(t=>{this.searchProducts(t.product)})}searchProducts(t){this.searchSubscription.add(this.canAddProduct().pipe((0,q.h)(Boolean),(0,T.w)(()=>this.quickOrderService.searchProducts(t,this.config?.quickOrder?.searchForm?.maxProducts).pipe((0,C.q)(1)))).subscribe(r=>{this.results=r,this.results.length?(this.noResults=!1,this.open()):this.noResults=!0,this.cd?.detectChanges()}))}clearResults(){this.results=[]}close(){this.resetSearchSubscription(),this.clearResults(),this.noResults=!1}resetSearchSubscription(){this.searchSubscription.unsubscribe(),this.searchSubscription=new x.w}watchProductAdd(){return this.quickOrderService.getProductAdded().subscribe(()=>this.clear())}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.DeH),e.Y36(e.sBO),e.Y36(h.be),e.Y36(s.X9E))},n.\u0275cmp=e.Xpm({type:n,selectors:[["cx-quick-order-form"]],inputs:{limit:"limit"},decls:16,vars:22,consts:[[1,"quick-order-form-container",3,"formGroup"],["role","search",1,"quick-order-form-input"],[4,"cxFeatureLevel"],["class","quick-order-form-reset-icon",3,"click","keydown.enter",4,"ngIf","ngIfElse"],["searchIcon",""],["class","list-limit-reached-text","role","alert",4,"ngIf"],["aria-live","polite","id","quickOrderFormInitialDescription","aria-atomic","true",1,"cx-visually-hidden"],["aria-controls","results","aria-describedby","quickOrderFormInitialDescription","formControlName","product","type","text",1,"form-control",3,"placeholder","blur","focus","keydown.arrowdown","keydown.arrowup","keydown.enter","keydown.escape"],["aria-controls","quick-order-search-results","aria-describedby","quickOrderFormInitialDescription","formControlName","product","type","text",1,"form-control",3,"placeholder","blur","focus","keydown.arrowdown","keydown.arrowup","keydown.enter","keydown.escape"],[1,"quick-order-form-reset-icon",3,"click","keydown.enter"],[3,"type"],["tabindex","-1",1,"quick-order-form-search-icon"],["role","alert",1,"list-limit-reached-text"],["class","quick-order-results","role","dialog","id","results",4,"ngIf"],["role","dialog","id","results",1,"quick-order-results"],["class","quick-order-results-products","role","listbox",4,"ngIf"],["class","quick-order-no-results",4,"ngIf"],["role","listbox",1,"quick-order-results-products"],["class","quick-order-results-product-container",4,"ngFor","ngForOf"],[1,"quick-order-results-product-container"],["role","option",1,"quick-order-results-product",3,"blur","click","keydown.arrowdown","keydown.arrowup","keydown.enter","keydown.escape"],["class","media","format","thumbnail","role","presentation",3,"alt","container",4,"ngIf"],[1,"name",3,"innerHTML"],[1,"id"],[1,"price"],["format","thumbnail","role","presentation",1,"media",3,"alt","container"],[1,"quick-order-no-results"],["class","quick-order-results","role","dialog","id","quick-order-search-results",4,"ngIf"],["role","dialog","id","quick-order-search-results",1,"quick-order-results"]],template:function(t,r){if(1&t&&(e.TgZ(0,"form",0)(1,"div",1),e.ALo(2,"cxTranslate"),e.YNc(3,K,4,9,"ng-container",2),e.YNc(4,B,4,9,"ng-container",2),e.YNc(5,H,3,4,"button",3),e.YNc(6,j,3,4,"ng-template",null,4,e.W1O),e.YNc(8,V,3,3,"span",5),e.ALo(9,"async"),e.qZA(),e.YNc(10,re,2,1,"ng-container",2),e.YNc(11,ue,2,1,"ng-container",2),e.qZA(),e.TgZ(12,"label",6),e._uU(13),e.ALo(14,"cxTranslate"),e.ALo(15,"cxTranslate"),e.qZA()),2&t){const i=e.MAs(7);let o,u;e.Q6J("formGroup",r.form),e.xp6(1),e.uIk("aria-label",e.lcZ(2,11,"quickOrderForm.quickOrderSearch")),e.xp6(2),e.Q6J("cxFeatureLevel","!5.1"),e.xp6(1),e.Q6J("cxFeatureLevel","5.1"),e.xp6(1),e.Q6J("ngIf",null==(o=r.form.get("product"))?null:o.value)("ngIfElse",i),e.xp6(3),e.Q6J("ngIf",!e.lcZ(9,13,r.canAddProduct())&&(null==(u=r.form.get("product"))?null:u.dirty)),e.xp6(2),e.Q6J("cxFeatureLevel","!5.1"),e.xp6(1),e.Q6J("cxFeatureLevel","5.1"),e.xp6(2),e.AsE(" ",r.results.length?e.xi3(14,15,"quickOrderForm.productsResults",e.VKq(20,O,r.results.length)):""," ",e.lcZ(15,18,"quickOrderForm.initialDescription"),"\n")}},dependencies:[m.sg,m.O5,_.oJW,_.R7z,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,s.EJv,m.Ov,s.X$D],encapsulation:2,changeDetection:0}),n})(),De=(()=>{class n{constructor(t,r){this.cd=t,this.quickOrderService=r,this.loading=!1,this.subscription=new x.w}get entry(){return this._entry}set entry(t){this._entry=t,this.quantityControl=new d.p4(this.entry.quantity,{updateOn:"blur"})}ngOnInit(){this.subscription.add(this.quantityControl.valueChanges.subscribe(()=>{this.quickOrderService.updateEntryQuantity(this.index,this.quantityControl.value)})),this.subscription.add(this.watchProductAdd())}removeEntry(){this.quickOrderService.softDeleteEntry(this.index),this.cd.detectChanges()}watchProductAdd(){return this.quickOrderService.getProductAdded().subscribe(t=>{t===this.entry.product?.code&&(this.quantityControl=new d.p4(this.entry.quantity),this.cd.detectChanges())})}ngOnDestroy(){this.subscription?.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(h.be))},n.\u0275cmp=e.Xpm({type:n,selectors:[["","cx-quick-order-item",""],["cx-quick-order-item"]],inputs:{entry:"entry",index:"index",loading:"loading"},attrs:ae,decls:30,vars:41,consts:[["role","cell"],[1,"cx-table-item-container"],["tabindex","-1",3,"ngClass","routerLink"],["format","cartIcon",3,"container","alt"],[1,"cx-info"],[1,"cx-name"],[1,"cx-link",3,"ngClass","routerLink"],[1,"cx-code"],["role","cell",1,"cx-price"],[1,"cx-mobile-header"],[1,"cx-value"],["role","cell",1,"cx-quantity"],[3,"control","max","readonly"],["role","cell",1,"cx-actions"],[1,"link","cx-action-link",3,"disabled","click"]],template:function(t,r){1&t&&(e.TgZ(0,"td",0)(1,"div",1)(2,"a",2),e.ALo(3,"cxUrl"),e._UZ(4,"cx-media",3),e.qZA(),e.TgZ(5,"div",4)(6,"div",5)(7,"a",6),e.ALo(8,"cxUrl"),e._uU(9),e.qZA()(),e.TgZ(10,"div",7),e._uU(11),e.ALo(12,"cxTranslate"),e.qZA()()()(),e.TgZ(13,"td",8)(14,"div",9),e._uU(15),e.ALo(16,"cxTranslate"),e.qZA(),e.TgZ(17,"div",10),e._uU(18),e.qZA()(),e.TgZ(19,"td",11)(20,"div",9),e._uU(21),e.ALo(22,"cxTranslate"),e.qZA(),e.TgZ(23,"div",10),e._UZ(24,"cx-item-counter",12),e.qZA()(),e.TgZ(25,"td",13)(26,"button",14),e.NdJ("click",function(){return r.removeEntry()}),e.ALo(27,"cxTranslate"),e._uU(28),e.ALo(29,"cxTranslate"),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngClass",e.WLB(32,de,r.loading,!(null!=r.entry&&null!=r.entry.product&&null!=r.entry.product.images&&r.entry.product.images.PRIMARY)))("routerLink",e.lcZ(3,18,e.VKq(35,E,r.entry.product))),e.xp6(2),e.Q6J("container",null==r.entry||null==r.entry.product||null==r.entry.product.images?null:r.entry.product.images.PRIMARY)("alt",null==r.entry||null==r.entry.product?null:r.entry.product.name),e.xp6(3),e.Q6J("ngClass",e.VKq(37,le,r.loading))("routerLink",e.lcZ(8,20,e.VKq(39,E,r.entry.product))),e.xp6(2),e.hij("",(null==r.entry.product?null:r.entry.product.name)||"-"," "),e.xp6(2),e.AsE(" ",e.lcZ(12,22,"quickOrderTable.id")," ",null==r.entry.product?null:r.entry.product.code," "),e.xp6(4),e.hij(" ",e.lcZ(16,24,"quickOrderTable.itemPrice")," "),e.xp6(3),e.hij(" ",(null==r.entry.basePrice?null:r.entry.basePrice.formattedValue)||"-"," "),e.xp6(3),e.hij(" ",e.lcZ(22,26,"quickOrderTable.qty")," "),e.xp6(3),e.Q6J("control",r.quantityControl)("max",null==r.entry.product||null==r.entry.product.stock?null:r.entry.product.stock.stockLevel)("readonly",r.loading),e.xp6(2),e.Q6J("disabled",r.loading),e.uIk("aria-label",e.lcZ(27,28,"common.remove")),e.xp6(2),e.hij(" ",e.lcZ(29,30,"common.remove")," "))},dependencies:[m.mk,_.odZ,_.R7z,v.yS,s.X$D,s.l2T],encapsulation:2,changeDetection:0}),n})(),Re=(()=>{class n{constructor(){this.entries=[],this.loading=!1}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["cx-quick-order-table"]],inputs:{entries:"entries",loading:"loading"},decls:1,vars:1,consts:[["class","cx-quick-order-table-wrapper","role","table",4,"ngIf"],["role","table",1,"cx-quick-order-table-wrapper"],[1,"cx-visually-hidden"],["role","row",1,"cx-item-list-header","cx-quick-order-table-header"],["role","columnheader",1,"cx-item-list-desc"],["role","columnheader",1,"cx-item-list-price"],["role","columnheader",1,"cx-item-list-qty"],["role","columnheader",1,"cx-item-list-actions"],[1,"cx-item-list-items"],["cx-quick-order-item","","class","cx-item-list-row cx-quick-order-table-row",3,"entry","index","loading",4,"ngFor","ngForOf"],["cx-quick-order-item","",1,"cx-item-list-row","cx-quick-order-table-row",3,"entry","index","loading"]],template:function(t,r){1&t&&e.YNc(0,pe,20,16,"table",0),2&t&&e.Q6J("ngIf",(null==r.entries?null:r.entries.length)>0)},dependencies:[m.sg,m.O5,De,s.X$D],encapsulation:2,changeDetection:0}),n})(),Ye=(()=>{class n{constructor(t,r,i,o,u){this.activeCartService=t,this.component=r,this.globalMessageService=i,this.quickOrderService=o,this.quickOrderStatePersistenceService=u,this.quickOrderListLimit$=this.component.data$.pipe((0,f.U)(l=>l.quickOrderListLimit),(0,b.b)(l=>{l&&this.quickOrderService.setListLimit(l)})),this.isCartStable$=(0,I.aj)([this.activeCartService.getActiveCartId(),this.activeCartService.isStable()]).pipe((0,f.U)(([l,Be])=>!l||Be)),this.globalMessageType=s.xUg,this.cartErrors$=new g.X([]),this.cartWarnings$=new g.X([]),this.cartSuccesses$=new g.X([]),this.showAddToCartInformation$=new g.X(!1),this.nonPurchasableProductError$=new g.X(null)}ngOnInit(){this.cartId$=this.activeCartService.getActiveCartId(),this.entries$=this.quickOrderService.getEntries(),this.quickOrderStatePersistenceService.initSync()}ngOnDestroy(){this.quickOrderService.clearDeletedEntries()}get errors$(){return this.cartErrors$.asObservable()}get warnings$(){return this.cartWarnings$.asObservable()}get successes$(){return this.cartSuccesses$.asObservable()}get nonPurchasableError$(){return this.quickOrderService.getNonPurchasableProductError()}get addToCartInformation$(){return this.showAddToCartInformation$.asObservable()}get softDeletedEntries$(){return this.quickOrderService.getSoftDeletedEntries()}clear(){this.quickOrderService.clearList(),this.globalMessageService.add({key:"quickOrderTable.listCleared"},s.xUg.MSG_TYPE_INFO)}addToCart(t){t.length?(this.clearStatuses(),this.quickOrderService.addToCart().pipe((0,y.P)()).subscribe(([r,i])=>{i.forEach(o=>{o.entry||(o.entry=t.find(u=>u.product?.code===o.productCode))}),this.extractErrors(i),this.extractWarnings(i),i.length?this.extractSuccesses(i,r):this.showAddedToCartSuccessMessage()})):this.showAddToCartInformation$.next(!0)}clearErrors(){this.cartErrors$.next([])}clearWarnings(){this.cartWarnings$.next([])}clearSuccesses(){this.cartSuccesses$.next([])}clearAddToCartInformation(){this.showAddToCartInformation$.next(!1)}undoDeletion(t){t.product?.code&&this.quickOrderService.restoreSoftDeletedEntry(t.product.code)}clearDeletion(t){t.product?.code&&this.quickOrderService.hardDeleteEntry(t.product.code)}clearNonPurchasableError(){this.quickOrderService.clearNonPurchasableProductError()}canAddProduct(){return this.quickOrderService.canAdd()}extractErrors(t){const r=t.filter(i=>0===i.quantityAdded);this.setErrors(r)}extractWarnings(t){const r=t.filter(i=>0!==i.quantityAdded);this.setWarnings(r)}extractSuccesses(t,r){const i=[];r.forEach(o=>{t.find(l=>l.productCode===o.product?.code)||i.push(o)}),this.setSuccesses(i)}clearStatuses(){this.clearErrors(),this.clearWarnings(),this.clearSuccesses()}showAddedToCartSuccessMessage(){this.globalMessageService.add({key:"quickOrderTable.addedtoCart"},s.xUg.MSG_TYPE_CONFIRMATION)}setErrors(t){this.cartErrors$.next(t)}setWarnings(t){this.cartWarnings$.next(t)}setSuccesses(t){this.cartSuccesses$.next(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.bu),e.Y36(_.exf),e.Y36(s.IWp),e.Y36(h.be),e.Y36(Z))},n.\u0275cmp=e.Xpm({type:n,selectors:[["cx-quick-order"]],viewQuery:function(t,r){if(1&t&&e.Gf(me,5),2&t){let i;e.iGM(i=e.CRH())&&(r.quickOrderForm=i.first)}},decls:17,vars:24,consts:[["aria-atomic","true","aria-live","assertive","aria-relevant","additions",1,"quick-order-message-container"],[4,"ngIf"],[1,"quick-order-list-limit-message",3,"text","isVisibleCloseButton","type"],[1,"quick-order-add-to-cart-information-message",3,"text","type","closeMessage"],[1,"quick-order-non-purchasable-product-error-message",3,"text","type","closeMessage"],["class","quick-order-deletions-message",3,"actionButtonText","actionButtonMessage","text","type","buttonAction","closeMessage",4,"ngFor","ngForOf"],[1,"quick-order-deletions-message",3,"actionButtonText","actionButtonMessage","text","type","buttonAction","closeMessage"],["class","quick-order-errors-message",3,"accordionText","text","type","closeMessage",4,"ngIf"],[1,"quick-order-errors-message",3,"accordionText","text","type","closeMessage"],[1,"quick-order-errors"],["class","quick-order-error-item",4,"ngFor","ngForOf"],[1,"cx-visually-hidden"],[1,"quick-order-error-item"],["class","quick-order-warnings-message",3,"accordionText","text","type","closeMessage",4,"ngIf"],[1,"quick-order-warnings-message",3,"accordionText","text","type","closeMessage"],[1,"quick-order-warnings"],["class","quick-order-warning-item",4,"ngFor","ngForOf"],[1,"quick-order-warning-item"],["class","quick-order-successes-message",3,"text","type","closeMessage",4,"ngIf"],[1,"quick-order-successes-message",3,"text","type","closeMessage"],[1,"quick-order-successes"],["class","quick-order-success-item",4,"ngFor","ngForOf"],[1,"quick-order-success-item"],[1,"quick-order-header"],[4,"cxFeatureLevel"],[1,"quick-order-form-body"],[3,"limit"],["quickOrderForm",""],[1,"quick-order-table-body"],[3,"entries","loading"],[1,"quick-order-footer","row"],[1,"col-xs-12","col-md-5","col-lg-4"],["class","btn btn-block btn-action clear-button","type","button",3,"disabled","click",4,"ngIf"],[3,"ariaLabel","loading","clickEvent"],["type","button",1,"btn","btn-block","btn-action","clear-button",3,"disabled","click"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0),e.YNc(1,xe,3,3,"ng-container",1),e.ALo(2,"async"),e.YNc(3,fe,3,4,"ng-container",1),e.ALo(4,"async"),e.YNc(5,ke,3,7,"ng-container",1),e.ALo(6,"async"),e.YNc(7,ye,3,3,"ng-container",1),e.ALo(8,"async"),e.YNc(9,Te,2,1,"ng-container",1),e.ALo(10,"async"),e.YNc(11,we,2,1,"ng-container",1),e.ALo(12,"async"),e.YNc(13,Ze,2,1,"ng-container",1),e.ALo(14,"async"),e.qZA(),e.YNc(15,Ie,3,3,"ng-container",1),e.ALo(16,"async")),2&t&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,8,r.entries$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(4,10,r.addToCartInformation$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(6,12,r.nonPurchasableError$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(8,14,r.softDeletedEntries$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(10,16,r.errors$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(12,18,r.warnings$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(14,20,r.successes$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(16,22,r.quickOrderListLimit$)))},dependencies:[m.sg,m.O5,_.qqZ,_.lc1,s.EJv,Ne,Re,m.Ov,m.Nd,s.X$D],encapsulation:2,changeDetection:0}),n})(),Ue=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{QuickOrderComponent:{component:Ye,data:{quickOrderListLimit:10}}}})],imports:[_.p$5,m.ez,_.Fym,s.LUR,_.QX1,_.Td$,_.cOq,_.$zX,_.Quc,d.UX,v.Bz,s.bhT,s.GSh]}),n})(),Ge=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[{provide:h.KI,useExisting:$e}],imports:[v.Bz,Ue,Je]}),n})(),Ke=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[U,Ge]}),n})()}}]);